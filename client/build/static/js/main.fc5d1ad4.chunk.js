(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{114:function(e,t,a){},119:function(e,t,a){e.exports=a(326)},323:function(e,t,a){},325:function(e,t,a){},326:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(24),s=a.n(i),o=a(7),l=a(14),c=a(109),d=a.n(c),m=a(110),u=a.n(m),p=a(111),h=a(2),f={empCollection:[],rtCollection:[],processCollection:[],filesCollection:[],tecCollection:[],id:"",nome:"",cpf:"",rua:"",bairro:"",cep:"",cidade:"",phone:"",email:"",numero:"",complemento:"",uf:"",nomeRt:"",emailRt:"",phoneRt:"",nProcesso:"",loadedData:{},empMatch:"",rtMatch:"",empId:"",editItem:!1,search:"",setColor:"",loading:!1},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_EMP_DATA":return Object(h.a)({},e,{empCollection:t.payload});case"LOAD_RT_DATA":return Object(h.a)({},e,{rtCollection:t.payload});case"LOAD_PROCESS_DATA":return Object(h.a)({},e,{processCollection:t.payload});case"LOAD_FILES_DATA":return Object(h.a)({},e,{filesCollection:t.payload});case"LOAD_TECNICOS":return Object(h.a)({},e,{tecCollection:t.payload});case"SET_COLOR":return Object(h.a)({},e,{setColor:t.payload});case"LOADING":return Object(h.a)({},e,{loading:t.payload});default:return e}},b={},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FIND_EMP_ID":return Object(h.a)({},e,{empId:t.payload,editItem:!0});case"DISABLE_EDIT":return Object(h.a)({},e,{editItem:!1});case"CHANGE_SEARCH_VALUE":return Object(h.a)({},e,{search:t.payload});case"EDIT_VALUE":return Object(h.a)({},e,{loadedData:t.payload});default:return e}},g=a(19),y=a.n(g),x={login:!1,verified:!1,usersCollection:[]},k=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:x,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(h.a)({},e,{login:t.payload});case"VERIFY":return Object(h.a)({},e,{verified:t.payload});case"GET_USERS":return Object(h.a)({},e,{usersCollection:t.payload});case"LOG_OUT":return Object(h.a)({},e,{login:t.payload,user:null});default:return e}},C=Object(o.c)({auth:k,cadastro:v,busca:E,toastr:g.reducer}),w=(a(146),function(e){return r.a.createElement(y.a,{timeOut:3e3,newestOnTop:!1,preventDuplicates:!0,position:"top-right",transitionIn:"fadeIn",transitionOut:"fadeOut",progressBar:!0,closeOnToastrClick:!0})}),D=a(329),N=a(331),I=a(328),O=a(330),j=a(4),S=a.n(j);function P(e){return{type:"LOGIN",payload:e}}function A(e){return localStorage.clear("login",!1),{type:"LOG_OUT",payload:e}}function R(e){return localStorage.setItem("verified",e),{type:"VERIFY",payload:e}}function _(){return{type:"GET_USERS",payload:S.a.get("/api/users").then(function(e){return e.data}).catch(function(e){return console.log(e)})}}var F=function(){return{type:"LOAD_EMP_DATA",payload:S.a.get("/api/showEmpreend").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}};function T(){return{type:"LOAD_RT_DATA",payload:S.a.get("/api/showRt").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}}function z(){return{type:"LOAD_PROCESS_DATA",payload:S.a.get("/api/showProcess").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}}function M(){return{type:"LOAD_FILES_DATA",payload:S.a.get("/api/files").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}}function L(){return{type:"LOAD_TECNICOS",payload:S.a.get("/api/tecnicos").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}}var B=function(){var e=["rgb(104, 119, 133)","rgb(84, 104, 102)","rgb(105, 117, 153)","rgb(88, 103, 88)","rgb(117, 116, 101)","rgb(117, 117, 137)"];return{type:"SET_COLOR",payload:e[Math.floor(Math.random()*e.length)]}},q=function(e,t,a){var n=a||"Opera\xe7\xe3o realizada com sucesso";return"sucess"===e?g.toastr.success(n,t):g.toastr.error(n||"Erro",t)},U=function(e){return{type:"LOADING",payload:e}},V=a(3),H=a.n(V),W=a(5),G=function(){var e=new Date;e.setTime(e.getTime()-864e5);var t="expires="+e.toGMTString();document.cookie="_sim-ad=; "+t},Y=function(){var e=Object(W.a)(H.a.mark(function e(){var t,a=arguments;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:" ",e.next=3,G();case 3:return e.next=5,localStorage.clear();case 5:q("error!",t.toString(),"Sess\xe3o expirada."),setTimeout(function(){window.location.reload()},1900);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),J=a(9),X=a(10),K=a(12),Q=a(11),Z=a(13),$=function(e){var t=e.user;return r.a.createElement("div",null,r.a.createElement("div",{className:"card-panel",style:{backgroundImage:"url(".concat("/images/home_bg.jpg",")")}},r.a.createElement("div",{className:"container",style:{paddingBottom:"0.5%"}},r.a.createElement("h1",{className:"display-3"}," ",r.a.createElement("strong",null,r.a.createElement("span",{style:{color:"white"}},"Anu\xeancia Digital")," ")," "),r.a.createElement("h6",{style:{color:"white",fontWeight:"500"}},"Vers\xe3o 1.3.8 - 03/06/19"),r.a.createElement("br",null),r.a.createElement("h4",{style:{color:"white",fontWeight:"500"}},"Ol\xe1, ",t.name," ",t.surName,"!"))),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},e.children)))},ee=a(327),te=function(e){var t=e.color,a=e.processes;return r.a.createElement("div",{style:{marginTop:"3%"}},r.a.createElement("h5",null,"Voc\xea tem  ",a.length," processos cadastrados."),r.a.createElement("br",null),r.a.createElement("div",{className:"col s12 m4 push-m4 center-align"},r.a.createElement("img",{src:"/images/gerenciarProc3.png",style:{margin:"10px"},alt:""}),r.a.createElement("h5",null,r.a.createElement("b",null,"Acompanhar Processos")),r.a.createElement("p",{style:{textAlign:"justify"}},"Acompanhe o andamento dos processos e veja os documentos, projetos, o hist\xf3rico e as comunica\xe7\xf5es referentes a ele."),r.a.createElement("p",{className:"btn",href:"",role:"button",style:{backgroundColor:t}},r.a.createElement(ee.a,{to:"/showEmpreend",style:{color:"white"}},"Consulta a Processos \xbb"))))},ae=[{title:"Cadastrar Processo",text:"Cadastre um novo processo, o interessado e o RT. Caso o interessado e RT estejam cadastrados, informe o nome e o formul\xe1rio ser\xe1 preenchido automaticamente.",link:"/cadastro",img:"/images/cadastro.png",w:"105px",h:"125px"},{title:"Solicitar Diretrizes",text:"Para solicitar diretrizes metropolitanas, selecione o processo e fa\xe7a o upload dos documentos necess\xe1rios em pdf. \xc9 necess\xe1rio que o processo esteja cadastrado.",link:"/solicitaDiretriz",img:"/images/solDir.jpg",w:"120px",h:"125px"},{title:"Solicitar Anu\xeancia",text:"Para solicitar anu\xeancia pr\xe9via, selecione o processo e fa\xe7a o upload dos documentos em meio digital. \xc9 necess\xe1rio que o processo tenha diretrizes metropolitanas validas.",link:"/solicitaAnuencia",img:"/images/solAnuencia2.png  ",w:"120px",h:"125px"},{title:"Acompanhar Processos",text:"Visualize os dados dos processos, interesados e respons\xe1veis t\xe9cnicos. Acompanhe o andamento dos processos, seus documentos, projetos e seu hist\xf3rico.",link:"/showEmpreend",img:"/images/process_info3.png",w:"110px",h:"125px"}],ne=function(e){var t=e.color;return r.a.createElement("div",null,ae.map(function(e,a){return r.a.createElement("div",{align:"center",className:"col s12 m6 l3",key:a},r.a.createElement("img",{src:e.img,style:{margin:"10px"},alt:"",width:e.w,height:e.h}),r.a.createElement("h5",null,r.a.createElement("b",null,e.title)),r.a.createElement("p",{style:{textAlign:"justify",padding:"0 10%"}},e.text),r.a.createElement("p",{className:"btn",href:"",role:"button",style:{backgroundColor:t}},r.a.createElement(ee.a,{to:e.link,style:{color:"white"}},e.title)," ","\xbb"))}))},re=[{title:"Diretrizes Metropolitanas",text:"Verifique a documenta\xe7\xe3o enviada, agende a vistoria e a CGT e emita a diretriz metropolitana para os processos cadastrados.",link:"/diretrizes",img:"/images/solDir.jpg",w:"105px",h:"125px"},{title:"Analisar Processos",text:"Verifique a documenta\xe7\xe3o, acesse os arquivos e documentos e analise os projetos enviados para emitir pend\xeancias ou anuir o processo.",link:"/anuencia",img:"/images/solAnuencia2.png",w:"120px",h:"125px"},{title:"Acompanhar Processos",text:"Visualize os dados dos processos, interesados e RTs. Acompanhe o andamento dos processos e veja seus documentos, projetos e seu hist\xf3rico.",link:"/showEmpreend",img:"/images/process_info3.png",w:"110px",h:"125px"}],ie=function(e){var t=e.color;return r.a.createElement("div",null,re.map(function(e,a){return r.a.createElement("div",{align:"center",className:"col s12 m6 l4",key:a},r.a.createElement("img",{src:e.img,style:{margin:"10px"},alt:"",width:e.w,height:e.h}),r.a.createElement("h5",null,r.a.createElement("b",null,e.title)),r.a.createElement("p",{style:{textAlign:"justify",padding:"0 10%",maxHeight:"75px"}},e.text),r.a.createElement("p",{className:"btn",href:"",role:"button",style:{backgroundColor:t}},r.a.createElement(ee.a,{to:e.link,style:{color:"white"}},e.title)," ","\xbb"))}))},se=function(e){function t(){var e,a;Object(J.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(K.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={setColor:""},a}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.loadEmpData(),this.props.loadRtData(),this.props.loadProcessData(),setTimeout(function(){var t=document.getElementById("setcolor").style.backgroundColor;e.setState({setColor:t})},450)}},{key:"render",value:function(){var e=Object(h.a)({},localStorage);return r.a.createElement("div",null,r.a.createElement($,{user:e},("empreend"===e.role||"rt"===e.role)&&r.a.createElement(te,{color:this.state.setColor,user:e,processes:this.props.data.processCollection}),("prefeitura"===e.role||"admin"===e.role)&&r.a.createElement(ne,{color:this.state.setColor}),"tecnico"===e.role&&r.a.createElement(ie,{color:this.state.setColor})))}}]),t}(n.Component);var oe=Object(l.connect)(function(e){return{data:e.cadastro}},function(e){return Object(o.b)({loadEmpData:F,loadRtData:T,loadProcessData:z},e)})(se),le=a(25),ce=a(8),de=function(e,t,a,n,r){return'\n    <div style=" \n        position: relative;         \n        font-size: 1rem; \n        font-family: sans-serif;\n        background-color: white;  \n        padding: 3%; \n        border: 1px solid #000;\n        text-align: justify;\n        text-justify: inter-word;\n        border: 1px solid #bbbbbb;\n        border-radius: 1%;\n    ">    \n            <strong>A/C '.concat(e,"</strong>\n            <br />\n            <p>Foi registrada uma movimenta\xe7\xe3o do processo que solicita a emiss\xe3o de Anu\xeancia \n                Pr\xe9via para o ").concat(t," <strong>").concat(a,"</strong>, situado no munic\xedpio de \n                ").concat(n,":</p>\n\n            <p><strong> ").concat(r,' </strong></p>\n\n            <p>Para maiores informa\xe7\xf5es, visite o site\n        <a href="http://anuenciadigital.ml" target="_blank">Anu\xeancia Digital</a>\n            </p>            \n            <p>Atenciosamente,</p><p><em>Equipe da Ag\xeancia de Desenvolvimento da RMBH</em></p>\n        </div>\n    ')},me=function(){var e=Object(W.a)(H.a.mark(function e(t,a,n,r,i,s,o,l){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.a.post("/api/mail",{to:"".concat(t,", ").concat(a),subject:"Atualiza\xe7\xe3o do processo ".concat(i," - ").concat(o),html:de(n,r,i,s,o)}).then(function(e){return console.log("ok")});case 2:case"end":return e.stop()}},e)}));return function(t,a,n,r,i,s,o,l){return e.apply(this,arguments)}}(),ue=a(33),pe=function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",null,r.a.createElement("button",{className:"btn-flat waves-effect btn-floating right teal",disabled:e.enable,title:"Avan\xe7ar",onClick:e.enableInput},r.a.createElement("i",{className:"material-icons"},"arrow_forward"))))},he=function(e){var t=e.disabled,a=e.icon;return r.a.createElement("div",{className:"input"},r.a.createElement("button",{className:"btn-floating left red darken-3 ".concat(e.size),disabled:t,title:"Voltar",onClick:function(){return e.onClick()}},r.a.createElement("i",{className:"material-icons"},a)))},fe=function(e){return"admin"===e.userRole?r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",style:{fontSize:"24px",color:"red",cursor:"pointer"},title:"Apagar",onClick:function(){return e.delete(e.id)}},"delete_outline")):r.a.createElement("span",null)},ve=function(e){return"admin"===e.userRole?r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",style:{fontSize:"24px",color:"teal",cursor:"pointer"},title:"Editar",onClick:function(){return e.edit(e.id)}},"edit")):r.a.createElement("span",null)},be=function(e){return e.display?r.a.createElement("button",{className:"btn-flat waves-effect btn-floating right teal darken-2",title:"Salvar",form:e.form,type:"submit"},r.a.createElement("i",{className:"material-icons"},"save")):null},Ee=function(e){return r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons right",title:"Fechar",style:{cursor:"pointer",color:"red"},onClick:e.close},"close"))},ge=function(e){var t=e.showInfo,a=e.id;return r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",id:a,onClick:t,style:{fontSize:"24px",color:"#1D90EE",cursor:"pointer"},title:"Informa\xe7\xf5es"},"info"))},ye=function(e){var t=e.id,a=e.archieve,n=e.archieved;return"admin"===e.userRole?r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",style:{fontSize:"24px",color:n?"blue":"darkorange",cursor:"pointer"},title:n?"Desarquivar":"Arquivar",onClick:function(){return a(t,n)}},n?"unarchive":"archive")):r.a.createElement("span",null)},xe=function(e){var t=e.title,a=e.subtitle,n=e.color;return r.a.createElement("div",{className:"row col s12"},r.a.createElement("div",{style:{marginTop:"20px"}},r.a.createElement("h5",null,t)),a?r.a.createElement("div",{className:"card-panel valign-wrapper",style:{marginBottom:"10px",maxHeight:"10px",backgroundColor:n,filter:"brightness(200%)",borderRadius:"10px 10px",fontSize:"1rem",fontWeight:500,fontFamily:"Calibri"}},r.a.createElement("span",{style:{color:"black"}},a)):void 0)},ke={nomeEmpreendimento:{divClassName:"input-field col s12 m6 l4",type:"text",name:"nomeEmpreendimento",label:"Nome do Empreendimento:",onBlur:null},area:{divClassName:"input-field col s12 m4 l2",type:"text",name:"area",label:"\xc1rea total da Gleba (m\xb2):",onBlur:null,pattern:"[0-9]*[.]?([0-9]{3}[.]?)?([0-9]{3}[.]?)?([,][0-9]{1,4})?"}},Ce={phoneRt:{divClassName:"input-field col s12 m6 l2",type:"text",name:"phoneRt",label:"Telefone",onBlur:null,pattern:"((([+][0-9]{1,3})?[ ]?[-]?[(]?[0-9]{2,3}[)]?[ ]?[-]?[0-9]{4,5}[ ]?[-]?[0-9]{4}))"},emailRt:{divClassName:"input-field col s12 m6 l4",type:"email",name:"emailRt",label:"E-mail",onBlur:null}},we={cpf:{divClassName:"input-field col s12 m3 l2",type:"text",name:"cpf",label:"CPF / CNPJ",pattern:"([0-9]{2}[.]?[0-9]{3}[.]?[0-9]{3}[/]?[0-9]{4}[-]?[0-9]{2})|([0-9]{3}[.]?[0-9]{3}[.]?[0-9]{3}[-]?[0-9]{2})"},phone:{divClassName:"input-field col s12 m3 l2",type:"text",name:"phone",label:"Telefone (com DDD)",pattern:"((([+][0-9]{1,3})?[ ]?[-]?[(]?[0-9]{2,3}[)]?[ ]?[-]?[0-9]{4,5}[ ]?[-]?[0-9]{4}))"},email:{divClassName:"input-field col s12 m6 l3",type:"email",name:"email",label:"E-mail"},CEP:{divClassName:"input-field col s12 m3 l1",type:"text",name:"cep",label:"CEP",pattern:"([0-9]{2}[.]?[0-9]{3}[-]?[0-9]{3})"},numero:{divClassName:"input-field col s12 m3 l1",type:"text",name:"numero",label:"N\xfamero",pattern:"[0-9]*"},complemento:{divClassName:"input-field col s12 m3 l2",type:"text",name:"complemento",label:"Complemento"},rua:{divClassName:"input-field col s12 m6 l3",type:"text",name:"rua",label:"Rua"},bairro:{divClassName:"input-field col s12 m3 l2",type:"text",name:"bairro",label:"Bairro"},cidade:{divClassName:"input-field col s12 m4 l2",type:"text",name:"cidade",label:"Cidade"},uf:{divClassName:"input-field col s12 m3 l1",type:"text",name:"uf",label:"Estado"}},De={divClassName:"input-field col s12 m4 l2",name:"modalidade",label:"Modalidade:",options:["","Desmembramento","Loteamento"]},Ne={munEmpreendimento:{divClassName:"input-field col s12 m4 l2",type:"text",name:"munEmpreendimento",label:"Munic\xedpio:",options:["","Baldim","Belo Horizonte","Betim","Brumadinho","Caet\xe9","Capim Branco","Confins","Contagem","Esmeraldas","Florestal","Ibirit\xe9","Igarap\xe9","Itaguara","Itatiaiu\xe7u","Jaboticatubas","Juatuba","Lagoa Santa","M\xe1rio Campos","Mateus Leme","Matozinhos","Nova Lima","Nova Uni\xe3o","Pedro Leopoldo","Raposos","Ribeir\xe3o das Neves","Rio Acima","Rio Manso","Sabar\xe1","Santa Luzia","S\xe3o Joaquim de Bicas","S\xe3o Jos\xe9 da Lapa","Sarzedo","Taquara\xe7u de Minas","Vespasiano"]}},Ie=function(e){var t,a,n=Ne.munEmpreendimento.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}),i=De.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}),s=function(t,a){var n=[];for(var i in t)n.push({id:i,settings:t[i],enableInput:a});return n.map(function(t,a){var n=t.settings;return r.a.createElement("div",{key:a,className:n.divClassName},r.a.createElement("input",{type:n.type,id:n.name,className:"validate",pattern:n.pattern||null,required:"complemento"!==n.name&&!0,"aria-required":"complemento"!==n.name&&!0,name:n.name,onChange:e.handleChange,value:e.data[t.id],placeholder:" ",disabled:t.enableInput,onBlur:e.handleBlur}),r.a.createElement("label",{className:"active",htmlFor:n.name,"data-error":"\u2718","data-success":"\u2713"},n.label))})},o=Object(h.a)({},localStorage);return r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement("div",{className:"tab-pane fade show active",id:"empreend"},r.a.createElement(xe,{title:"Cadastro de Processos",subtitle:"Preencha os dados do interessado e RT do processo. Caso o interessado e RT n\xe3o estejam cadastrados, um novo cadastro ser\xe1 gerado automaticamente.",color:e.color}),r.a.createElement("form",{onSubmit:e.handleSubmit},r.a.createElement("fieldset",{className:"input-field"},r.a.createElement("legend",{className:"input-field"},r.a.createElement("strong",null," 1- Interessado ")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12 m6 l4"},r.a.createElement("input",{type:"text",list:"empreendList",id:"nome",className:"validate",name:"nome",onChange:e.handleChange,value:e.data.nome,onBlur:e.handleBlurName,disabled:e.data.enableEmp,autoFocus:!0}),r.a.createElement("label",{className:"active",htmlFor:"nome"},"Nome"),(t=e.config.empCollection,a="empreendList",e.data.nome.length>2?r.a.createElement("datalist",{id:a},t.map(function(e,t){return r.a.createElement("option",{key:t},e.nome)})):void 0)),s(we,e.data.enableEmp))),r.a.createElement(pe,{enableInput:e.enableRtInput,enable:e.data.enableEmp}),r.a.createElement("fieldset",{className:"input-field"},r.a.createElement("legend",{className:"input-field"},r.a.createElement("strong",null," 2 - Respons\xe1vel T\xe9cnico ")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12 m6 l4"},r.a.createElement("input",{type:"text",list:"rtList",className:"validate",name:"nomeRt",id:"rtInput",onChange:e.handleChange,value:e.data.nomeRt,onBlur:e.handleBlurRtName,disabled:e.data.enableRt,autoFocus:e.data.autoFocusRt}),r.a.createElement("label",{className:"active",htmlFor:"nome"},"Nome"),function(e,t,a){return a.length>2?r.a.createElement("datalist",{id:t},e.map(function(e,t){return r.a.createElement("option",{key:t},e.nomeRt)})):void 0}(e.config.rtCollection,"rtList",e.data.nomeRt)),s(Ce,e.data.enableRt))),r.a.createElement(he,{onClick:e.enableEmpInput,disabled:e.data.enableRt,icon:"arrow_back"}),r.a.createElement(pe,{enableInput:e.enableProcessInput,enable:e.data.enableRt}),r.a.createElement("fieldset",{className:"input-field"},r.a.createElement("legend",{className:"input-field"},r.a.createElement("strong",null," 3 - Dados do Empreendimento ")),r.a.createElement("div",{className:"row"},s(ke,e.data.enableProcess),r.a.createElement("div",{className:"col s12 m4 l2"},r.a.createElement(ue.Input,{name:"modalidade",type:"select",label:"Modalidade",defaultValue:e.data.modalidade,onChange:e.handleChange,disabled:e.data.enableProcess},i)),r.a.createElement("div",{className:"col s12 m4 l3"},"admin"===o.role?r.a.createElement(ue.Input,{name:"munEmpreendimento",type:"select",label:"Munic\xedpio",defaultValue:e.data.munEmpreendimento,onChange:e.handleChange,disabled:e.data.enableProcess},n):r.a.createElement("div",{className:"input-field col s12 m6 l2"})))),r.a.createElement("div",null,r.a.createElement(he,{onClick:e.backToRt,disabled:e.data.enableProcess,icon:"arrow_back"}),r.a.createElement("input",{type:"submit",className:"btn right",disabled:e.data.enableProcess,style:{marginTop:"20px"},value:"Cadastrar processo"})),r.a.createElement("br",null),r.a.createElement("br",null))))},Oe=a(112),je=function(e){return e?e.split(" ").map(function(e){var t=Object(Oe.a)(e),a=t[0],n=t.slice(1);return a.toUpperCase()+n.join("").toLowerCase()}).join(" ").replace(" Da"," da").replace(" De "," de ").replace(/-mg|\/mg|, mg| - mg| -mg|,mg| \/ mg| \/mg/gi,""):e},Se=function(e){function t(){var e,a;Object(J.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(K.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={empId:"",rtId:"",nome:"",cpf:"",birth:"",phone:"",cep:"",numero:"",complemento:"",email:"",rua:"",bairro:"",cidade:"",uf:"",nomeRt:"",emailRt:"",phoneRt:"",nomeEmpreendimento:"",area:"",modalidade:"",munEmpreendimento:"",enableEmp:"",enableRt:"disabled",enableProcess:"disabled",empMatch:null,rtMatch:null},a}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.cadastro,t=e.empCollection,a=e.rtCollection,n=e.processCollection,r=e.tecCollection;t[0]||this.props.loadEmpData(),n[0]||this.props.loadProcessData(),a[0]||this.props.loadRtData(),r[0]||this.props.loadTecnicos()}},{key:"enableRtInput",value:function(){var e=Object(W.a)(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({enableEmp:"disabled",enableRt:"",enableProcess:"disabled"});case 2:document.getElementById("rtInput").focus();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"enableProcessInput",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t,a;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(h.a)({},localStorage),a=je(t.municipio),"prefeitura"!==t.role){e.next=5;break}return e.next=5,this.setState({munEmpreendimento:a});case 5:return e.next=7,this.setState(Object(h.a)({},this.state,{enableRt:"disabled",enableProcess:"",enableEmp:"disabled"}));case 7:document.getElementById("nomeEmpreendimento").focus();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"enableEmpInput",value:function(e){this.setState({enableRt:"disabled",enableProcess:"disabled",enableEmp:""})}},{key:"handleBlur",value:function(e){var t=this;if(e.preventDefault(),"cep"===e.target.name){var a=this.state.cep.replace(".","");S.a.get("https://api.postmon.com.br/v1/cep/".concat(a)).then(function(e){t.setState(Object(h.a)({},t.state,{rua:e.data.logradouro,bairro:e.data.bairro,cidade:e.data.cidade,uf:e.data.estado}))})}}},{key:"handleChange",value:function(e){e.preventDefault();var t=[],a=[];if("nome"===e.target.name){var n,r,i=e.target.value;if(t=this.props.cadastro.empCollection.filter(function(e){return e.nome.toLowerCase().match(i.toLowerCase())}),i&&t[0])this.setState(Object(h.a)({},this.state,(n={},Object(ce.a)(n,e.target.name,e.target.value),Object(ce.a)(n,"empMatch",t),n)));else t="",this.setState(Object(h.a)({},this.state,(r={},Object(ce.a)(r,e.target.name,e.target.value),Object(ce.a)(r,"empMatch",t),r)))}else if("nomeRt"===e.target.name){var s,o,l=e.target.value;if(a=this.props.cadastro.rtCollection.filter(function(e){return e.nomeRt.toLowerCase().match(l.toLowerCase())}),l&&a[0])this.setState(Object(h.a)({},this.state,(s={},Object(ce.a)(s,e.target.name,e.target.value),Object(ce.a)(s,"rtMatch",a),s)));else a="",this.setState(Object(h.a)({},this.state,(o={},Object(ce.a)(o,e.target.name,e.target.value),Object(ce.a)(o,"rtMatch",a),o)))}else this.setState(Object(h.a)({},this.state,Object(ce.a)({},e.target.name,e.target.value)))}},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c,d,m,u,p,f,v,b,E,g,y=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.state,n=a.nome,r=a.nomeRt,i=a.nomeEmpreendimento,s=a.modalidade,o=a.munEmpreendimento,l=a.empMatch,c=a.rtMatch,d=a.empId,m=a.rtId,u=Object(h.a)({},localStorage),p=this.props.cadastro.tecCollection,f=p.filter(function(e){return e.municipios.some(function(e){return e===y.state.munEmpreendimento})})[0],v="Loteamento"===s?"Processo cadastrado":"Aguardando documenta\xe7\xe3o",b={nome:this.state.nome,cpf:this.state.cpf,rua:this.state.rua,bairro:this.state.bairro,cep:this.state.cep,cidade:this.state.cidade,phone:this.state.phone,email:this.state.email.toLowerCase(),numero:this.state.numero,complemento:this.state.complemento,uf:this.state.uf},E={nomeRt:this.state.nomeRt,emailRt:this.state.emailRt.toLowerCase(),phoneRt:this.state.phoneRt},g={nomeEmpreendimento:this.state.nomeEmpreendimento,modalidade:this.state.modalidade,area:this.state.area.replace(/\./g,"").replace(/,/g,"."),munEmpreendimento:this.state.munEmpreendimento,status:v,tecnico:"T\xe9cnico n\xe3o alocado",cgt:"CGT n\xe3o agendada",vistoria:"Vistoria n\xe3o agendada",daeDir:"DAE n\xe3o recolhida",daeAnuencia:"DAE n\xe3o recolhida",processHistory:[{label:"Processo cadastrado",createdAt:new Date,user:{nome:u.name+" "+u.surName,email:u.email}}]},"Desmembramento"===this.state.modalidade&&(g.tecnico=f.name+" "+f.surName),n&&r&&i){e.next=14;break}alert("Favor preencher os dados do empreendedor, RT e empreendimento."),e.next=53;break;case 14:if(s&&(o||"admin"!==u.role)){e.next=18;break}alert("Favor preencher a modalidade do empreendimento."),e.next=53;break;case 18:if(!(n&&r&&i&&s&&o)){e.next=53;break}if(this.props.loading(!0),e.prev=20,!l||!c){e.next=28;break}return g.empId=d,g.rtId=m,e.next=26,S.a.post("/api/cadastro_process",g);case 26:e.next=43;break;case 28:if(!l||c){e.next=34;break}return g.empId=d,e.next=32,S.a.post("/api/cadastro_rt",E).then(function(e){g.rtId=e.data.RT_id,S.a.post("/api/cadastro_process",g)});case 32:e.next=43;break;case 34:if(l||!c){e.next=40;break}return g.rtId=m,e.next=38,S.a.post("/api/cadastro_emp",b).then(function(e){g.empId=e.data.Cadastro_id,S.a.post("/api/cadastro_process",g)});case 38:e.next=43;break;case 40:if(l||c){e.next=43;break}return e.next=43,S.a.post("/api/cadastro_emp",b).then(function(e){g.empId=e.data.Cadastro_id,S.a.post("/api/cadastro_rt",E).then(function(e){g.rtId=e.data.RT_id,S.a.post("/api/cadastro_process",g)})});case 43:return this.props.loading(!1),e.next=46,me(b.email,E.emailRt,b.nome,g.modalidade,g.nomeEmpreendimento,g.munEmpreendimento,"Processo cadastrado.");case 46:q("sucess",g.nomeEmpreendimento,"Processo Cadastrado."),setTimeout(function(){window.location.reload()},1600),e.next=53;break;case 50:e.prev=50,e.t0=e.catch(20),Y(e.t0);case 53:case"end":return e.stop()}},e,this,[[20,50]])}));return function(t){return e.apply(this,arguments)}}()},{key:"handleBlurName",value:function(){var e=Object(W.a)(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.empMatch||!this.state.empMatch[0]||this.state.empMatch[0].nome!==this.state.nome){e.next=7;break}return e.next=3,this.setState(Object(h.a)({},this.state,{empId:this.state.empMatch[0]._id,phone:this.state.empMatch[0].phone,cpf:this.state.empMatch[0].cpf,cep:this.state.empMatch[0].cep,numero:this.state.empMatch[0].numero,complemento:this.state.empMatch[0].complemento,email:this.state.empMatch[0].email,rua:this.state.empMatch[0].rua,bairro:this.state.empMatch[0].bairro,cidade:this.state.empMatch[0].cidade,uf:this.state.empMatch[0].uf}));case 3:Object.entries(this.state).forEach(function(e){var t=Object(le.a)(e,2),a=t[0];""!==t[1]&&document.getElementById(a)&&(document.getElementById(a).className="",document.getElementById(a).required=!1,document.getElementById(a).setAttribute("aria-required",!1))}),this.enableRtInput(),e.next=8;break;case 7:this.setState(Object(h.a)({},this.state,{empId:"",phone:"",cpf:"",birth:"",cep:"",numero:"",complemento:"",email:"",rua:"",bairro:"",cidade:"",uf:""}));case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleBlurRtName",value:function(){var e=Object(W.a)(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.rtMatch||!this.state.rtMatch[0]||this.state.rtMatch[0].nomeRt!==this.state.nomeRt){e.next=6;break}return e.next=3,this.setState({rtId:this.state.rtMatch[0]._id,phoneRt:this.state.rtMatch[0].phoneRt,emailRt:this.state.rtMatch[0].emailRt});case 3:""!==this.state.enableEmp&&(document.getElementById("rtInput").className="validade valid",this.enableProcessInput()),e.next=7;break;case 6:this.setState({rtId:"",phoneRt:"",emailRt:""});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"backToRt",value:function(){this.setState({enableEmp:"disabled",enableRt:"",enableProcess:"disabled"})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Ie,{data:this.state,config:this.props.cadastro,handleChange:this.handleChange.bind(this),handleBlurName:this.handleBlurName.bind(this),handleBlurRtName:this.handleBlurRtName.bind(this),handleSubmit:this.handleSubmit.bind(this),handleBlur:this.handleBlur.bind(this),enableRtInput:this.enableRtInput.bind(this),enableProcessInput:this.enableProcessInput.bind(this),enableEmpInput:this.enableEmpInput.bind(this),backToRt:this.backToRt.bind(this),color:this.props.cadastro.setColor}))}}]),t}(r.a.Component);var Pe=Object(l.connect)(function(e){return{cadastro:e.cadastro}},function(e){return Object(o.b)({loadEmpData:F,loadRtData:T,loadProcessData:z,loadTecnicos:L,loading:U,reduxToastr:q},e)})(Se);function Ae(){return{type:"DISABLE_EDIT"}}function Re(e){return{type:"FIND_EMP_ID",payload:e}}function _e(e){return{type:"CHANGE_SEARCH_VALUE",payload:e}}var Fe=[{name:"processHistory",label:"Hist\xf3rico do Processo",div:"col s1"},{name:"_id",label:"ID",div:"col s3"},{name:"nProcess",label:"Num. do processo",div:"col s1"},{name:"nomeEmpreendimento",label:"Nome do empreendimento",div:"col s2"},{name:"modalidade",label:"Modalidade",div:"col s1"},{name:"area",label:"\xc1rea (m\xb2)",div:"col s1"},{name:"munEmpreendimento",label:"Munic\xedpio",div:"col s1"},{name:"status",label:"Status do processo",div:"col s1"},{name:"tecnico",label:"T\xe9cnico da Ag\xeancia",div:"col s1"},{name:"cgt",label:"Data da CGT",div:"col s1"},{name:"vistoria",label:"Data da Vistoria",div:"col s1"},{name:"daeDir",label:"DAE - Diretrizes",div:"col s1"},{name:"daeAnuencia",label:"DAE - Anu\xeancia",div:"col s1"},{name:"empId",label:"EmpId",div:"col s1"},{name:"rtId",label:"rtId",div:"col s1"},{name:"createdAt",label:"Data de Cria\xe7\xe3o",div:"col s1"},{name:"updatedAt",label:"Atualizado em",div:"col s1"},{name:"__v",label:"version",div:"col s1"}],Te=[{label:"Diretrizes Municipais",nameInput:"dirMunFile"},{label:"Delimita\xe7\xe3o da \xe1rea do empreendimento (em formato kml)",nameInput:"kml"},{label:"Levantamento Planialtim\xe9trico (em formato DWG)",nameInput:"levPlanFile"},{label:"C\xf3pia do boleto e comprovante de pagamento da DAE",nameInput:"dirDaeFile",tooltip:"Clique para obter informa\xe7\xf5es sobre o c\xe1lculo e pagamento do Documento de Arrecada\xe7\xe3o Estadual (DAE)",tt:!0,link:!0}],ze=[{name:"_id",label:"ID",div:"col s1"},{name:"nome",label:"Nome",div:"col s2"},{name:"cpf",label:"CPF",div:"col s2"},{name:"rua",label:"Rua",div:"col s3"},{name:"bairro",label:"Bairro",div:"col s1"},{name:"cep",label:"CEP",div:"col s1"},{name:"cidade",label:"Cidade",div:"col s2"},{name:"phone",label:"Telefone",div:"col s1"},{name:"email",label:"E-mail",div:"col s2"},{name:"numero",label:"N\xfamero",div:"col s1"},{name:"complemento",label:"Complemento",div:"col s1"}],Me=[{name:"_id",label:"ID",div:"col s1"},{name:"nomeRt",label:"Nome",div:"col s1"},{name:"emailRt",label:"E-mail",div:"col s2"},{name:"phoneRt",label:"Telefone",div:"col s2"}],Le=[{nameInput:"regImovel",label:"Registro do Im\xf3vel",tooltip:"Certid\xe3o de Registro do Im\xf3vel com negativa de \xf4nus, emitida em at\xe9 30 dias antes da entrada do processo na Prefeitura Municipal."},{nameInput:"CNDOnus",label:"Certid\xe3o Negativa de \xf4nus reais",tooltip:"Certid\xe3o Negativa de \xf4nus reais."},{nameInput:"CNDMun",label:"Certid\xe3o Negativa de tributos municipais",tooltip:"Certid\xe3o Negativa de tributos municipais."},{nameInput:"empRG",label:"Fotoc\xf3pia da Identidade do propriet\xe1rio",tooltip:"Fotoc\xf3pia da Identidade do propriet\xe1rio; no caso de pessoa jur\xeddica, fotoc\xf3pia do contrato social e de suas altera\xe7\xf5es."},{nameInput:"art",label:"ART com comprovante de pagamento",tooltip:"ART referente ao projeto com comprovante de pagamento"},{nameInput:"decConform",label:"Declara\xe7\xe3o de conformidade",tooltip:"Documento emitido pela Prefeitura Municipal declarando a conformidade do parcelamento com a legisla\xe7\xe3o municipal"},{nameInput:"daeAnuencia",label:"C\xf3pia do boleto e comprovante de pagamento da DAE",tooltip:"Clique para obter informa\xe7\xf5es sobre o c\xe1lculo e pagamento do Documento de Arrecada\xe7\xe3o Estadual (DAE)",tt:!0,link:!0},{nameInput:"memDescritivo",label:"Memorial descritivo",tooltip:"Descri\xe7\xe3o sucinta do loteamento com suas caracter\xedsticas, \xe1reas p\xfablicas, equipamentos etc. "},{nameInput:"memDescTp",label:"Memorial Descritivo do Projeto de Terraplenagem",tooltip:"O memorial dever\xe1 conter a determina\xe7\xe3o da inclina\xe7\xe3o dos taludes de corte e aterro e a caracteriza\xe7\xe3o do tipo de solo."},{nameInput:"cemig",label:"Certid\xe3o da Cemig",tooltip:"Cemig"},{nameInput:"dtbCopasa",label:"Diretriz T\xe9cnica B\xe1sica (Copasa)",tooltip:"O memorial dever\xe1 conter a determina\xe7\xe3o da inclina\xe7\xe3o dos taludes de corte e aterro e a caracteriza\xe7\xe3o do tipo de solo."},{nameInput:"licAmbental",label:"Certid\xe3o / Licen\xe7a ambiental",tooltip:"Insira aqui a certid\xe3o de licen\xe7a ambiental emitida pelo Estado ou pelo munic\xedpio, se for o caso.",tt:!0}],Be=[{nameInput:"levPlan",label:"Levantamento Planialtim\xe9trico",tooltip:"mesma escala do Projeto Urban\xedstico, em sistema de coordenadas UTM e com delimita\xe7\xe3o e confrontantes compat\xedveis com a descri\xe7\xe3o da Certid\xe3o de Registro do im\xf3vel"},{nameInput:"mapaIso",label:"Projeto Urban\xedstico com mapa de Isodeclividade",tooltip:"Mapa de isodeclividade com intervalos 0 a 30%, 30 a 47% e acima de 47%"},{nameInput:"projTer",label:"Projeto de Terraplenagem",tooltip:"Projeto na mesma escala do Projeto Urban\xedstico e em sistema de coordenadas UTM"},{nameInput:"projDren",label:"Projeto de Drenagem",tooltip:"Projeto na mesma escala do Projeto Urban\xedstico e em sistema de coordenadas UTM"},{nameInput:"projPdf",label:"Projetos em PDF (extens\xe3o zip)",tooltip:'Crie um arqivo extens\xe3o ".zip" contendo cada um dos projetos acima em PDF.',tt:"true"},{nameInput:"outros",label:"Outros documentos (somente se solicitado)",tooltip:"Caso sejam solicitados documentos adicionais, anexe aqui. "}],qe=[{nameInput:"regImovel",label:"Registro do Im\xf3vel",tooltip:"Certid\xe3o de Registro do Im\xf3vel com negativa de \xf4nus, emitida em at\xe9 30 dias antes da entrada do processo na Prefeitura Municipal."},{nameInput:"CNDMun",label:"Certid\xe3o Negativa de tributos municipais",tooltip:"Certid\xe3o Negativa de tributos municipais."},{nameInput:"empRG",label:"Fotoc\xf3pia da Identidade do propriet\xe1rio",tooltip:"Fotoc\xf3pia da Identidade do propriet\xe1rio; no caso de pessoa jur\xeddica, fotoc\xf3pia do contrato social e de suas altera\xe7\xf5es."},{nameInput:"art",label:"ART com comprovante de pagamento",tooltip:"ART referente ao projeto com comprovante de pagamento"},{nameInput:"decConform",label:"Declara\xe7\xe3o de conformidade",tooltip:"Documento emitido pela Prefeitura Municipal declarando a conformidade do parcelamento com a legisla\xe7\xe3o municipal"},{nameInput:"daeAnuencia",label:"Comprovante de pagamento da DAE",tooltip:"Comprovante de pagamento da taxa de expediente para emiss\xe3o de anu\xeancia pr\xe9via por meio de Documento de Arrecada\xe7\xe3o Estadual"},{nameInput:"memDescritivo",label:"Memorial descritivo",tooltip:"Descri\xe7\xe3o sucinta do loteamento com suas caracter\xedsticas, \xe1reas p\xfablicas, equipamentos etc. "}],Ue=[{nameInput:"projDesmemb",label:"Projeto de Desmembramento"}],Ve=function(){var e=[];return Te.forEach(function(t){e.push(t)}),Le.forEach(function(t){e.push(t)}),Be.forEach(function(t){e.push(t)}),e.push({nameInput:"diretrizFile",label:"Diretrizes Metropolitanas"},{nameInput:"notaTecnica",label:"Nota T\xe9cnica"},{nameInput:"anuenciaFile",label:"Certid\xe3o de Anu\xeancia Metropolitana"},{nameInput:"projDesmemb",label:"Projeto de Desmembramento"}),e},He=function(e){return Ve().filter(function(t){return t.nameInput.match(e)})[0].label},We=function(e,t){var a;if((a=ze.filter(function(t){return t.name===e}).concat(Me.filter(function(t){return t.name===e})).concat(Fe.filter(function(t){return t.name===e})))&&a.length>0)switch(t){case"div":return a[0].div;case"label":return a[0].label;default:return null}},Ge=function(e){var t,a=e.empId,n=e.rtId,i=e.showEmp,s=e.showRt,o=e.close,l=e.empCollection,c=e.rtCollection,d="";return i&&l&&(d=l.filter(function(e){return e._id.match(a)}),t=Object.entries(d[0]).splice(2,9)),s&&c&&(d=c.filter(function(e){return e._id.match(n)}),t=Object.entries(d[0]).splice(2,2)),""!==d&&(i||s)?r.a.createElement("div",{className:"card z-depth-5",style:{position:"fixed",top:"30%",right:"33%",left:"33%",padding:"5px 0px 7px 20px",borderRadius:"15px",border:"1px solid #aaa"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"center"},r.a.createElement("h5",null,d[0].nome)),r.a.createElement("div",{className:"center"},r.a.createElement("h5",null,d[0].nomeRt))),r.a.createElement("div",{className:"row"},t.map(function(e,t){return r.a.createElement("div",{className:"col s12 m6",key:t},r.a.createElement("strong",null," ",We(e[0],"label"),": "),e[1]," ")})),r.a.createElement("div",{style:{position:"absolute",top:"0.4%",right:"0.4%"}},r.a.createElement(Ee,{close:o}))):null},Ye=Ne.munEmpreendimento.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}),Je=De.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}),Xe=function(e){return e.data.edit&&e.data.item?r.a.createElement("form",{onSubmit:e.submit,id:"".concat(e.data.select)},function(){if(e.data.edit&&e.data.item){var t=function(e,t){return e.splice(e.length-t,e.length),e},a=e.data.item,n=[];for(var i in a)n.push({key:i,value:a[i]});var s=n;return"emp"===e.data.select&&n.length>14&&(s=t(n,3)),"rt"===e.data.select&&n.length>5&&(s=t(n,3)),"rt"===e.data.select&&5===n.length&&(s=t(n,1)),"process"===e.data.select&&(s=t(n.slice(2),9)).push(n.filter(function(e){return"nProcess"===e.key})[0]),s.map(function(t,a){return"_id"===t.key?void 0:"modalidade"===t.key?r.a.createElement("div",{className:"col s2",key:a+100},r.a.createElement(ue.Input,{name:"modalidade",type:"select",label:"Modalidade",defaultValue:e.data.item[t.key],onChange:e.change},Je)):"munEmpreendimento"===t.key?r.a.createElement("div",{className:"col s4",key:a+200},r.a.createElement(ue.Input,{name:"munEmpreendimento",type:"select",label:"Munic\xedpio",defaultValue:e.data.item[t.key],onChange:e.change},Ye)):r.a.createElement("div",{key:a,className:"input-field col s3"},r.a.createElement("label",{className:"active"},t.key.replace(/\w/,function(e){return e.toUpperCase()})),r.a.createElement("input",{type:"text",className:"active",name:t.key,value:e.data.item[t.key],onChange:e.change}))})}return null}()):null},Ke=(a(88),function(e){var t=e.edit,a=e.archieved,n=e.showArchieved,i=e.select,s=localStorage.getItem("role"),o="Visualize e busque por dados dos processos, interesados e RTs utilizando a barra de busca abaixo";return"rt"===s&&(o="Visualize e busque por dados dos processos utilizando a barra de busca abaixo"),r.a.createElement("div",null,r.a.createElement(xe,{title:"Acompanhar Processos",subtitle:o,color:e.color}),!1===t?r.a.createElement("div",{className:"row"},"rt"!==s&&r.a.createElement("div",{className:"col s12"},r.a.createElement("label",null,"Selecione o m\xe9todo de Busca"),r.a.createElement("br",null),r.a.createElement("select",{className:"browser-default",value:i,onChange:e.onSelect},r.a.createElement("option",{value:"",key:"1",label:"Selecionar"},"Selecionar "),r.a.createElement("option",{value:"emp",key:"2",label:"Empreendedor"},"Empreendedor "),r.a.createElement("option",{value:"rt",key:"3",label:"Respons\xe1vel T\xe9cnico"},"Respons\xe1vel T\xe9cnico "),r.a.createElement("option",{value:"process",key:"4",label:"Processo"},"Processo "))),r.a.createElement("div",{className:"col s12",style:{marginTop:"1%"}},r.a.createElement("div",{className:"process"===i?"col s9":"col s12"},r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"search"},"Pesquisar"),r.a.createElement("input",{id:"search",value:e.search,onChange:e.change,type:"search",placeholder:"digite pelo menos 3 d\xedgitos para procurar"}))),"process"===i&&r.a.createElement("div",{className:"col s3",style:{position:"relative",left:"5%",marginTop:"3%"}},r.a.createElement("input",{id:"showArchieved",type:"checkbox",checked:!0===a,onChange:n}),r.a.createElement("label",{style:{fontSize:"0.9rem"},htmlFor:"showArchieved"},"Processos anu\xeddos/arquivados")))):r.a.createElement("h5",{style:{marginBottom:"40px"}},"Editar dados"))}),Qe=function(e){var t,a=e.redux,n=e.emps,i=e.rts,s=e.process,o=e.empFields,l=e.rtFields,c=e.showRt,d=e.edit,m=e.deleteOne,u=e.data,p=e.fields,h=e.divConfig,f=e.color,v=e.empDetails,b=e.rtDetails,E=e.showInfo,g=e.clearLog,y=e.archieve,x=localStorage.getItem("role"),k=[],C=[];n&&n[0]&&!1===u.edit?(k=n,t=o,C=ze,h=["col s3","col s2","col s2","col s1","col s1","col s2"]):i&&i[0]&&!1===u.edit?(k=i,t=l,C=Me,h=["col s4","col s3","col s4"]):s&&s[0]&&!1===u.edit&&(k=s,t=p,C=Fe);var w=[];if(C.length>0&&t.forEach(function(e){w.push(C.filter(function(t){return t.name===e})[0])}),k&&k[0])return r.a.createElement("div",{className:"z-depth-3",style:{padding:"0px 11px",borderRadius:"10px"}},r.a.createElement("div",{className:"row tableHeader",style:{backgroundColor:f,filter:"brightness(190%)",padding:"5px 0px"}},w.map(function(e,t){return"_id"!==e.name?r.a.createElement("div",{className:h[t],key:t}," ",e.label," "):void 0}),"process"===u.select?r.a.createElement("div",null,r.a.createElement("div",{className:"col s2"},"Interessado "),c?r.a.createElement("div",{className:"col s1"},"RT "):void 0):void 0,("admin"===x||"process"===u.select)&&r.a.createElement("div",{className:"col s1"},"Informa\xe7\xf5es")),k.map(function(e,n){var i,s,o=[],l=a.empCollection.filter(function(t){return t._id.match(e.empId)});for(var p in l)i={key:p,values:l[p]};for(var f in s=a.rtCollection.filter(function(t){return t._id.match(e.rtId)}))s={key:f,values:s[f]};for(var k in e)o.push({key:k,values:e[k]});var C=[];return t&&t.length>0&&t.map(function(e){return C.push(o.filter(function(t){return t.key===e})[0])}),r.a.createElement("div",{className:"row",key:n,style:{borderBottom:"1px dotted #bbb",paddingBottom:"1%"}},C.map(function(e,t){return"_id"!==e.key?!isNaN(Date.parse(e.values))&&String(e.values).length>15?r.a.createElement("div",{key:t,className:"col s1"},new Date(e.values).getDate(),"/",new Date(e.values).getMonth()+1,"/",new Date(e.values).getFullYear()):r.a.createElement("div",{key:t,className:h[t],style:{wordBreak:"break-word"}},e.values):void 0}),"process"===u.select&&i&&i.values?r.a.createElement("div",{id:i.values._id,className:"col s2",style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:v},i.values.nome):r.a.createElement("div",{className:"col s2"},"  "),c&&"process"===u.select&&s&&s.values?r.a.createElement("div",{id:s.values._id,className:"col s1",style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:b},s.values.nomeRt):r.a.createElement("div",{className:"col s1"}," "),"process"===u.select?r.a.createElement("div",{className:"col s2",style:{display:"flex",justifyContent:"space-between",maxWidth:"95px",margin:"0 auto",padding:"0px 5px",height:"100%",verticalAlign:"middle",paddingLeft:"".concat("admin"!==x&&"3%")}},r.a.createElement(ge,{showInfo:E,clearLog:g,id:e._id}),r.a.createElement(ve,{edit:d,id:e._id,userRole:x}),r.a.createElement(ye,{archieve:y,id:e._id,userRole:x,archieved:u.archieved}),r.a.createElement(fe,{delete:m,id:e._id,userRole:x})):r.a.createElement("div",{className:"col s2 right",style:{display:"flex",justifyContent:"space-around",maxWidth:"95px",margin:"0 auto",padding:"0px 5px",height:"100%",verticalAlign:"middle"}},r.a.createElement(ve,{edit:d,id:e._id,userRole:x}),r.a.createElement(fe,{delete:m,id:e._id,userRole:x})))}));var D="processo";return"emp"===u.select&&(D="empreendedor"),"rt"===u.select&&(D="respons\xe1vel t\xe9cnico"),u.edit?null:r.a.createElement("div",{style:{textAlign:"center",padding:"4% 0"}},r.a.createElement("strong",null,"Nenhum ",D," encontrado. Verifique se que seu processo foi cadastrado pela prefeitura."))},Ze=function(e){return/\d/.test(e)?new Date(e).getDate()+"/"+(new Date(e).getMonth()+1)+"/"+new Date(e).getFullYear()+", "+new Date(e).getHours()+":"+(new Date(e).getMinutes()<10?"0"+new Date(e).getMinutes():new Date(e).getMinutes())+"h":e},$e=function(e){return e>1024&&e<1048576?Math.round(e/1024)+" KB":e>=1048576&&e<1073741824?(e/1024/1024).toFixed(2)+" MB":e+" bytes"},et=function(e,t){if(!0===e)return{position:"fixed",top:t[0],right:"15%",left:"15%",height:t[1],borderRadius:"15px",backgroundColor:"#fbfbfb",border:"2px solid #aaa",marginBottom:"25px",marginTop:"25px",overflowY:"auto",overflowX:"hidden",zIndex:1,padding:"2rem"}},tt=function(e,t){S()({url:"/api/download/".concat(e.target.id),method:"GET",responseType:"blob"}).then(function(e){var a=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",t),document.body.appendChild(n),n.click()}).catch(function(e){console.log(e),Y(e)})},at=function(e){function t(){return Object(J.a)(this,t),Object(K.a)(this,Object(Q.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentWillUnmount",value:function(){this.props.clearLog()}},{key:"render",value:function(){var e=this.props,t=e.process,a=e.index,n=e.clearLog,i=e.soloComponent,s=e.hideLog,o=t.processHistory[a];return r.a.createElement("div",{style:et(i,["8%","85%"])},!0===i?r.a.createElement("div",{className:"row",style:{textAlign:"center"}},r.a.createElement("div",{style:{position:"absolute",top:"0.5%",right:"0.5%"}},r.a.createElement(Ee,{close:s}))):null,"Pend\xeancias para emiss\xe3o de diretrizes"===o.label||o.label.match("An\xe1lise")?r.a.createElement("div",null,r.a.createElement("h5",null,o.label)," ",r.a.createElement("hr",null)," ",r.a.createElement("br",null)):r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("h5",null," ",r.a.createElement("img",{alt:"",src:"/images/folderIcon2.jpg",style:{paddingLeft:"20px",marginRight:"20px"}})," Arquivos > ",t.nomeEmpreendimento," > ",o.label)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6"},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/multipleFiles2.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Arquivo"))),r.a.createElement("div",{className:"col s3"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Data de Upload")),r.a.createElement("div",{className:"col s3"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Tamanho")))),"Pend\xeancias para emiss\xe3o de diretrizes"===o.label?r.a.createElement("div",null,o.pendencias):o.label.match("An\xe1lise")?r.a.createElement("div",{dangerouslySetInnerHTML:{__html:o.pendencias}}):o.files.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6"},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/genericFile.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("span",{id:e.id,style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:function(t){return tt(t,e.originalName)}},(a=e.fieldName,Ve().filter(function(e){return e.nameInput.match(a)})[0].label)))),r.a.createElement("div",{className:"col s3"},Ze(e.uploadDate)),r.a.createElement("div",{className:"col s3"},$e(e.fileSize))));var a}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s1 left",style:{marginTop:"1%"}},r.a.createElement("strong",null,r.a.createElement("i",{className:"material-icons",style:{marginTop:"10%",color:"teal",cursor:"pointer",border:"1px solid #bbb",borderRadius:"55%"},onClick:n}," arrow_back")))))}}]),t}(n.Component),nt=function(e){var t=e.logDetails,a=e.index,n=e.process,i=e.showLog,s=e.clearLog,o=e.soloComponent,l=e.hideLog;return!1===t?r.a.createElement("div",{style:et(o,["15%","70%"])},!0===o?r.a.createElement("div",{className:"row",style:{textAlign:"center"}},r.a.createElement("div",{style:{position:"absolute",top:"0.5%",right:"0.5%"}},r.a.createElement(Ee,{close:l})),r.a.createElement("h5",null,"Hist\xf3rico do Processo - ",n.nomeEmpreendimento)):null,r.a.createElement("div",{className:"row",style:{padding:"2% 0% 0% 3%",fontSize:"18px"}},r.a.createElement("div",{className:"col s12 m4"}," ",r.a.createElement("strong",null,"Status do processo")," "),r.a.createElement("div",{className:"col s12 m4 center"}," ",r.a.createElement("strong",null,"Usu\xe1rio")," "),r.a.createElement("div",{className:"col s12 m4 ",style:{paddingLeft:"9%",fontsize:"10px"}}," ",r.a.createElement("strong",null,"Data")," ")),n.processHistory.map(function(e,t){return r.a.createElement("div",{className:"row",key:t,style:{paddingLeft:"3%"}},"Processo cadastrado"===e.label||"Processo Arquivado"===e.label||"Processo Desarquivado"===e.label?r.a.createElement("div",null,r.a.createElement("div",{className:"col s12 m4"},e.label),r.a.createElement("div",{className:"col s12 m4 center"},e.user.nome||" "),r.a.createElement("div",{className:"col s12 m3 center"}," ",Ze(e.createdAt))):r.a.createElement("div",null,r.a.createElement("div",{className:"col s12 m4"},r.a.createElement("span",{style:{textDecoration:"underline",cursor:"pointer",color:"blue"},id:t,onClick:i},e.label)),r.a.createElement("div",{className:"col s12 m4 center"},e.user.nome||" "),r.a.createElement("div",{className:"col s12 m3 center"}," ",Ze(e.createdAt))))})):r.a.createElement(at,{process:n,index:a,clearLog:s,soloComponent:o,hideLog:l})},rt=function(e){function t(){var e;return Object(J.a)(this,t),(e=Object(K.a)(this,Object(Q.a)(t).call(this))).state={search:"",select:"process",edit:!1,selectId:"",itemId:"",item:{},nome:"",setColor:"",showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:"",cgt:"",showInfo:"",process:"",logIndex:"",logDetails:!1,archieved:!1},e.handleSelect=function(t){e.setState(Object(h.a)({},e.state,{select:t.target.value}))},e.enableEdit=function(t){var a=[],n={};"emp"===e.state.select&&(a=e.props.cadastro.empCollection.filter(function(e){return e._id.match(t)}),n=Object.assign({},a)),"rt"===e.state.select&&(a=e.props.cadastro.rtCollection.filter(function(e){return e._id.match(t)}),n=Object.assign({},a)),"process"===e.state.select&&(a=e.props.cadastro.processCollection.filter(function(e){return e._id.match(t)}),n=Object.assign({},a)),e.setState(Object(h.a)({},e.state,{item:n[0],edit:!0}))},e.disableEdit=function(){e.props.disableEdit(),e.setState(Object(h.a)({},e.state,{edit:!1}))},e.editValue=function(t){if(e.state.item){var a=Object.assign({},e.state.item,Object(ce.a)({},t.target.name,t.target.value));e.setState(Object(h.a)({},e.state,{item:a}))}},e.escFunction=function(t){27===t.keyCode&&(e.state.logDetails?e.clearLog():e.state.showInfo?e.hideLog():(e.state.showEmpDetails||e.state.showRtDetails)&&e.closeDetails())},e}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.cadastro,t=e.empCollection,a=e.rtCollection,n=e.processCollection;"rt"!==localStorage.getItem("role")&&(a[0]||this.props.loadRtData()),t[0]||this.props.loadEmpData(),n[0]||this.props.loadProcessData(),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"deleteHandler",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.state.select,!window.confirm("Excluir registro?")){e.next=7;break}return e.next=4,S.a.delete("/api/delete/item?id=".concat(t,"&el=").concat(a)).catch(function(e){return console.log(e)});case 4:"emp"===a&&this.props.loadEmpData(),"rt"===a&&this.props.loadRtData(),"process"===a&&this.props.loadProcessData();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSearchBar",value:function(){var e=Object(W.a)(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({search:t.target.value});case 2:this.props.changeHandler(this.state.search);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"saveEdit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.item||"process"===this.state.select){e.next=8;break}return a=this.state.select,e.next=4,S.a.put("/api/edit",{el:a,item:this.state.item}).then(this.setState({edit:!1})).catch(function(e){return alert(e)});case 4:"emp"===a&&this.props.loadEmpData(),"rt"===a&&this.props.loadRtData(),e.next=14;break;case 8:if(!this.state.item){e.next=14;break}return delete(n=Object.assign({},this.state.item)).processHistory,e.next=13,S.a.put("/api/editProcess",{item:n}).then(this.setState({edit:!1})).catch(function(e){return alert(e)});case 13:this.props.loadProcessData();case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:""})}},{key:"showInfo",value:function(e){var t=this.props.cadastro.processCollection.filter(function(t){return t._id.match(e.target.id)});this.setState({showInfo:!0,process:t[0]})}},{key:"showLog",value:function(e){this.setState({logIndex:e.target.id,logDetails:!0})}},{key:"hideLog",value:function(){this.setState({logIndex:"",showInfo:!1})}},{key:"clearLog",value:function(){this.setState({logDetails:!1,logIndex:""})}},{key:"showArchieved",value:function(){this.setState({archieved:!this.state.archieved})}},{key:"archieve",value:function(){var e=Object(W.a)(H.a.mark(function e(t,a){var n,r,i,s,o,l,c,d;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.cadastro.processCollection,r=Object(h.a)({},localStorage),i={nome:r.name+" "+r.surName,email:r.email},s={item:{_id:t},processHistory:{createdAt:new Date,user:i}},a?(o=n.filter(function(e){return e._id.match(t)})[0],l=o.processHistory,c=(c=l.filter(function(e){return"Processo Arquivado"!==e.label}).filter(function(e){return"Processo Desarquivado"!==e.label}))[c.length-1],((d=c.label).match("Processo cadastrado")||d.match("An\xe1lise "))&&o.modalidade.match("Desmembramento")&&(d="Aguardando documenta\xe7\xe3o"),(d.match("Entrada")||d.match("Anu\xeancia pr\xe9via solicitada"))&&(d="Aguardando An\xe1lise"),d.match("An\xe1lise ")&&(d="Diretrizes Metropolitanas emitidas"),d.match("Diretrizes metropolitanas solicitadas")&&(d="Aguardando Diretrizes Metropolitanas"),d.match("Pend\xeancias para")&&(d="Processo cadastrado"),s.item.status=d,s.processHistory.label="Processo Desarquivado"):(s.item.status="Processo Arquivado",s.processHistory.label="Processo Arquivado"),e.next=7,S.a.put("/api/editProcess/",s).catch(function(e){return console.log(e)});case 7:this.props.loadProcessData();case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[],a=[],n=[],i=[],s=this.state,o=s.search,l=s.select,c=s.archieved,d=o.trim().toLowerCase(),m=this.props.cadastro,u=m.empCollection,p=m.rtCollection,h=m.processCollection;return o&&o.length>2&&"emp"===l&&u?t=u.filter(function(e){return e.nome.toLowerCase().match(d)}).slice(0,20):(!o||o.length<=2)&&"emp"===l&&(t=u.slice(0,30)),o&&o.length>2&&"rt"===l&&p?a=p.filter(function(e){return e.nomeRt.toLowerCase().match(d)}).slice(0,20):(!o||o.length<=2)&&"rt"===l&&(a=p.slice(0,30)),o&&o.length>2&&"process"===l&&h?(i=h.filter(function(e){return"Processo Anu\xeddo"===e.status||"Processo Arquivado"===e.status}),n=!0===c?i.filter(function(e){return e.nomeEmpreendimento.toLowerCase().match(d)}).slice(0,20):h.filter(function(e){return"Processo Arquivado"!==e.status}).filter(function(e){return"Processo Anu\xeddo"!==e.status}).filter(function(e){return e.nomeEmpreendimento.toLowerCase().match(d)}).slice(0,20)):(!o||o.length<=2)&&"process"===l&&(i=h.filter(function(e){return"Processo Anu\xeddo"===e.status||"Processo Arquivado"===e.status}),(n=!0===c?i:h.filter(function(e){return"Processo Arquivado"!==e.status}).filter(function(e){return"Processo Anu\xeddo"!==e.status}).slice(0,30)).sort(function(e,t){var a=new Date(e.updatedAt),n=new Date(t.updatedAt);return a&&n?n.getTime()>a.getTime()?1:a.getTime()>n.getTime()?-1:0:null})),r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement(Ke,{search:o,select:l,edit:this.state.edit,redux:this.props.cadastro,onSelect:this.handleSelect,change:function(t){return e.handleSearchBar(t)},color:this.props.cadastro.setColor,archieved:this.state.archieved,showArchieved:this.showArchieved.bind(this)}),this.state.showInfo?r.a.createElement("div",null,r.a.createElement(nt,{process:this.state.process,logDetails:this.state.logDetails,index:this.state.logIndex,showLog:this.showLog.bind(this),hideLog:this.hideLog.bind(this),clearLog:this.clearLog.bind(this),soloComponent:!0})):null,r.a.createElement("div",null,r.a.createElement(Qe,{data:this.state,redux:this.props.cadastro,emps:t,rts:a,process:n,empFields:["nome","cpf","rua","cidade","phone","email"],rtFields:["nomeRt","emailRt","phoneRt"],showRt:!1,fields:["nProcess","nomeEmpreendimento","modalidade","area","munEmpreendimento","status","tecnico","updatedAt"],divConfig:["col s1","col s2","col s1","col s1","col s1","col s1","col s1","col s1"],edit:this.enableEdit.bind(this),deleteOne:this.deleteHandler.bind(this),color:this.props.cadastro.setColor,empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),showInfo:this.showInfo.bind(this),clearLog:this.clearLog.bind(this),archieve:this.archieve.bind(this)}),r.a.createElement(Xe,{redux:this.props.cadastro,data:this.state,disableEdit:this.disableEdit.bind(this),change:function(t){return e.editValue(t)},submit:function(t){return e.saveEdit(t)}})),r.a.createElement("div",null,this.state.edit?r.a.createElement(he,{onClick:this.disableEdit,icon:"arrow_back"}):null,r.a.createElement(be,{form:"".concat(l),display:this.state.edit}),r.a.createElement(Ge,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.cadastro.empCollection,rtCollection:this.props.cadastro.rtCollection})))}}]),t}(n.Component);var it=Object(l.connect)(function(e){return{cadastro:e.cadastro}},function(e){return Object(o.b)({loadEmpData:F,loadRtData:T,loadProcessData:z,handleEdit:Re,disableEdit:Ae,changeHandler:_e,reduxToastr:q},e)})(rt),st=function(e){var t=e.div||"col s1";return e.cond?r.a.createElement("div",{className:t},e.value||e.children):null},ot=function(e){var t=e.search,a=e.collection,n=e.rtCollection,i=e.processCollection,s=e.onSelect,o=e.checked,l=e.fields,c=e.color,d=e.renderEmp,m=e.renderRt,u=e.empDetails,p=e.rtDetails,h=e.showFiles,f=e.ocultarArquivos,v=[];if(i&&i[0]){for(var b in i)i[b].solDirFiles&&i[b].solDirFiles.length>0&&v.push(i[b].solDirFiles);v[0]}var E=[];return l.forEach(function(e){E.push(Fe.filter(function(t){return t.name===e})[0])}),r.a.createElement("div",null,t.length>0?r.a.createElement("div",{className:"row tableHeader",style:{backgroundColor:c}},E.map(function(e,t){return r.a.createElement(st,{cond:"_id"!==e.name,value:e.label,div:e.div,key:t})}),r.a.createElement(st,{cond:d,value:"Interessado",div:"col s2"}),r.a.createElement(st,{cond:m,value:"RT"}),r.a.createElement(st,{cond:!f,value:"Arquivos"}),r.a.createElement("div",{className:"col s1"},"Selecionar")):null,t.length>0?t.map(function(e,t){var i=[],c=a.filter(function(t){return t._id.match(e.empId)})[0],v=n.filter(function(t){return t._id.match(e.rtId)})[0];for(var b in e)i.push({key:b,values:e[b]});var E=[];return l&&l.length>0&&l.map(function(e){return E.push(i.filter(function(t){return t.key===e})[0])}),r.a.createElement("div",{className:"row",key:t},E.map(function(e,t){return"_id"!==e.key?!isNaN(Date.parse(e.values))&&String(e.values).length>15?r.a.createElement("div",{key:t,className:We(e.key,"div")},new Date(e.values).getDate(),"/",new Date(e.values).getMonth()+1,"/",new Date(e.values).getFullYear()):r.a.createElement("div",{key:t,className:We(e.key,"div"),style:{wordBreak:"break-word"}},e.values):null}),c?r.a.createElement(st,{cond:[c,d],div:"col s2"},r.a.createElement("span",{id:c._id,className:"link",onClick:u},c.nome)):r.a.createElement("div",{className:"col s1"}," "),v?r.a.createElement(st,{cond:[v,m],div:"col s1"},r.a.createElement("span",{id:v._id,className:"link",onClick:p},v.nomeRt)):r.a.createElement("div",{className:"col s1"}," "),r.a.createElement(st,{cond:!f,div:"col s1"},r.a.createElement("span",{id:"".concat(e._id,"z"),className:"link",onClick:h},"Ver arquivos")),r.a.createElement("div",{className:"col s1 center"},r.a.createElement("input",{id:e._id,type:"radio",name:"group1",onClick:s,value:E.map(function(e){return"_id"===e.key?"".concat(e.values):void 0}),defaultChecked:o===e._id}),r.a.createElement("label",{htmlFor:e._id}," ")))}):r.a.createElement("div",{style:{textAlign:"center",padding:"4% 0"}},r.a.createElement("strong",null,"Nenhum processo encontrado.")))},lt=function(e){var t,a=e.setColor,n=e.search,i=e.searchArray,s=e.selectProcess,o=e.submitFiles,l=e.data,c=e.redux,d=e.children,m=e.empDetails,u=e.rtDetails;return l.selectedId&&(t=c.processCollection.filter(function(e){return e._id.match(l.selectedId)})),r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement(xe,{title:"Solicitar Diretrizes Metropolitanas",subtitle:'Para solicitar diretrizes metropolitanas, selecione o processo na lista abaixo, \r fa\xe7a o upload dos documentos necess\xe1rios em pdf e clique em "Solicitar Diretrizes".',color:a}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("label",null,"Filtrar"),r.a.createElement("input",{className:"input",type:"text",name:"search",onChange:n})),r.a.createElement("div",{className:"col s1 right",style:{paddingTop:"35px"}},r.a.createElement("i",{className:"material-icons"},"search"))),r.a.createElement("div",{className:"z-depth-3",style:{padding:"0px 10px 1px",borderRadius:"10px"}},r.a.createElement(ot,{search:i,collection:c.empCollection,rtCollection:c.rtCollection,onSelect:s,checked:l.checked,color:a,fields:["_id","nProcess","nomeEmpreendimento","modalidade","area","munEmpreendimento","status","tecnico"],renderEmp:!0,renderRt:!0,empDetails:m,rtDetails:u,ocultarArquivos:!0})),r.a.createElement("div",{className:"row",style:{marginTop:"15px"}},r.a.createElement("div",{className:"col s1 right"},r.a.createElement(he,{disabled:null===l.checked,icon:"clear",onClick:e.clear}))),r.a.createElement("div",null,l.selectedId&&l.checked?r.a.createElement("div",null,r.a.createElement("fieldset",null,r.a.createElement("legend",null,t[0].nomeEmpreendimento," - Documentos para solicita\xe7\xe3o de diretrizes"),d),r.a.createElement("button",{className:"btn teal darken-3 right",style:{marginBottom:"20px"},onClick:o},"Solicitar Diretrizes")):void 0))},ct=a(54),dt=a.n(ct),mt=function(e){var t=e.object,a=t.tooltip,n=t.tt,i=t.link;return r.a.createElement("div",{className:"row",style:{padding:"10px",paddingLeft:"20px",paddingRight:"20px",margin:0}},r.a.createElement("label",{style:{fontSize:"16px",paddingTop:"15px",fontWeight:450,color:"black"}},e.object.label),n&&r.a.createElement("i",{style:{marginLeft:"9px",color:"#42a5f5",fontSize:"1.2rem",cursor:i?"pointer":"default"},className:"material-icons",onClick:function(){return function(e){e&&window.open("http://www.agenciarmbh.mg.gov.br/anuencia-previa-2/#1544200696367-a39f6fa0-7d0c","_blank")}(i)},"data-tip":a}," help_outline "),r.a.createElement(dt.a,null),r.a.createElement("div",{className:"row file-field input-field",key:e.object.nameInput},r.a.createElement("div",{className:"file-path-wrapper row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("input",{className:"file-path validate",type:"text",placeholder:"Carregar arquivo"})),r.a.createElement("div",{className:"col s1 right"},r.a.createElement("i",{className:"material-icons grey-text text-darken-1 small"},"attach_file"),r.a.createElement("input",{type:"file",name:e.object.nameInput,onChange:e.upload})))))},ut=function(e){function t(){var e;return Object(J.a)(this,t),(e=Object(K.a)(this,Object(Q.a)(t).call(this))).state={searchValue:"",dataMatch:[],toggleUpload:!1,selectedId:"",checked:null,files:[],form:null,dirMunFile:"",levPlanFile:"",dirDaeFile:"",kml:"",showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:""},e.escFunction=function(t){var a=e.state,n=a.selectedId,r=a.showEmpDetails,i=a.showRtDetails;27===t.keyCode&&(r||i?e.closeDetails():n&&e.clearSearch())},e}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.redux,t=e.empCollection,a=e.rtCollection,n=e.processCollection,r=e.tecCollection;t[0]||this.props.loadEmpData(),n[0]||this.props.loadProcessData(),a[0]||this.props.loadRtData(),r[0]||this.props.loadTecnicos(),this.props.loadFilesData(),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleSearch",value:function(e){this.setState(Object(h.a)({},this.state,{searchValue:e.target.value,checked:!1})),document.getElementsByName("group1").forEach(function(e){return e.checked=!1})}},{key:"clearSearch",value:function(e){this.setState(Object(h.a)({},this.state,{searchValue:"",checked:null})),document.getElementsByName("search")[0].value="",document.getElementsByName("group1").forEach(function(e){e.checked=!1})}},{key:"handleSelect",value:function(){var e=Object(W.a)(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState(Object(h.a)({},this.state,{selectedId:t.target.value.replace(/,/g,""),checked:t.currentTarget.id}));case 2:document.getElementById(this.state.checked).checked="checked";case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fileUpload",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target,n=a.name,r=a.files,"kml"!==n&&"dirDaeFile"!==n||r[0]&&r[0].size>2097152&&(document.getElementsByName(n)[0].value="",alert("Arquivo excedeu o limite permitido (2MB)!")),"levPlanFile"!==n&&"dirMunFile"!==n||r[0]&&r[0].size>5242880&&(document.getElementsByName(n)[0].value="",alert("Arquivo excedeu o limite permitido (5MB)!")),(i=new FormData).append("processId",this.state.selectedId),this.setState(Object(h.a)({},this.state,Object(ce.a)({},n,r[0]))),s=[],e.next=9,Te.map(function(e){return s.push(e.nameInput)});case 9:return e.next=11,s.forEach(function(e){for(var t in o.state)t.match(e)&&i.append(e,o.state[t])});case 11:this.setState({form:i});case 12:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c,d,m,u,p,f,v,b,E,g,y,x,k=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.props.redux.processCollection.filter(function(e){return e._id.match(k.state.selectedId)})[0],n=this.props.redux.empCollection.filter(function(e){return e._id.match(a.empId)})[0],r=this.props.redux.rtCollection.filter(function(e){return e._id.match(a.rtId)})[0],i=Object(h.a)({},localStorage),s=a.modalidade,o=a.nomeEmpreendimento,l=a.munEmpreendimento,c=this.props.redux.tecCollection,d=this.state.form,m=c.filter(function(e){return e.municipios.some(function(e){return e===a.munEmpreendimento})})[0],u=[],p=[],f=0,!d){e.next=24;break}for(v=!0,b=!1,E=void 0,e.prev=8,g=d.entries()[Symbol.iterator]();!(v=(y=g.next()).done);v=!0)(x=y.value)[1]&&"undefined"!==x[1]&&(f+=1);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),b=!0,E=e.t0;case 16:e.prev=16,e.prev=17,v||null==g.return||g.return();case 19:if(e.prev=19,!b){e.next=22;break}throw E;case 22:return e.finish(19);case 23:return e.finish(16);case 24:if(p=a.processHistory.filter(function(e){return"Pend\xeancias para emiss\xe3o de diretrizes"===e.label}),!(f>4||p.length>0)){e.next=52;break}return this.props.loading(!0),e.prev=27,e.next=30,S.a.post("/api/fileUpload",this.state.form).then(function(e){e.data.file.forEach(function(e){return u.push(e)})});case 30:return e.next=32,S.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:"Aguardando Diretrizes Metropolitanas",tecnico:m.name+" "+m.surName},processHistory:{label:"Diretrizes metropolitanas solicitadas",createdAt:new Date,files:u,user:{nome:i.name+" "+i.surName,email:i.email}}});case 32:return this.props.loading(!1),e.next=35,q("sucess","Diretrizes Metropolitanas solicitadas.");case 35:return e.next=37,me(n.email,r.emailRt,n.nome,s,o,l,"Diretrizes Metropolitanas solicitadas.");case 37:return e.next=39,this.clearSearch();case 39:return e.next=41,this.closeDetails();case 41:return e.next=43,this.setState({form:null});case 43:this.props.loadProcessData()&&this.props.loadFilesData(),e.next=50;break;case 46:e.prev=46,e.t1=e.catch(27),Y(e.t1),console.log(e.t1);case 50:e.next=53;break;case 52:alert("Favor anexar todos os arquivos solicitados.");case 53:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23],[27,46]])}));return function(t){return e.apply(this,arguments)}}()},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:""})}},{key:"render",value:function(){var e=this,t=this.state.dataMatch,a=this.props.redux.processCollection.filter(function(e){return"Processo cadastrado"===e.status}),n=this.state.searchValue.toLowerCase();return t=a&&n&&!this.state.checked?a.filter(function(e){return e.nomeEmpreendimento.toLowerCase().match(n)}):a&&(this.state.checked||this.state.checked&&n)?a.filter(function(t){return t._id.toLowerCase().match(e.state.selectedId)}):a,r.a.createElement("div",null,r.a.createElement(lt,{data:this.state,redux:this.props.redux,search:this.handleSearch.bind(this),searchArray:t,selectProcess:this.handleSelect.bind(this),submitFiles:this.handleSubmit.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this)},Te.map(function(t,a){return r.a.createElement(mt,{object:t,key:a,upload:e.fileUpload.bind(e)})})),r.a.createElement(Ge,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.redux.empCollection,rtCollection:this.props.redux.rtCollection}))}}]),t}(n.Component);var pt=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadEmpData:F,loadRtData:T,loadProcessData:z,loadFilesData:M,loadTecnicos:L,loading:U,setColor:B},e)})(ut),ht=a(39),ft=a(38),vt=a.n(ft),bt=(a(217),a(113)),Et=a.n(bt),gt=a(114),yt=a.n(gt);function xt(e,t,a){return function(){var n=Object(W.a)(H.a.mark(function n(r){return H.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,S.a.put("/api/editProcess/",{item:Object(ce.a)({_id:t},a,e)}).then(r(z()));case 3:n.next=9;break;case 5:n.prev=5,n.t0=n.catch(0),console.log(n.t0),r(Y(!1));case 9:case"end":return n.stop()}},n,null,[[0,5]])}));return function(e){return n.apply(this,arguments)}}()}var kt=function(e){var t,a=e.setColor,n=e.search,i=e.searchArray,s=e.selectProcess,o=e.submitFiles,l=e.data,c=e.redux,d=e.children,m=e.empDetails,u=e.rtDetails,p=e.showFiles;return l.selectedId&&(t=c.processCollection.filter(function(e){return e._id.match(l.selectedId)})),r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement(xe,{title:"Diretrizes Metropolitanas",subtitle:'Para a emiss\xe3o de diretrizes metropolitanas, selecione o processo, \r verifique os requisitos, fa\xe7a o upload da diretriz em pdf e clique em "Emitir Diretrizes".',color:a}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("label",null,"Filtrar"),r.a.createElement("input",{className:"input",type:"text",name:"search",onChange:n})),r.a.createElement("div",{className:"col s1 right",style:{paddingTop:"35px"}},r.a.createElement("i",{className:"material-icons"},"search"))),r.a.createElement("div",{className:"z-depth-3",style:{width:"100%",padding:"0px 10px 1px",borderRadius:"10px"}},r.a.createElement(ot,{search:i,collection:c.empCollection,rtCollection:c.rtCollection,processCollection:c.processCollection,onSelect:s,checked:l.checked,color:a,fields:["_id","nProcess","nomeEmpreendimento","munEmpreendimento","tecnico","cgt","vistoria"],renderEmp:!0,renderRt:!0,empDetails:m,rtDetails:u,showFiles:p})),r.a.createElement("div",{className:"row",style:{marginTop:"15px"}},r.a.createElement("div",{className:"col s1 right"},r.a.createElement(he,{disabled:null===l.checked,icon:"clear",onClick:e.clear,showFiles:p}))),r.a.createElement("div",null,l.selectedId&&l.checked?r.a.createElement("div",null,r.a.createElement("fieldset",null,r.a.createElement("legend",null,t[0].nomeEmpreendimento," - Diretrizes Metropolitanas"),d)):null,l.anexaDiretriz?r.a.createElement("button",{className:"btn teal darken-3 right",type:"submit",onClick:o},"Emitir Diretrizes Metropolitanas"):null))},Ct=function(e){var t=e.processCollection,a=e.selectedId,n=e.checkItem,i=e.change,s=e.dirStatus,o=e.anexaDiretriz,l=e.enviaPendencias,c=e.showCalendar,d=t.filter(function(e){return e._id.match(a)})[0];return r.a.createElement("div",{className:"row col s12 fieldsetChild"},r.a.createElement("form",{action:"#"},[["CGT","cgt","cgtOk"],["Vistoria","vistoria","vistoriaOk"],["Diretriz Municipal","dirMunOk","dirMunOk"],["Pagamento da DAE","daeOk","daeOk"]].map(function(e,t){return r.a.createElement("div",{className:"row",key:t},r.a.createElement("input",{type:"checkbox",id:e[2],onClick:n}),r.a.createElement("label",{htmlFor:e[2],style:{color:"black",fontWeight:500}},e[0]),function(e){return"cgt"===e[1]||"vistoria"===e[1]?d[e[1]]===e[0]+" n\xe3o agendada"?r.a.createElement("span",null,r.a.createElement("strong",null,": "),r.a.createElement("span",{id:e[1],onClick:c,style:{textDecoration:"underline",cursor:"pointer",color:"blue"}},"Agendar ","".concat(e[0]))):r.a.createElement("span",null,r.a.createElement("strong",null,": "),r.a.createElement("span",null,Ze(d[e[1]]),r.a.createElement("span",{style:{cursor:"pointer"}}," ",r.a.createElement("i",{id:e[1],onClick:c,title:"Reagendar ".concat(e[0]),className:"material-icons"},"calendar_today"),"  "))):d[e[1]]}(e))}),!1===o?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"},r.a.createElement("label",{htmlFor:"pendText"},"Registrar pend\xeancias"),r.a.createElement("textarea",{className:"materialize-textarea",id:"pendText",onChange:i,value:s.pendencias}),r.a.createElement("button",{className:"btn red right",onClick:l},"Enviar Pend\xeancias"))):r.a.createElement("div",null,r.a.createElement("label",{style:{fontSize:"1.3rem",paddingTop:"3%",fontFamily:"Calibri",fontWeight:600,color:"black"}},"Anexar Diretriz Metropolitana"),r.a.createElement("div",{className:"row file-field input-field"},r.a.createElement("div",{className:"file-path-wrapper row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("input",{className:"file-path validate",type:"text",placeholder:"Carregar arquivo"})),r.a.createElement("div",{className:"col s1 right"},r.a.createElement("i",{className:"material-icons grey-text text-darken-1 small"},"attach_file"),r.a.createElement("input",{type:"file",name:"diretrizFile",onChange:e.upload})))))))},wt=function(e){var t,a=e.showFiles,n=e.close,i=e.processCollection,s=e.selectedId,o=e.filesCollection,l=i.filter(function(e){return e._id.match(s)});return o&&o[0]&&(t=o.filter(function(e){return e.metadata.processId.match(s)})),a&&l&&l[0]&&t&&t[0]?r.a.createElement("div",{className:"container z-depth-3",style:{position:"fixed",top:"8%",right:"15%",left:"15%",height:"85%",borderRadius:"15px",backgroundColor:"#fbfbfb",padding:"15px 0px 0px 30px",border:"1px solid #ddd",marginBottom:"25px",marginTop:"25px",overflowY:"auto",overflowX:"hidden",zIndex:1}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"row"},r.a.createElement("h5",null,r.a.createElement("img",{alt:"",src:"/images/folderIcon2.jpg",style:{paddingLeft:"20px",marginRight:"20px"}}),"Arquivos > ",l[0].nomeEmpreendimento)),r.a.createElement("hr",{style:{marginBottom:"5px"}}),r.a.createElement("div",{className:"row",style:{marginBottom:0}},r.a.createElement("div",{className:"col s6"},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/multipleFiles2.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Arquivo"))),r.a.createElement("div",{className:"col s3"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Data de Upload")),r.a.createElement("div",{className:"col s3"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Tamanho"))),r.a.createElement("hr",{style:{margin:"0 0 20px 0"}}),t.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6"},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/genericFile.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("span",{id:e._id,style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:function(t){return tt(t,e.filename?e.filename:e.metadata.originalName)}},He(e.metadata.fieldName)))),r.a.createElement("div",{className:"col s3"},Ze(e.uploadDate)),r.a.createElement("div",{className:"col s3"},$e(e.length))))})),r.a.createElement("div",{style:{position:"absolute",top:"0.5%",right:"0.5%"}},r.a.createElement(Ee,{close:n}))):a&&l&&l[0]&&t&&!t[0]?r.a.createElement("div",{className:"card",style:{position:"fixed",top:"30%",right:"33%",left:"33%",backgroundColor:"white",paddingLeft:"20px",borderRadius:"15px",padding:"15px 0px 0px 30px",border:"1px solid #ddd",marginBottom:"25px",marginTop:"25px"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"row"},r.a.createElement("h5",null,"Arquivos > ",l[0].nomeEmpreendimento)),r.a.createElement("div",{className:"col s6"},"Nenhum arquivo encontrado")),r.a.createElement("div",{style:{position:"absolute",top:"0%",right:"0%"}},r.a.createElement(Ee,{close:n}))):null},Dt=function(e){function t(){var e;return Object(J.a)(this,t),(e=Object(K.a)(this,Object(Q.a)(t).call(this))).state={searchValue:"",dataMatch:[],selectedId:"",checked:null,files:[],form:null,diretrizFile:"",showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:"",showFiles:!1,filesCollection:"",daeDir:"",anexaDiretriz:!1,m:vt()(),cgtCalendar:!1,vistoriaCalendar:!1,dirStatus:{label:"Pend\xeancias na emiss\xe3o de Diretrizes",createdAt:"",cgtOk:!1,vistoriaOk:!1,daeOk:!1,dirMunOk:!1,pendencias:""}},e.setDate=function(t){e.state.cgtCalendar?e.setState({m:t._d,cgt:t._d}):e.setState({m:t._d,vistoria:t._d})},e.renderInput=function(e,t,a){return e.style={marginBottom:"0px",backgroundColor:"#F8F8FF",fontWeight:500},e.className="center-align",r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons right",style:{cursor:"pointer",color:"red"},onClick:a},"close"),r.a.createElement("i",{className:"material-icons",style:{cursor:"pointer",color:"gold"},onClick:function(){e.onChange({target:{value:""}})}},"backspace"),r.a.createElement("input",Object.assign({className:"red"},e)))},e.escFunction=e.escFunction.bind(Object(ht.a)(Object(ht.a)(e))),e}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"escFunction",value:function(e){var t=this.state,a=t.cgtCalendar,n=t.vistoriaCalendar,r=t.selectedId,i=t.showEmpDetails,s=t.showRtDetails,o=t.showFiles;27===e.keyCode&&(i||s||o?this.closeDetails():a||n?this.hideCalendar():r&&this.clearSearch())}},{key:"componentDidMount",value:function(){var e=this.props.redux,t=e.empCollection,a=e.rtCollection,n=e.processCollection,r=e.tecCollection;t[0]||this.props.loadEmpData(),n[0]||this.props.loadProcessData(),a[0]||this.props.loadRtData(),r[0]||this.props.loadTecnicos(),this.props.loadFilesData(),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleSearch",value:function(e){var t=this.state.dirStatus;t.cgtOk=!1,t.vistoriaOk=!1,t.dirMunOk=!1,t.daeOk=!1,this.setState(Object(h.a)({},this.state,{searchValue:e.target.value,checked:!1,anexaDiretriz:!1,dirStatus:t})),document.getElementsByName("group1").forEach(function(e){return e.checked=!1})}},{key:"clearSearch",value:function(e){var t=this.state.dirStatus;t.cgtOk=!1,t.vistoriaOk=!1,t.dirMunOk=!1,t.daeOk=!1,this.setState(Object(h.a)({},this.state,{searchValue:"",checked:null,dirStatus:t,anexaDiretriz:!1})),document.getElementsByName("search")[0].value="",document.getElementsByName("group1").forEach(function(e){e.checked=!1})}},{key:"handleSelect",value:function(){var e=Object(W.a)(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState(Object(h.a)({},this.state,{selectedId:t.target.value.replace(/,/g,""),checked:t.currentTarget.id}));case 2:document.getElementById(this.state.checked).checked="checked";case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fileUpload",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target,n=a.name,(r=a.files)[0].size>4194304&&(document.getElementsByName(n)[0].value="",alert("Arquivo excedeu o limite permitido (4MB)!")),(i=new FormData).append("processId",this.state.selectedId),e.next=6,this.setState(Object(h.a)({},this.state,Object(ce.a)({},n,r[0])));case 6:return e.next=8,i.append("diretrizFile",this.state.diretrizFile);case 8:this.setState({form:i});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c,d,m,u=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a="Diretrizes Metropolitanas emitidas",n=this.props.redux.processCollection.filter(function(e){return e._id.match(u.state.selectedId)})[0],r=this.props.redux.empCollection.filter(function(e){return e._id.match(n.empId)})[0],i=this.props.redux.rtCollection.filter(function(e){return e._id.match(n.rtId)})[0],s=Object(h.a)({},localStorage),o=n.modalidade,l=n.nomeEmpreendimento,c=n.munEmpreendimento,d=this.state.form,m=[],!d){e.next=34;break}return this.props.loading(!0),e.prev=10,e.next=13,S.a.post("/api/fileUpload",this.state.form).then(function(e){e.data.file.forEach(function(e){return m.push(e)})});case 13:return e.next=15,S.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:a,tecnico:s.name+" "+s.surName},processHistory:{label:a,createdAt:new Date,files:m,user:{nome:s.name+" "+s.surName,email:s.email}}});case 15:return this.props.loading(!1),e.next=18,q("sucess",a);case 18:return e.next=20,me(r.email,i.emailRt,r.nome,o,l,c,a+".");case 20:return e.next=22,this.clearSearch();case 22:return e.next=24,this.closeDetails();case 24:return e.next=26,this.setState({form:null});case 26:this.props.loadProcessData()&&this.props.loadFilesData(),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(10),Y(e.t0);case 32:e.next=35;break;case 34:alert("Favor inserir a diretriz metropolitana.");case 35:case"end":return e.stop()}},e,this,[[10,29]])}));return function(t){return e.apply(this,arguments)}}()},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({showEmpDetails:!1,showRtDetails:!1,showFiles:!1,empId:"",rtId:""})}},{key:"showFiles",value:function(e){this.setState({showFiles:!0,selectedId:e.target.id.replace(/z/g,"")})}},{key:"checkItem",value:function(e){var t=e.target.id,a=this.state.dirStatus;a[t]=!this.state.dirStatus[t];var n=a.cgtOk,r=a.vistoriaOk,i=a.daeOk,s=a.dirMunOk;!0===n&&!0===r&&!0===s&&!0===i?this.setState({anexaDiretriz:!0}):this.setState({anexaDiretriz:!1})}},{key:"handleChange",value:function(e){var t=e.target.value,a=this.state.dirStatus;a.pendencias=t,this.setState({dirStatus:a})}},{key:"enviaPendencias",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c,d,m=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.props.redux.processCollection.filter(function(e){return e._id.match(m.state.selectedId)})[0],n=this.props.redux.empCollection.filter(function(e){return e._id.match(a.empId)})[0],r=this.props.redux.rtCollection.filter(function(e){return e._id.match(a.rtId)})[0],i=a.modalidade,s=a.nomeEmpreendimento,o=a.munEmpreendimento,l=Object(h.a)({},localStorage),c="Pend\xeancias para emiss\xe3o de Diretrizes Metropolitanas.",d=this.state.dirStatus,this.props.loading(!0),e.prev=9,e.next=12,S.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:"Processo cadastrado",tecnico:l.name+" "+l.surName},processHistory:{label:"Pend\xeancias para emiss\xe3o de diretrizes",createdAt:new Date,pendencias:d.pendencias,dirCheckList:{cgtOk:d.cgtOk,vistoriaOk:d.vistoriaOk,daeOk:d.daeOk,dirMunOk:d.dirMunOk},user:{nome:l.name+" "+l.surName,email:l.email}}});case 12:return e.next=14,this.props.loading(!1);case 14:return e.next=16,q("sucess",c);case 16:return e.next=18,me(n.email,r.emailRt,n.nome,i,s,o,c);case 18:return e.next=20,this.clearSearch();case 20:return e.next=22,this.closeDetails();case 22:this.props.loadProcessData(),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(9),Y(e.t0);case 28:case"end":return e.stop()}},e,this,[[9,25]])}));return function(t){return e.apply(this,arguments)}}()},{key:"showCalendar",value:function(e){this.setState(Object(h.a)({},this.state,Object(ce.a)({},"".concat(e.target.id,"Calendar"),!0)))}},{key:"hideCalendar",value:function(e){var t;t=this.state.cgtCalendar?"cgt":"vistoria",this.setState(Object(h.a)({},this.state,Object(ce.a)({},"".concat(t,"Calendar"),!1))),this.props.setDate(this.state.m,this.state.selectedId,t)}},{key:"render",value:function(){var e=this,t=this.state.dataMatch,a=this.state.searchValue.toLowerCase(),n=this.props.redux.processCollection.filter(function(e){return"Aguardando Diretrizes Metropolitanas"===e.status});return t=a&&!this.state.checked?n.filter(function(e){return e.nomeEmpreendimento.toLowerCase().match(a)}):this.state.checked||this.state.checked&&a?n.filter(function(t){return t._id.toLowerCase().match(e.state.selectedId)}):n,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(kt,{data:this.state,redux:this.props.redux,search:function(t){return e.handleSearch(t)},searchArray:t,selectProcess:this.handleSelect.bind(this),submitFiles:this.handleSubmit.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),showFiles:this.showFiles.bind(this)},r.a.createElement(Ct,{selectedId:this.state.selectedId,showFiles:this.state.showFiles,checkItem:this.checkItem.bind(this),close:this.closeDetails.bind(this),processCollection:this.props.redux.processCollection,filesCollection:this.props.redux.filesCollection,upload:this.fileUpload.bind(this),dirStatus:this.state.dirStatus,change:this.handleChange.bind(this),enviaPendencias:this.enviaPendencias.bind(this),anexaDiretriz:this.state.anexaDiretriz,showCalendar:this.showCalendar.bind(this),cgtCalendar:this.state.cgtCalendar,vistoriaCalendar:this.state.vistoriaCalendar})),this.state.cgtCalendar||this.state.vistoriaCalendar?r.a.createElement("div",{style:{position:"fixed",top:"20%",right:"43%",width:"253px",border:"2px solid #ddd",backgroundColor:"white"}},r.a.createElement(Et.a,{renderInput:this.renderInput,className:yt.a,input:!0,open:!0,inputProps:{readOnly:!0},value:this.state.m,onChange:this.setDate.bind(this),onBlur:this.hideCalendar.bind(this)})):void 0,r.a.createElement(Ge,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.redux.empCollection,rtCollection:this.props.redux.rtCollection})),r.a.createElement("div",null,r.a.createElement(wt,{selectedId:this.state.selectedId,showFiles:this.state.showFiles,close:this.closeDetails.bind(this),processCollection:this.props.redux.processCollection,filesCollection:this.props.redux.filesCollection})))}}]),t}(n.Component);var Nt=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadEmpData:F,loadRtData:T,loadProcessData:z,loadTecnicos:L,loadFilesData:M,loading:U,setColor:B,setDate:xt},e)})(Dt),It=function(e){var t,a=e.setColor,n=e.search,i=e.searchArray,s=e.selectProcess,o=e.submitFiles,l=e.data,c=e.redux,d=e.children,m=e.empDetails,u=e.rtDetails,p=e.showFiles;return l.selectedId&&(t=c.processCollection.filter(function(e){return e._id.match(l.selectedId)})),r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement(xe,{title:"Solicitar Anu\xeancia Pr\xe9via",subtitle:'Para solicitar anu\xeancia pr\xe9via, selecione o processo, fa\xe7a o upload dos documentos \r e projetos e clique em "Solicitar Anu\xeancia".',color:a}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("label",null,"Filtrar"),r.a.createElement("input",{className:"input",type:"text",name:"search",onChange:n})),r.a.createElement("div",{className:"col s1 right",style:{paddingTop:"35px"}},r.a.createElement("i",{className:"material-icons"},"search"))),r.a.createElement("div",{className:"z-depth-3",style:{padding:"0px 10px 1px",borderRadius:"10px"}},r.a.createElement(ot,{search:i,collection:c.empCollection,rtCollection:c.rtCollection,onSelect:s,checked:l.checked,color:a,fields:["_id","nProcess","nomeEmpreendimento","modalidade","munEmpreendimento","status","tecnico"],renderEmp:!0,renderRt:!0,empDetails:m,rtDetails:u,showFiles:p})),r.a.createElement("div",{className:"row",style:{marginTop:"15px"}},r.a.createElement("div",{className:"col s1 right"},r.a.createElement(he,{disabled:null===l.checked,icon:"clear",onClick:e.clear}))),r.a.createElement("div",null,l.selectedId&&l.checked?r.a.createElement("div",null,r.a.createElement("fieldset",null,r.a.createElement("legend",{style:{fontSize:"1.3rem"}},t[0].nomeEmpreendimento," - Documentos para solicita\xe7\xe3o de anu\xeancia pr\xe9via"),r.a.createElement("div",{className:"row"},d[0])),r.a.createElement("fieldset",null,r.a.createElement("legend",{style:{fontSize:"1.3rem"}},t[0].nomeEmpreendimento," - Projetos para solicita\xe7\xe3o de anu\xeancia pr\xe9via"),r.a.createElement("div",{className:"row"},d[1])),r.a.createElement("button",{className:"btn teal darken-3 right",style:{marginBottom:"20px"},onClick:o},"Solicitar Anu\xeancia")):null))},Ot=function(e){var t=e.object,a=t.label,n=t.nameInput,i=t.tooltip,s=t.tt,o=t.link;return r.a.createElement("div",{style:{padding:"10px",paddingLeft:"20px",paddingRight:"20px",margin:0}},r.a.createElement("label",{style:{fontSize:"16px",paddingTop:"15px",fontWeight:450,color:"black"}},a),s&&r.a.createElement("i",{style:{marginLeft:"9px",color:"#42a5f5",fontSize:"1.2rem",cursor:o?"pointer":"default"},className:"material-icons",onClick:function(){return function(e){e&&window.open("http://www.agenciarmbh.mg.gov.br/anuencia-previa-2/#1544200696367-a39f6fa0-7d0c","_blank")}(o)},"data-tip":i}," help_outline "),r.a.createElement(dt.a,null),r.a.createElement("div",{className:"file-field input-field",key:n},r.a.createElement("div",{className:"file-path-wrapper"},r.a.createElement("div",{className:"col s11"},r.a.createElement("input",{className:"file-path validate",type:"text",placeholder:"Carregar arquivo"})),r.a.createElement("div",{className:"col s1 right"},r.a.createElement("i",{className:"material-icons grey-text text-darken-1 small"},"attach_file"),r.a.createElement("input",{type:"file",name:n,onChange:e.upload})))))},jt=function(e){function t(){var e;return Object(J.a)(this,t),(e=Object(K.a)(this,Object(Q.a)(t).call(this))).state={searchValue:"",dataMatch:[],selectedId:"",checked:null,files:[],form:null,showEmpDetails:!1,showRtDetails:!1,showFiles:!1,empId:"",rtId:"",regImovel:"",CNDMun:"",empRG:"",art:"",decConform:"",daeAnuencia:"",memDescritivo:"",memDescTp:"",cemig:"",dtbCopasa:"",licAmbental:"",levPlan:"",projUrb:"",mapaIso:"",projTer:"",projDren:"",projDesmemb:""},e.escFunction=function(t){var a=e.state,n=a.selectedId,r=a.showEmpDetails,i=a.showRtDetails,s=a.showFiles;27===t.keyCode&&(r||i||s?e.closeDetails():n&&e.clearSearch())},e}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){this.props.redux.empCollection[0]||this.props.loadEmpData(),this.props.redux.processCollection[0]||this.props.loadProcessData(),this.props.redux.rtCollection[0]||this.props.loadRtData(),this.props.redux.filesCollection[0]||this.props.loadFilesData(),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleSearch",value:function(e){this.setState(Object(h.a)({},this.state,{searchValue:e.target.value,checked:!1})),document.getElementsByName("group1").forEach(function(e){return e.checked=!1})}},{key:"clearSearch",value:function(e){this.setState(Object(h.a)({},this.state,{searchValue:"",checked:null})),document.getElementsByName("search")[0].value="",document.getElementsByName("group1").forEach(function(e){e.checked=!1})}},{key:"handleSelect",value:function(){var e=Object(W.a)(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState(Object(h.a)({},this.state,{selectedId:t.target.value.replace(/,/g,""),checked:t.currentTarget.id}));case 2:document.getElementById(this.state.checked).checked="checked";case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fileUpload",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c,d,m,u=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=["levPlan","mapaIso","outros","projPdf"],n=["projTer","projDren"],r=t.target,i=r.name,s=r.files,o=a.some(function(e){return e===i}),l=n.some(function(e){return e===i}),o&&s[0]&&s[0].size>6291456&&(document.getElementsByName(i)[0].value="",alert("Arquivo excedeu o limite permitido (6MB)!")),l&&s[0]&&s[0].size>10485760?(document.getElementsByName(i)[0].value="",alert("Arquivo excedeu o limite permitido (10MB)!")):!o&&!l&&s[0]&&s[0].size>2097152&&(document.getElementsByName(i)[0].value="",alert("Arquivo excedeu o limite permitido (2MB)!")),(c=new FormData).append("processId",this.state.selectedId),this.setState(Object(h.a)({},this.state,Object(ce.a)({},t.target.name,t.target.files[0]))),d=[],(m=Le.concat(Be)).push({nameInput:"projDesmemb",label:"Projeto de Desmembramento",tooltip:"Planta de localiza\xe7\xe3o com delimita\xe7\xe3o da \xe1rea em an\xe1lise e indica\xe7\xe3o do per\xedmetro urbano, em escala de 1:10000"}),e.next=15,m.map(function(e){return d.push(e.nameInput)});case 15:return e.next=17,d.forEach(function(e){for(var t in u.state)t.match(e)&&c.append(e,u.state[t])});case 17:this.setState({form:c});case 18:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c,d,m,u,p,f,v,b,E,g,y,x,k,C,w,D=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.props.redux.processCollection,n=this.props.redux.processCollection.filter(function(e){return e._id.match(D.state.selectedId)})[0],r=this.props.redux.empCollection.filter(function(e){return e._id.match(n.empId)})[0],i=this.props.redux.rtCollection.filter(function(e){return e._id.match(n.rtId)})[0],s=Object(h.a)({},localStorage),o=this.state,l=o.selectedId,c=o.form,d=n.modalidade,m=n.nomeEmpreendimento,u=n.munEmpreendimento,p=function(){var e=[];a.length>0&&(e=a.filter(function(e){return e._id.match(l)})[0].processHistory.filter(function(e){return e.label}));var t=e.filter(function(e){return e.label.match("An\xe1lise")}).length;if(0===t){return"Anu\xeancia pr\xe9via solicitada"}return"Entrada "+(t+1)},f=[],v=[],b=0,!c){e.next=25;break}for(E=!0,g=!1,y=void 0,e.prev=9,x=c.entries()[Symbol.iterator]();!(E=(k=x.next()).done);E=!0)(C=k.value)[1]&&"undefined"!==C[1]&&(b+=1);e.next=17;break;case 13:e.prev=13,e.t0=e.catch(9),g=!0,y=e.t0;case 17:e.prev=17,e.prev=18,E||null==x.return||x.return();case 20:if(e.prev=20,!g){e.next=23;break}throw y;case 23:return e.finish(20);case 24:return e.finish(17);case 25:if(v=n.processHistory.filter(function(e){return"An\xe1lise 1"===e.label}),!(b>8&&"Desmembramento"===n.modalidade||b>17&&"Loteamento"===n.modalidade||v.length>0)){e.next=57;break}return this.props.loading(!0),e.prev=28,e.next=31,S.a.post("/api/fileUpload",this.state.form).then(function(e){e.data.file.forEach(function(e){return f.push(e)})});case 31:return w=p(),e.next=34,S.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:"Aguardando An\xe1lise"},processHistory:{label:w,createdAt:new Date,files:f,user:{nome:s.name+" "+s.surName,email:s.email}}});case 34:return this.props.loading(!1),q("sucess","Anu\xeancia Pr\xe9via solicitada."),e.next=38,me(r.email,i.emailRt,r.nome,d,m,u,"Anu\xeancia Pr\xe9via solicitada.");case 38:return e.next=40,this.clearSearch();case 40:return e.next=42,this.closeDetails();case 42:return e.next=44,this.setState({form:null});case 44:return e.next=46,this.props.loadProcessData();case 46:if(e.t1=e.sent,!e.t1){e.next=49;break}this.props.loadFilesData();case 49:console.log(""),e.next=55;break;case 52:e.prev=52,e.t2=e.catch(28),Y(e.t2);case 55:e.next=58;break;case 57:alert("Favor anexar todos os arquivos solicitados.");case 58:case"end":return e.stop()}},e,this,[[9,13,17,25],[18,,20,24],[28,52]])}));return function(t){return e.apply(this,arguments)}}()},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({showEmpDetails:!1,showRtDetails:!1,showFiles:!1,empId:"",rtId:""})}},{key:"showFiles",value:function(e){this.setState({showFiles:!0,selectedId:e.target.id.replace(/z/g,"")})}},{key:"render",value:function(){var e,t,a=this,n=this.state,i=n.dataMatch,s=n.selectedId,o=n.checked,l=this.props.redux.processCollection,c=this.state.searchValue.toLowerCase(),d=l.filter(function(e){return"Diretrizes Metropolitanas emitidas"===e.status||e.status.match("Pend\xeancias")||"Aguardando documenta\xe7\xe3o"===e.status});i=c&&!o?d.filter(function(e){return e.nomeEmpreendimento.toLowerCase().match(c)}):o||o&&c?d.filter(function(e){return e._id.toLowerCase().match(s)}):d;var m=[],u=[];return s&&(t=(e=l.filter(function(e){return e._id.match(s)}))[0].status),!e||"Loteamento"!==e[0].modalidade||"Diretrizes Metropolitanas emitidas"!==t&&"Pend\xeancias"!==t?!e||"Desmembramento"!==e[0].modalidade||"Aguardando documenta\xe7\xe3o"!==t&&"Pend\xeancias"!==t||(m=qe,u=Ue):(m=Le,u=Be),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(It,{data:this.state,redux:this.props.redux,search:function(e){return a.handleSearch(e)},searchArray:i,selectProcess:this.handleSelect.bind(this),submitFiles:this.handleSubmit.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),array:Le,array2:Be,showFiles:this.showFiles.bind(this)},m.map(function(e,t){return r.a.createElement("div",{className:"col s6",key:t},r.a.createElement(Ot,{object:e,key:t,upload:a.fileUpload.bind(a)}))}),r.a.createElement("div",{className:"row"},u.map(function(e,t){return r.a.createElement("div",{className:"col s6",key:t},r.a.createElement(Ot,{object:e,key:t,upload:a.fileUpload.bind(a)}))}))),r.a.createElement(wt,{selectedId:s,showFiles:this.state.showFiles,close:this.closeDetails.bind(this),processCollection:l,filesCollection:this.props.redux.filesCollection}),r.a.createElement(Ge,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.redux.empCollection,rtCollection:this.props.redux.rtCollection})))}}]),t}(n.Component);var St=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadEmpData:F,loadRtData:T,loadProcessData:z,loadFilesData:M,setColor:B,loading:U},e)})(jt),Pt=function(e){var t=e.setColor,a=e.search,n=e.searchArray,i=e.selectProcess,s=e.data,o=e.redux,l=e.empDetails,c=e.rtDetails,d=e.showFiles;return s.selectedId&&o.processCollection.filter(function(e){return e._id.match(s.selectedId)})[0],r.a.createElement("div",{className:"container",style:{width:"95%"}},r.a.createElement(xe,{title:"Analisar Processo",subtitle:"Selecione o processo para analisar, registrar pend\xeancias ou emitir anu\xeancia pr\xe9via.",color:t}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("label",null,"Filtrar"),r.a.createElement("input",{className:"input",type:"text",name:"search",onChange:a,value:s.searchValue})),r.a.createElement("div",{className:"col s1 right",style:{paddingTop:"35px"}},r.a.createElement("i",{className:"material-icons"},"search"))),r.a.createElement("div",{className:"z-depth-3",style:{width:"100%",padding:"0px 10px 1px",borderRadius:"10px"}},r.a.createElement(ot,{search:n,collection:o.empCollection,rtCollection:o.rtCollection,processCollection:o.processCollection,onSelect:i,checked:s.checked,color:t,fields:["_id","nProcess","nomeEmpreendimento","modalidade","munEmpreendimento","status","tecnico"],renderEmp:!0,renderRt:!0,empDetails:l,rtDetails:c,showFiles:d})),r.a.createElement("div",{className:"row",style:{marginTop:"15px"}},s.selectedId?null:r.a.createElement("div",{className:"col s1 right"},r.a.createElement(he,{disabled:null===s.checked,icon:"clear",onClick:e.clear}))))},At=[{name:"FileExplorer",img:"/images/gerenciarProc3.png",label:"Ver arquivos",divStyle:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:""}},{name:"Pendencias",img:"/images/pendencias.png",label:"Registrar Pend\xeancias",divStyle:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:"1px solid #a88"}},{name:"Anuencia",img:"/images/emitir_anuencia3.png",label:"Emitir Anu\xeancia",divStyle:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:""}},{name:"ProcessInfo",img:"/images/process_info3.png",label:"Informa\xe7\xf5es do Processo",divStyle:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:""}}],Rt=function(e){var t=e.process.processHistory.filter(function(e){return e.files});return r.a.createElement("div",{style:{height:"100%",overflowY:"auto",overflowX:"hidden"}},t.map(function(e,t){return r.a.createElement("div",{style:{border:"1px solid #ddd",padding:"1% 0 0 1%"},key:t+1e3},r.a.createElement("div",{className:"row",align:"center"},r.a.createElement("span",{style:{fontSize:"1rem",fontWeight:500}},e.label," em ",Ze(e.createdAt))),r.a.createElement("div",{className:"row",style:{fontSize:"0.9rem",padding:"0.8% 0",backgroundColor:"#f7f7f7",fontWeight:500,borderBottom:"1px solid #ddd",borderTop:"1px solid #ddd"}},r.a.createElement("div",{className:"col s5 left"},"Documento"),r.a.createElement("div",{className:"col s4 left"},"Nome do arquivo"),r.a.createElement("div",{className:"col s3 center"},"Tamanho")),r.a.createElement("div",{className:"row"},e.files.map(function(e,t){return r.a.createElement("div",{className:"row",key:t+100,style:{paddingLeft:"1%"}},r.a.createElement("div",{className:"col s5"},He(e.fieldName)),r.a.createElement("div",{className:"col s4"},r.a.createElement("span",{id:e.id,key:t,style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:function(t){return tt(t,e.originalName)}},e.originalName)),r.a.createElement("div",{className:"col s3 center"},$e(e.fileSize)))})))}))},_t=function(e){var t=e.upload,a=e.submitFiles;return r.a.createElement("div",{style:{paddingLeft:"10%",marginBottom:"8%"}},r.a.createElement("h5",null,"Emitir Anu\xeancia Pr\xe9via"),[{label:"Anexar Nota T\xe9cnica",inputName:"notaTecnica"},{label:"Anexar Certid\xe3o de Anu\xeancia Pr\xe9via",inputName:"anuenciaFile"}].map(function(e,a){return r.a.createElement("div",{style:{marginTop:"10%"},key:a},r.a.createElement("label",{style:{fontSize:"16px",paddingTop:"15px",fontWeight:450,color:"black"}},e.label),r.a.createElement("div",{className:"row file-field input-field",key:e.inputName},r.a.createElement("div",{className:"file-path-wrapper row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("input",{className:"file-path validate",type:"text",placeholder:"Carregar arquivo"})),r.a.createElement("div",{className:"col s1 right"},r.a.createElement("i",{className:"material-icons grey-text text-darken-1 small"},"attach_file"),r.a.createElement("input",{type:"file",name:e.inputName,onChange:t})))))}),r.a.createElement("button",{className:"btn teal darken-3 right",style:{marginRight:"2%"},type:"submit",onClick:a},"Emitir Anu\xeancia Pr\xe9via"))},Ft=a(115),Tt=a.n(Ft),zt=(a(323),function(e){var t=e.empreend,a=e.process;var n=e.prefeituras.filter(function(e){return e.municipio.toLowerCase().match(a.munEmpreendimento.toLowerCase())})[0],i={lineHeight:.8};return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("img",{className:"col s12",src:"/images/governo_header3.jpg",style:{paddingRight:"20px"},alt:""})),r.a.createElement("p",{className:"oficioHeader"},r.a.createElement("span",{className:"right"},"Belo Horizonte, ",function(){var e=new Date;return"".concat(e.getDate()," de ").concat(["janeiro","fevereiro","mar\xe7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"][e.getMonth()]," de ").concat(e.getFullYear())}(),".")),r.a.createElement("br",null),r.a.createElement("p",{className:"ql-align-justify",style:i}," ",n.vocativo1," "),r.a.createElement("p",{className:"ql-align-justify",style:i}," ",r.a.createElement("strong",null,n.nome)," "),r.a.createElement("p",{className:"ql-align-justify",style:i},n.cargo),r.a.createElement("p",{className:"ql-align-justify",style:i},"Prefeitura de ",a.munEmpreendimento),r.a.createElement("p",{className:"ql-align-justify",style:i},n.endereco),r.a.createElement("p",{className:"ql-align-justify",style:i},"CEP: ",n.cep," \u2013 ",a.munEmpreendimento,", MG"),r.a.createElement("p",null),r.a.createElement("p",{className:"ql-align-justify"},r.a.createElement("strong",null,"Assunto:"),' Empreendimento "',a.nomeEmpreendimento,'", Processo RMBH n\xba ',a.nProcess," "),r.a.createElement("p",null),r.a.createElement("p",{className:"ql-align-justify"},n.vocativo2,", "),r.a.createElement("p",{className:"ql-align-justify"},"Em resposta ao of\xedcio da Prefeitura Municipal de ",a.munEmpreendimento,", que solicita an\xe1lise e emiss\xe3o de Selo de Anu\xeancia Pr\xe9via para o ",a.modalidade," de uma \xe1rea de ",a.area,"m\xb2, situado no lugar denominado ",r.a.createElement("strong",null,a.nomeEmpreendimento),", de interesse de",r.a.createElement("strong",null," ",t.nome),", informamos que:"),r.a.createElement("p",null))}),Mt=function(e){var t=e.mostrarOficio,a=e.content,n=e.redux,i=e.process,s=e.empreend,o=e.rt,l=e.tecnicos,c=e.prefeituras,d=Object(h.a)({},localStorage),m=l.filter(function(e){return e.email.match(d.email)})[0],u=m?m.name:d.name,p=m?m.surName:d.surName,f=m?m.cau:"n\xe3o registrado";return t?r.a.createElement("div",{id:"oficio",className:"z-depth-3",style:{position:"relative",borderRadius:"15px",width:"100%",backgroundColor:"white",padding:"15px 0px 0px 30px",border:"1px solid #ddd",marginBottom:"25px"}},r.a.createElement(zt,{redux:n,process:i,empreend:s,rt:o,prefeituras:c}),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:a}}),r.a.createElement("center",null,r.a.createElement("strong",null,r.a.createElement("p",null,u," ",p)),r.a.createElement("p",null,"CAU/MG ",f))):null},Lt={toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]},Bt=function(e){function t(){var e,a;Object(J.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(K.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={color:"",text:"",mostrarOficio:!1,oficio:""},a}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){this.props.cadastro.empCollection[0]||this.props.loadEmpData(),this.props.cadastro.rtCollection[0]||this.props.loadRtData(),this.props.cadastro.processCollection[0]||this.props.loadProcessData();var e=document.getElementById("setcolor").style.backgroundColor;this.setState({setColor:e})}},{key:"handleChange",value:function(e){this.setState(Object(h.a)({},this.state,{text:e}))}},{key:"savePdf",value:function(){this.setState({mostrarOficio:!0})}},{key:"enviaPendencias",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c,d,m,u;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.props,n=a.process,r=a.empreend,i=a.rt,s=n.modalidade,o=n.nomeEmpreendimento,l=n.munEmpreendimento,c=Object(h.a)({},localStorage),d=this.props.process.processHistory.filter(function(e){return e.label.match("An\xe1lise")}),m="An\xe1lise ".concat(d.length+1),u=document.getElementById("oficio").outerHTML,this.props.loading(!0),this.setState({oficio:u}),e.prev=9,e.next=12,S.a.put("/api/editProcess",{item:{_id:this.props.process._id,status:"Pend\xeancias",tecnico:c.name+" "+c.surName},processHistory:{label:m,createdAt:new Date,pendencias:u,user:{nome:c.name+" "+c.surName,email:c.email}}});case 12:return this.props.loading(!1),e.next=15,q("sucess","Pend\xeancias para a emiss\xe3o de anu\xeancia.");case 15:return e.next=17,me(r.email,i.emailRt,r.nome,s,o,l,"Pend\xeancias para a emiss\xe3o de anu\xeancia.");case 17:return e.next=19,this.props.close();case 19:this.props.loadProcessData(),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(9),Y(e.t0);case 25:case"end":return e.stop()}},e,this,[[9,22]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props,a=t.empreend,n=t.rt,i=t.process,s=t.tecnicos,o=t.prefeituras,l=function(){return!e.state.mostrarOficio&&"disabled"};return r.a.createElement("div",{style:{height:"100%"}},r.a.createElement(Tt.a,{value:this.state.text,onChange:this.handleChange.bind(this),modules:Lt,theme:"snow",style:{background:"#fff",height:"50vh",marginBottom:"10px",border:"1px solid #ddd",borderRadius:"1%",overflow:"hidden"}}),r.a.createElement(Mt,{mostrarOficio:this.state.mostrarOficio,content:this.state.text,oficio:this.state.oficio,process:i,empreend:a,rt:n,tecnicos:s,prefeituras:o}),r.a.createElement("button",{className:"btn right",onClick:this.enviaPendencias.bind(this),disabled:l()}," Enviar "),r.a.createElement("button",{style:{marginRight:"10px"},className:"btn right",onClick:this.savePdf.bind(this),disabled:!l()}," Pr\xe9-visualizar "))}}]),t}(n.Component),qt=Object(l.connect)(function(e){return{cadastro:e.cadastro}},function(e){return Object(o.b)({loadEmpData:F,loadRtData:T,loadProcessData:z,loading:U,reduxToastr:q},e)})(Bt),Ut=function(e){var t=e.redux,a=e.clear,n=e.data,i=e.selectedOption,s=e.optionSelect,o=e.process,l=e.empreend,c=e.rt,d=e.divConfig,m=e.changeValue,u=e.showLog,p=e.clearLog,h=e.log,f=e.close,v=e.upload,b=e.submit,E=e.prefeituras;return r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement("div",null,r.a.createElement("div",{className:"row",align:"center",style:{border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#efefef",fontSize:"1.2rem",fontFamily:"calibri",marginTop:"15px"}},r.a.createElement("h4",null,o.nomeEmpreendimento),r.a.createElement("div",{className:"row col s12"},r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null,"Munic\xedpio:"),"  ",o.munEmpreendimento),r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null,"Modalidade:")," ",o.modalidade),r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null,"\xc1rea:")," ",o.area),r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null," Empreendedor: ")," ",l.nome),r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null,"RT: "),c.nomeRt),r.a.createElement("div",{className:"col s12 m6 l4"},o.status))),r.a.createElement("div",{className:"row",style:{marginBottom:0,cursor:"pointer"}},At.map(function(e,t){return r.a.createElement("div",{id:e.name,key:t,align:"center",className:"col s12 m6 l3 ".concat(d(e).class),style:d(e).stylez,onClick:s},r.a.createElement("img",{id:e.name,className:"center-align",src:e.img,style:{margin:"10px 10px 0px 10px",cursor:"pointer"},height:"40",alt:""}),r.a.createElement("h6",{id:e.name,style:{cursor:"pointer",fontWeight:550}},e.label))})),r.a.createElement("div",{style:{minHeight:"50vh",border:"1px solid #ddd",borderRadius:"2%",marginBottom:"2%"}},""===i?r.a.createElement("div",{className:"col push-s4",style:{paddingTop:"20%"}},r.a.createElement("h5",null,"Selecione uma das op\xe7oes acima.")):r.a.createElement("div",{className:"col s12",style:{height:"100%"}},function(e){switch(e){case"FileExplorer":return r.a.createElement(Rt,{selectedId:n.selectedId,showFiles:n.showFiles,close:f,processCollection:t.processCollection,filesCollection:t.filesCollection,process:o});case"Pendencias":return r.a.createElement(qt,{process:o,empreend:l,rt:c,tecnicos:t.tecCollection,value:n.analiseProc.pendencias,changeValue:m,close:f,prefeituras:E});case"Anuencia":return r.a.createElement(_t,{upload:v,submitFiles:b});case"ProcessInfo":return r.a.createElement(nt,{process:o,showLog:u,logDetails:h.logDetails,index:h.logIndex,clearLog:p});default:console.log("invalid option, dude!")}}(i))),h.logDetails&&"ProcessInfo"===i?null:r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s1 left"},r.a.createElement(he,{disabled:null===n.checked,icon:"arrow_back",onClick:a})," Voltar"))))},Vt=function(e){function t(){var e;return Object(J.a)(this,t),(e=Object(K.a)(this,Object(Q.a)(t).call(this))).state={selectedOption:"",selectedId:"",logDetails:!1,logIndex:"",notaTecnica:"",anuenciaFile:"",form:"",prefeituras:[]},e.escFunction=function(t){var a=e.state.logDetails;27===t.keyCode&&a&&e.clearLog()},e}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"optionSelect",value:function(e){this.setState({selectedOption:e.target.id})}},{key:"componentDidMount",value:function(){var e=this;this.setState({selectedId:this.props.data.selectedId}),S.a.get("/api/prefeituras").then(function(t){return e.setState({prefeituras:t.data})}).catch(function(e){return console.log(e)}),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){this.props.clear(),document.removeEventListener("keydown",this.escFunction,!1)}},{key:"divConfig",value:function(e){if(e.name!==this.state.selectedOption){return{stylez:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:"",borderTopLeftRadius:"15%",borderTopRightRadius:"15%"},class:"col s12 m6 l3 z-depth-2"}}return{stylez:{minHeight:"8vh",border:"2px solid #bbb",borderRadius:"2%",borderBottom:"",borderTopLeftRadius:"15%",borderTopRightRadius:"15%",backgroundColor:"#fcfcfc"},class:"col s12 m6 l3"}}},{key:"showLog",value:function(e){this.setState({logIndex:e.target.id,logDetails:!0})}},{key:"clearLog",value:function(){this.setState({logDetails:!1,logIndex:""})}},{key:"fileUpload",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=["notaTecnica","anuenciaFile"],(n=new FormData).append("processId",this.state.selectedId),e.next=5,this.setState(Object(h.a)({},this.state,Object(ce.a)({},t.target.name,t.target.files[0])));case 5:return e.next=7,a.forEach(function(e){for(var t in r.state)t.match(e)&&n.append(e,r.state[t])});case 7:this.setState({form:n});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c,d,m,u,p=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.props.redux.processCollection.filter(function(e){return e._id.match(p.props.data.selectedId)})[0],n=this.props.redux.empCollection.filter(function(e){return e._id.match(a.empId)})[0],r=this.props.redux.rtCollection.filter(function(e){return e._id.match(a.rtId)})[0],i=a.modalidade,s=a.nomeEmpreendimento,o=a.munEmpreendimento,l=Object(h.a)({},localStorage),c=l.name,d=l.surName,m=l.email,u=[],this.state.notaTecnica&&this.state.anuenciaFile){e.next=11;break}alert("Favor anexar a nota t\xe9cnica e a certid\xe3o de anu\xeancia"),e.next=27;break;case 11:return this.props.loading(!0),e.prev=12,e.next=15,S.a.post("/api/fileUpload",this.state.form).then(function(e){e.data.file.forEach(function(e){return u.push(e)})});case 15:return e.next=17,S.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:"Processo Anu\xeddo",tecnico:c+" "+d},processHistory:{label:"Processo Anu\xeddo",createdAt:new Date,files:u,user:{nome:c+" "+d,email:m}}});case 17:return e.next=19,q("sucess","Processo Anu\xeddo.");case 19:return e.next=21,me(n.email,r.emailRt,n.nome,i,s,o,"Processo Anu\xeddo.");case 21:setTimeout(function(){p.props.loading(!1),p.setState({form:null}),p.props.loadProcessData(),p.props.loadFilesData()},1250),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(12),Y(e.t0);case 27:case"end":return e.stop()}},e,this,[[12,24]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a,n=this.props,i=n.clear,s=n.data,o=n.redux,l=n.close,c=n.changeValue;if(s.selectedId&&(e=o.processCollection.filter(function(e){return e._id.match(s.selectedId)})[0])&&(t=o.empCollection.filter(function(t){return t._id.match(e.empId)})[0],a=o.rtCollection.filter(function(t){return t._id.match(e.rtId)})[0]),s.selectedId)return s.showFiles=!0,r.a.createElement("div",{className:"container"},r.a.createElement(Ut,{data:s,redux:o,clear:i,close:l,process:e,empreend:t,rt:a,prefeituras:this.state.prefeituras,match:this.props.match,optionSelect:this.optionSelect.bind(this),selectedOption:this.state.selectedOption,divConfig:this.divConfig.bind(this),changeValue:c,log:this.state,showLog:this.showLog.bind(this),clearLog:this.clearLog.bind(this),upload:this.fileUpload.bind(this),submit:this.handleSubmit.bind(this)}))}}]),t}(n.Component),Ht=Object(l.connect)(function(e){return{cadastro:e.cadastro}},function(e){return Object(o.b)({loadProcessData:z,loadFilesData:M,loading:U,reduxToastr:q},e)})(Vt),Wt=function(e){function t(){var e;return Object(J.a)(this,t),(e=Object(K.a)(this,Object(Q.a)(t).call(this))).state={searchValue:"",dataMatch:[],selectedId:"",checked:null,files:[],form:null,diretrizFile:"",showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:"",showFiles:!1,filesCollection:"",analiseProc:{createdAt:"",pendencias:""}},e.escFunction=function(t){e.state.checked||27!==t.keyCode||e.closeDetails()},e}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.redux,t=e.empCollection,a=e.rtCollection,n=e.processCollection,r=e.filesCollection,i=e.tecCollection;t[0]||this.props.loadEmpData(),n[0]||this.props.loadProcessData(),a[0]||this.props.loadRtData(),r[0]||this.props.loadFilesData(),i[0]||this.props.loadTecnicos(),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleSearch",value:function(e){this.setState(Object(h.a)({},this.state,{searchValue:e.target.value,checked:!1}))}},{key:"clearSearch",value:function(e){this.setState(Object(h.a)({},this.state,{checked:null,selectedId:null,searchValue:"",showFiles:null}))}},{key:"handleSelect",value:function(e){this.setState(Object(h.a)({},this.state,{selectedId:e.target.value.replace(/,/g,""),checked:e.currentTarget.id}))}},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({selectedId:null,showEmpDetails:!1,showRtDetails:!1,showFiles:!1,empId:"",rtId:""})}},{key:"showFiles",value:function(e){this.setState({showFiles:!0,selectedId:e.target.id.replace(/z/g,"")})}},{key:"handleChange",value:function(e){var t=e,a=this.state.analiseProc;a.pendencias=t,a.createdAt=new Date,this.setState({analiseProc:a})}},{key:"render",value:function(){var e=this,t=this.state.dataMatch,a=this.state.searchValue.toLowerCase(),n=this.props.redux.processCollection.filter(function(e){return"Aguardando An\xe1lise"===e.status});return n.sort(function(e,t){var a=new Date(e.updatedAt),n=new Date(t.updatedAt);return a&&n?n.getTime()>a.getTime()?1:a.getTime()>n.getTime()?-1:0:null}),t=a&&!this.state.checked?n.filter(function(e){return e.nomeEmpreendimento.toLowerCase().match(a)}):this.state.checked||this.state.checked&&a?n.filter(function(t){return t._id.toLowerCase().match(e.state.selectedId)}):n,r.a.createElement("div",null,r.a.createElement("div",null,this.state.selectedId?this.state.showFiles?r.a.createElement(Pt,{data:this.state,redux:this.props.redux,search:function(t){return e.handleSearch(t)},searchArray:t,selectProcess:this.handleSelect.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),showFiles:this.showFiles.bind(this)}):r.a.createElement("div",null,r.a.createElement(Ht,{data:this.state,redux:this.props.redux,clear:this.clearSearch.bind(this),close:this.closeDetails.bind(this),match:this.props.match,changeValue:this.handleChange.bind(this),showFiles:this.state.showFiles})):r.a.createElement(Pt,{data:this.state,redux:this.props.redux,search:function(t){return e.handleSearch(t)},searchArray:t,selectProcess:this.handleSelect.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),showFiles:this.showFiles.bind(this)}),r.a.createElement(Ge,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.redux.empCollection,rtCollection:this.props.redux.rtCollection})),r.a.createElement("div",null,r.a.createElement(wt,{selectedId:this.state.selectedId,showFiles:this.state.showFiles,close:this.closeDetails.bind(this),processCollection:this.props.redux.processCollection,filesCollection:this.props.redux.filesCollection})))}}]),t}(n.Component);var Gt=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadEmpData:F,loadRtData:T,loadProcessData:z,loadTecnicos:L,loadFilesData:M,reduxToastr:q},e)})(Wt),Yt=function(e){var t=e.id,a=e.presentValue,n=e.handleChange,i=e.municipio;return r.a.createElement("select",{id:t,name:"role",className:"browser-default",onChange:n},r.a.createElement("option",{value:a},a),r.a.createElement("option",{value:"admin"},"Administrador"),r.a.createElement("option",{value:"tecnico"},"T\xe9cnico da Ag\xeancia"),r.a.createElement("option",{value:"prefeitura"},"Prefeitura de ".concat(i)),r.a.createElement("option",{value:"empreend"},"Empreendedor"),r.a.createElement("option",{value:"rt"},"Respons\xe1vel T\xe9cnico"))},Jt=function(e){var t=e.id,a=e.handleChange,n=e.municipio,i=Ne.munEmpreendimento.options;return n||(n=""),r.a.createElement("select",{id:t,name:"municipio",className:"browser-default",onChange:a,value:n},i.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e||n)}))},Xt=function(e){return e.replace("Usu\xe1rio","name").replace("Permiss\xf5es","role").replace("E-mail","email").replace("\xed","i").toLowerCase()},Kt=function(e){var t=e.users,a=e.handleChange,n=e.editUsers,i=e.deleteUser,s=e.editTec,o=e.showVerified,l=e.verified,c=e.sort,d=e.reverse;return r.a.createElement("div",null,r.a.createElement("div",{className:"row right"},r.a.createElement("input",{id:"showVerified",type:"checkbox",checked:!0===l,onChange:o}),r.a.createElement("label",{style:{fontSize:"0.9rem"},htmlFor:"showVerified"},"Mostrar usu\xe1rios verificados")),r.a.createElement("table",{className:"resposive-table highlight"},r.a.createElement("thead",null,r.a.createElement("tr",null,["Usu\xe1rio","E-mail","Munic\xedpio"].map(function(e,t){return r.a.createElement("th",{key:t,name:Xt(e)},r.a.createElement("span",null," ",e," "),r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return c(Xt(e))}},d?"\u25bc":"\u25b2"))}),["Permiss\xf5es","Op\xe7\xf5es","Editar T\xe9cnico"].map(function(e,t){return r.a.createElement("th",{key:t,name:Xt(e),className:"center"},e)}))),r.a.createElement("tbody",null,t[0]?t.map(function(e,t){return r.a.createElement("tr",{id:e._id,key:t,style:{borderBottom:"1px solid #eee"}},r.a.createElement("td",null,e.name," ",e.surName),r.a.createElement("td",null,e.email),r.a.createElement("td",null,"prefeitura"===e.role?r.a.createElement(Jt,{id:e._id,handleChange:a,municipio:e.municipio}):e.municipio),r.a.createElement("td",null,r.a.createElement(Yt,{id:e._id,presentValue:e.role,handleChange:a,municipio:e.municipio})),r.a.createElement("td",{className:"center",style:{paddingLeft:"3%"}},r.a.createElement("input",{id:"v_".concat(e._id),name:"v_",type:"checkbox",checked:e.verified?"checked":"",onChange:a,title:"Confirmar usu\xe1rio"}),r.a.createElement("label",{htmlFor:"v_".concat(e._id)}),r.a.createElement("i",{id:"d_".concat(e._id),className:"material-icons red-text click",onClick:i,title:"Apagar"},"delete_outlined")),r.a.createElement("td",{className:"center"},"tecnico"===e.role&&r.a.createElement("i",{id:"t_".concat(e._id),className:"material-icons grey-text click",onClick:s,title:"Editar T\xe9cnico"},"settings")))}):r.a.createElement("tr",null),r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",{className:"center"},r.a.createElement("i",{style:{color:"teal"},onClick:n,title:"Salvar",className:"material-icons small click"},"save"))))))},Qt=a(118),Zt=a(34),$t=function(e){function t(){var e,a;Object(J.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(K.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={municipios:[],name:"",surName:"",email:"",cau:"",cities:[]},a}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.users,a=e.tecnicos,n=e.userId,r=t.filter(function(e){return e._id.match(n.replace("t_",""))})[0],i=a.filter(function(e){return e.email.match(r.email)})[0],s=[],o=[];if(Ne.munEmpreendimento.options.forEach(function(e){return s.push(Object(ce.a)({},e,!1))}),i){var l=i.municipios,c=(i._id,i.createdAt,i.updatedAt,i.__v,Object(Zt.a)(i,["municipios","_id","createdAt","updatedAt","__v"]));l.forEach(function(e){return s.find(function(t){return Object.keys(t)[0]===e})[e]=!0}),s.filter(function(e){return!0===Object.values(e)[0]}).forEach(function(e){return o.push(Object.keys(e)[0])}),c.cities=s,c.municipios=o,this.setState(Object(h.a)({},c))}else{r._id,r.verified,r.password,r.role;var d=Object(Zt.a)(r,["_id","verified","password","role"]);d.cities=s,this.setState(Object(h.a)({},d))}}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value,r=t.type,i=Object(Qt.a)(this.state.cities),s={},o=[];"checkbox"===r&&(i.find(function(e){return Object.keys(e)[0]===a})[a]=!i.find(function(e){return Object.keys(e)[0]===a})[a]),"text"===r&&Object.assign(s,Object(ce.a)({},a,n)),this.state.cities.filter(function(e){return!0===Object.values(e)[0]}).forEach(function(e){return o.push(Object.keys(e)[0])}),this.setState(Object(h.a)({},s,{cities:i,municipios:o}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state,n=(a.cities,Object(Zt.a)(a,["cities"]));S.a.put("/api/tecnicos",n).then(function(e){console.log(e.data),t.props.refresh()}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this,t=this.props,a=t.users,n=t.editTec,i=t.userId,s=a.filter(function(e){return e._id.match(i.replace("t_",""))})[0],o=Ne.munEmpreendimento.options,l=function(t){var a=e.state.cities.filter(function(e){return!0===Object.values(e)[0]}).filter(function(e){return Object.keys(e)[0]===t})[0];return a?"checked":void 0};return r.a.createElement("div",{style:et(!0,["15%","70%"])},r.a.createElement("div",{className:"row",style:{textAlign:"center"}},r.a.createElement("div",{style:{position:"absolute",top:"0.5%",right:"0.5%"}},r.a.createElement(Ee,{close:n})),r.a.createElement("h5",null,"Editar dados - ",s.name," ",s.surName)),r.a.createElement("form",{action:"submit",id:"form",onSubmit:this.handleSubmit.bind(this)},Object.entries(this.state).map(function(t,a){var n=Object(le.a)(t,2),i=n[0],s=n[1];return"municipios"!==i&&"cities"!==i&&r.a.createElement("div",{className:"row",key:a},r.a.createElement("label",{htmlFor:a},i),r.a.createElement("input",{type:"text",value:s,id:a,name:i,onChange:e.handleChange.bind(e)}))}),r.a.createElement("div",{className:"row"},r.a.createElement("h5",{style:{fontSize:"1rem",padding:"1%"}},"Munic\xedpios para an\xe1lise"),o.map(function(t,a){return""!==t&&r.a.createElement("div",{className:"col s6 m3 l2",key:a+100},r.a.createElement("input",{id:t,name:t,type:"checkbox",checked:l(t)||"",onChange:e.handleChange.bind(e),title:"Selecionar municipios"}),r.a.createElement("label",{htmlFor:t},t))}))),r.a.createElement(be,{display:!0,form:"form"}))}}]),t}(n.Component),ea=function(e,t){return e.sort(function(e,a){return e&&a?e[t].toLowerCase()>a[t].toLowerCase()?1:e[t].toLowerCase()<a[t].toLowerCase()?-1:0:null})},ta=function(e){function t(){var e;return Object(J.a)(this,t),(e=Object(K.a)(this,Object(Q.a)(t).call(this))).state={users:[],tecnicos:[],editTec:!1,userId:"",showVerified:!1,reverse:!1,vUsers:[],blockUsers:[]},e.escFunction=function(t){e.state.editTec&&27===t.keyCode&&e.setState({editTec:!1})},e}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t,a,n,r,i,s,o,l;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.getUsers,n=t.loadTecnicos,document.addEventListener("keydown",this.escFunction,!1),e.next=4,a();case 4:return e.next=6,n();case 6:r=this.props,i=r.auth,s=r.redux,o=i.usersCollection.filter(function(e){return!0===e.verified}),l=i.usersCollection.filter(function(e){return!1===e.verified}),this.setState({users:i.usersCollection,tecnicos:s.tecCollection,vUsers:o,blockUsers:l});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){var t,a=this.state.users,n=e.target.name;t=a.filter(function(t){return"".concat(n+t._id).match(e.target.id)})[0];var r=a.indexOf(t);"v_"===e.target.name?a[r].verified=!a[r].verified:"role"===n?a[r].role=e.target.value:"municipio"===n&&(a[r].municipio=e.target.value),this.setState({users:a})}},{key:"editUsers",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.state.users,e.next=4,S.a.put("/api/edit",{el:"user",item:a}).then(function(e){console.log("ok")}).catch(function(e){return alert(e)});case 4:return q("sucess","Registro alterado."),e.next=7,this.props.getUsers();case 7:n=a.filter(function(e){return!0===e.verified}),r=a.filter(function(e){return!1===e.verified}),this.setState({vUsers:n,blockUsers:r});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteUser",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.id.replace("d_",""),n=this.state.users.filter(function(e){return e._id.match(a)})[0],!window.confirm("Excluir ".concat(n.name," ").concat(n.surName,"?"))){e.next=8;break}return e.next=5,S.a.delete("/api/delete/item?id=".concat(a,"&el=user")).catch(function(e){return console.log(e)});case 5:return e.next=7,this.props.getUsers();case 7:this.setState({users:this.props.auth.usersCollection});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"editTec",value:function(e){this.setState({editTec:!this.state.editTec,userId:e.target.id})}},{key:"refresh",value:function(){this.setState({editTec:!this.state.editTec}),q("sucess","Dados do t\xe9cnico atualizados")}},{key:"showVerified",value:function(){this.setState({showVerified:!this.state.showVerified})}},{key:"sort",value:function(e){var t,a=this.state,n=a.vUsers,r=a.blockUsers,i=a.showVerified,s=a.reverse;i?(t=ea(n,e),!0===s&&t.reverse(),this.setState({vUsers:t,reverse:!s})):(t=ea(r,e),!0===s&&t.reverse(),this.setState({blockUsers:t,reverse:!s}))}},{key:"render",value:function(){var e=this.state,t=e.users,a=e.userId,n=e.tecnicos,i=e.showVerified,s=e.reverse,o=e.vUsers,l=e.blockUsers;return i&&(l=o),r.a.createElement("div",{className:"container",style:{width:"95%"}},r.a.createElement("div",null,r.a.createElement(xe,{title:"Gerenciar Usu\xe1rios",subtitle:"Crie, remova ou edite as permiss\xf5es/confirma\xe7\xf5es de cada usu\xe1rio do sistema. ",color:this.props.redux.setColor})),r.a.createElement(Kt,{users:l,handleChange:this.handleChange.bind(this),deleteUser:this.deleteUser.bind(this),editUsers:this.editUsers.bind(this),editTec:this.editTec.bind(this),showVerified:this.showVerified.bind(this),verified:this.state.showVerified,sort:this.sort.bind(this),reverse:s}),this.state.editTec&&r.a.createElement($t,{users:t,userId:a,tecnicos:n,editTec:this.editTec.bind(this),refresh:this.refresh.bind(this)}))}}]),t}(n.Component);var aa=Object(l.connect)(function(e){return{redux:e.cadastro,auth:e.auth}},function(e){return Object(o.b)({getUsers:_,reduxToastr:q,loadTecnicos:L},e)})(ta),na=function(e){function t(){var e,a;Object(J.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(K.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={municipio:"",prefeituras:[]},a}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentDidMount",value:function(){var e=this;S.a.get("/api/prefeituras").then(function(t){return e.setState({prefeituras:t.data})}).catch(function(e){return console.log(e)})}},{key:"handleChange",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target,n=a.name,r=a.value,"SELECT"!==a.nodeName){e.next=9;break}return e.next=4,this.setState({municipio:r});case 4:i=this.state,s=i.prefeituras,o=i.municipio,(l=s.filter(function(e){return e.municipio===o})[0])&&(l=Object(h.a)({nome:l.nome},l),this.setState(Object(h.a)({},this.state,l))),e.next=10;break;case 9:this.setState(Object(ce.a)({},n,r));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(e){var t=this,a=this.state,n=(a.prefeituras,Object(Zt.a)(a,["prefeituras"]));S.a.put("/api/prefeituras",n).then(function(e){return q("sucess",e.data,"Cadastro alterado")}).then(S.a.get("/api/prefeituras").then(function(e){return t.setState({prefeituras:e.data})}).catch(function(e){return console.log(e)})).catch(function(e){return q("err",e,"Erro!")}),e.preventDefault()}},{key:"render",value:function(){var e=this,t=this.state,a=t.prefeituras,n=t.municipio,i=a.filter(function(e){return e.municipio===n})[0];i&&(i=Object(h.a)({nome:i.nome},i));var s=Ne.munEmpreendimento.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)});return r.a.createElement("div",{className:"container"},r.a.createElement(xe,{title:"Editar dados das prefeituras"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"},r.a.createElement("label",null,"Selecione o munic\xedpio"),r.a.createElement("br",null),r.a.createElement("select",{className:"browser-default",value:this.state.municipio,onChange:this.handleChange.bind(this)},s))),r.a.createElement("div",{className:"row"},i?r.a.createElement("form",{id:"prefForm",onSubmit:this.handleSubmit.bind(this)},Object.entries(this.state).map(function(t,a){var n=Object(le.a)(t,2),i=n[0],s=n[1];return"updatedAt"!==i&&"_id"!==i&&"prefeituras"!==i&&r.a.createElement("div",{className:"col s12 m6",key:a},r.a.createElement("label",{htmlFor:i},i.replace(/\w/,function(e){return e.toUpperCase()})),r.a.createElement("input",{type:"text",value:s,name:i,onChange:e.handleChange.bind(e)}))}),r.a.createElement("div",{className:"col s12 right"},r.a.createElement(be,{form:"prefForm",display:!0}))):r.a.createElement("div",{className:"col push-s4",style:{paddingTop:"20%"}},r.a.createElement("h5",null,"Selecione o munic\xedpio."))))}}]),t}(n.Component),ra=function(e){function t(){return Object(J.a)(this,t),Object(K.a)(this,Object(Q.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(na,null))}}]),t}(n.Component),ia=Object(O.a)(Object(l.connect)(function(e){return Object(o.b)({reduxToastr:q},e)})(function(){var e=localStorage.getItem("role"),t="admin"===e||"prefeitura"===e,a="admin"===e||"tecnico"===e;return document.cookie.match("_sim-ad")?r.a.createElement(N.a,null,r.a.createElement(I.a,{path:"/",exact:!0,component:oe}),t&&r.a.createElement(I.a,{path:"/cadastro",component:Pe}),t&&r.a.createElement(I.a,{path:"/solicitaDiretriz",component:pt}),a&&r.a.createElement(I.a,{path:"/diretrizes",component:Nt}),t&&r.a.createElement(I.a,{path:"/solicitaAnuencia",component:St}),r.a.createElement(I.a,{path:"/showEmpreend",component:it}),a&&r.a.createElement(I.a,{path:"/Anuencia",exact:!0,component:Gt}),a&&r.a.createElement(I.a,{path:"/editData",component:Xe}),"admin"===e&&r.a.createElement(I.a,{path:"/users",exact:!0,component:aa}),"admin"===e&&r.a.createElement(I.a,{path:"/admin",exact:!0,component:ra})):(Y(),r.a.createElement("h5",{style:{marginTop:"25%"}},"Sess\xe3o expirada!"))})),sa=(a(325),[{endPoint:"/cadastro",label:"Cadastro"},{endPoint:"/solicitaDiretriz",label:"Solicitar Diretrizes Metropolitanas",item:"Processo cadastrado"},{endPoint:"/solicitaAnuencia",label:"Solicitar Anu\xeancia Pr\xe9via",item:"Diretrizes Metropolitanas emitidas"},{endPoint:"/showEmpreend",label:"Consultar Processos"}]),oa=[{endPoint:"/diretrizes",label:"Diretrizes Metropolitanas",item:"Aguardando Diretrizes Metropolitanas"},{endPoint:"/Anuencia",label:"Analisar Processo",item:"Aguardando An\xe1lise"},{endPoint:"/showEmpreend",label:"Consultar Processos"}],la=[sa[0],sa[1],oa[0],sa[2],oa[1],{endPoint:"/showEmpreend",label:"Gerenciar Dados"}],ca=[{endPoint:"/showEmpreend",label:"Consultar Processos"}],da=function(e){var t=e.item,a=e.processo;if(a&&a.length>0){var n=a.filter(function(e){return e.status.match(t)}).length;return"Diretrizes Metropolitanas emitidas"===t&&(n+=a.filter(function(e){return e.status.match("Pend\xeancias")}).length+a.filter(function(e){return e.status.match("Aguardando documenta\xe7\xe3o")}).length),r.a.createElement("div",{style:{display:"inline-block"}},n>0?r.a.createElement("sup",{style:{fontSize:"0.9em",borderRadius:"50%",padding:"0px 5px",backgroundColor:"red",fontWeight:"900"}},n):0===n?r.a.createElement("sup",null," "):null)}return null},ma=function(e){function t(){return Object(J.a)(this,t),Object(K.a)(this,Object(Q.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"componentWillMount",value:function(){this.props.setColor()}},{key:"render",value:function(){var e=this.props,t=e.processo,a=e.color,n=localStorage.getItem("role");return r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper",style:{paddingLeft:30,paddingRight:30,backgroundColor:a},id:"setcolor"},r.a.createElement(ee.a,{to:"/",className:"brand-logo"},r.a.createElement("i",{className:"material-icons",style:{fontSize:"30px"}},"home")),r.a.createElement(ee.a,{to:"","data-activates":"mobile-demo",className:"button-collapse"},r.a.createElement("i",{className:"material-icons"},"menu")),[{className:"right hide-on-med-and-down",id:""},{className:"side-nav",id:"mobile-demo"}].map(function(e,a){return r.a.createElement("ul",{className:e.className,id:e.id,key:a},function(e){switch(e){case"prefeitura":return sa;case"tecnico":return oa;case"admin":return la;case"empreend":case"rt":return ca;default:return}}(n).map(function(e,a){return r.a.createElement("li",{key:a+100},r.a.createElement(ee.a,{to:e.endPoint},e.label,e.item?r.a.createElement(da,{processo:t,item:e.item}):r.a.createElement("span",null)))}),"admin"===n&&r.a.createElement("li",null,r.a.createElement(ee.a,{to:"/users"},r.a.createElement("i",{className:"material-icons left",title:"Usu\xe1rios"},"person"))),"admin"===n&&r.a.createElement("li",null,r.a.createElement(ee.a,{to:"/admin"},r.a.createElement("i",{className:"material-icons left",title:"Prefeituras"},"account_balance"))),r.a.createElement("li",null,r.a.createElement(ee.a,{to:"/"},r.a.createElement("i",{className:"material-icons left",onClick:function(){return Y()},title:"Sair"},"logout"))))})))}}]),t}(n.Component),ua=Object(l.connect)(function(e){return{processo:e.cadastro.processCollection,color:e.cadastro.setColor}},function(e){return Object(o.b)({setColor:B},e)})(ma),pa=function(){return r.a.createElement("footer",{className:"grey lighten-4 black-text",style:{position:"fixed",bottom:0,width:"100%",borderTop:"0.1px solid #999",maxHeight:"20px"}},r.a.createElement("span",{style:{fontSize:"0.6rem"}},"\xa9 2019. Desenvolvido por Sandro Ver\xedssimo - NATE / Ag\xeancia de Desenvolvimento da RMBH."))},ha=function(e){return r.a.createElement("div",null,r.a.createElement("h4",{className:"header2"},e.title),r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12",onSubmit:e.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"mdi-communication-email prefix"}),r.a.createElement("input",{name:"email",type:"email",className:"validate",placeholder:"",onChange:e.handleChange}),r.a.createElement("label",{htmlFor:"email"},"E-mail"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"mdi-action-lock-outline prefix"}),r.a.createElement("input",{name:"password",type:"password",className:"validate",placeholder:"",onChange:e.handleChange}),r.a.createElement("label",{htmlFor:"password"},"Senha"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("button",{className:"btn cyan waves-effect waves-light right",type:"submit",name:"action",style:{backgroundColor:"transparent"}},"Entrar"))))))},fa=[{name:"name",className:"mdi-action-account-circle prefix",label:"Nome"},{name:"surName",className:"mdi-action-account-circle prefix",label:"Sobrenome"},{name:"email",className:"mdi-communication-email prefix",label:"E-mail"},{name:"municipio",className:"mdi-action-account-circle prefix",label:"Munic\xedpio"},{name:"password",className:"mdi-action-lock-outline prefix",label:"Senha"},{name:"confirmPassword",className:"mdi-action-lock-outline prefix",label:"Confirme sua senha"},{name:"role",className:"mdi-action-account-circle prefix",label:"\xc1rea de Atua\xe7\xe3o",options:["Poder p\xfablico","Iniciativa privada"]}],va=function(e){var t=e.handleChange,a=e.handleSubmit;return r.a.createElement("div",null,r.a.createElement("h4",{className:"header2"},e.title),r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12",onSubmit:a},fa.map(function(e,a){return r.a.createElement("div",{className:"row",key:a},"role"===e.name?r.a.createElement("label",null,e.label,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("span",{style:{marginRight:"5%"}},r.a.createElement("input",{id:"ip",type:"radio",name:e.name,value:"empreend",onChange:t}),r.a.createElement("label",{htmlFor:"ip"}," Iniciativa Privada")),r.a.createElement("span",null,r.a.createElement("input",{id:"pp",type:"radio",name:e.name,value:"prefeitura",onChange:t}),r.a.createElement("label",{htmlFor:"pp"}," Poder P\xfablico"))):r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{name:e.name,type:"confirmPassword"===e.name?"password":"email"===e.name||"password"===e.name?e.name:"text",className:"validate",onChange:t}),r.a.createElement("label",{htmlFor:e.name},e.label)))}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("button",{className:"btn cyan waves-effect waves-light right",type:"submit",name:"action",style:{backgroundColor:"transparent"}},"Cadastrar"))))))},ba=function(e){function t(){var e,a;Object(J.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(K.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={registered:!0,name:"",email:"",password:"",confirmPassword:"",role:"",municipio:""},a}return Object(Z.a)(t,e),Object(X.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(ce.a)({},e.target.name,e.target.value))}},{key:"login",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o,l,c;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,S.a.post("/api/login",{email:this.state.email,password:this.state.password}).then(function(e){return a=e.data}).catch(function(e){return q("Erro","Usu\xe1rio/senha invalidos."),null});case 3:if("Aguardando verifica\xe7\xe3o do usu\xe1rio."!==a){e.next=9;break}return e.next=6,localStorage.setItem("verified",!1);case 6:return this.props.login(!0),this.props.verify(!1),e.abrupt("return",null);case 9:return n=function(){return!!document.cookie.match("_sim-ad=","")},e.next=12,localStorage.setItem("login",n());case 12:if(a){e.next=14;break}return e.abrupt("return");case 14:if(!a.verified){e.next=29;break}r=Object.entries(a),i=0;case 17:if(!(i<r.length)){e.next=27;break}return s=r[i],o=Object(le.a)(s,2),l=o[0],c=o[1],e.next=24,localStorage.setItem(l,c);case 24:i++,e.next=17;break;case 27:this.props.login(!0),this.props.verify(!0);case 29:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"signup",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,i,s,o;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=this.state,r=n.name,i=n.surName,s=n.role,o=n.municipio,!(r&&i&&s&&o)){e.next=10;break}return e.next=5,this.setState({municipio:je(this.state.municipio),email:this.state.email.toLowerCase()});case 5:return e.next=7,S.a.post("/api/signup",this.state).then(function(e){"Senhas n\xe3o conferem."===e.data||"Usu\xe1rio j\xe1 cadastrado."===e.data||"E-mail inv\xe1lido."===e.data?q("err",e.data,"Erro!"):(a=e.data,q("sucess","Usu\xe1rio criado com sucesso",a.name))}).catch(function(e){return console.log(e.message)});case 7:setTimeout(function(){window.location.reload()},2e3),e.next=11;break;case 10:alert("Favor preencher todos os campos.");case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state.registered;return r.a.createElement("div",null,r.a.createElement("div",{className:"container col s12 m12 l6",style:{marginTop:"1%"}},r.a.createElement("img",{src:"/images/ad_login.png",className:"z-depth-2",alt:""}),r.a.createElement("div",{className:"card-panel"},t?r.a.createElement(ha,{title:"Entre no sistema",values:this.state,handleChange:this.handleChange.bind(this),handleSubmit:this.login.bind(this)}):r.a.createElement(va,{title:"Cadastre-se",values:this.state,handleChange:this.handleChange.bind(this),handleSubmit:this.signup.bind(this)})),t&&r.a.createElement("p",{className:"link right",onClick:function(){return e.setState({registered:!1})}}," N\xe3o possui usu\xe1rio e senha? Cadastre-se."),!t&&r.a.createElement("p",{className:"link right",onClick:function(){return e.setState({registered:!0})}}," J\xe1 \xe9 cadastrado? Fa\xe7a o login.")))}}]),t}(n.Component),Ea=Object(l.connect)(function(e){return{}},function(e){return Object(o.b)({login:P,verify:R,reduxToastr:q},e)})(ba),ga=function(){return r.a.createElement("div",{style:{position:"fixed",top:"40%",right:"15%",left:"15%",height:"50%",marginBottom:"25px",marginTop:"25px",textAlign:"center",zIndex:1}},r.a.createElement("img",{src:"/images/loading.gif",alt:"",height:"60px",width:"60px"}))},ya=function(){return r.a.createElement("div",{className:"container col s12 m12 l6",style:{marginTop:"1%"}},r.a.createElement("img",{src:"/images/ad_login.png",className:"z-depth-2",alt:""}),r.a.createElement("div",{style:{marginTop:"4%",textAlign:"center"}},r.a.createElement("div",{className:"card-panel"},r.a.createElement("h5",null,"Aguardando verifica\xe7\xe3o do usu\xe1rio.")," ",r.a.createElement("br",null),r.a.createElement("button",{className:"btn blue",onClick:function(){return window.location.reload()}},"Voltar"))))},xa=Object(l.connect)(function(e){return{auth:e.auth,render:e.cadastro}})(function(e){var t=e.render.loading;return document.cookie&&localStorage.getItem("verified")?r.a.createElement("div",{style:{position:"relative",height:"100%"}},r.a.createElement(D.a,null,r.a.createElement("div",{style:{marginBottom:"80px"}},r.a.createElement("header",null,r.a.createElement(ua,null)),r.a.createElement(ia,null))),r.a.createElement(pa,null),r.a.createElement(w,null),t&&r.a.createElement(ga,null)):e.auth.login?r.a.createElement(ya,null):r.a.createElement("div",null,r.a.createElement(Ea,null))}),ka=Object(o.a)(d.a,u.a,p.a)(o.d);s.a.render(r.a.createElement(function(){return r.a.createElement(l.Provider,{store:ka(C)},r.a.createElement(xa,null),r.a.createElement(w,null))},null),document.getElementById("root"))},88:function(e,t,a){}},[[119,1,2]]]);
//# sourceMappingURL=main.fc5d1ad4.chunk.js.map