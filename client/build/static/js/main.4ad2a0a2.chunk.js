(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{111:function(e,t,a){},116:function(e,t,a){e.exports=a(319)},316:function(e,t,a){},318:function(e,t,a){},319:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(25),i=a.n(s),o=a(13),l=a(14),c=a(106),d=a.n(c),m=a(107),u=a.n(m),p=a(108),h=a(3),f={empCollection:[],rtCollection:[],processCollection:[],filesCollection:[],tecCollection:[],id:"",nome:"",cpf:"",rua:"",bairro:"",cep:"",cidade:"",phone:"",email:"",numero:"",complemento:"",uf:"",nomeRt:"",emailRt:"",phoneRt:"",nProcesso:"",loadedData:{},empMatch:"",rtMatch:"",empId:"",editItem:!1,search:"",setColor:"",loading:!1},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_EMP_DATA":return Object(h.a)({},e,{empCollection:t.payload});case"LOAD_RT_DATA":return Object(h.a)({},e,{rtCollection:t.payload});case"LOAD_PROCESS_DATA":return Object(h.a)({},e,{processCollection:t.payload});case"LOAD_FILES_DATA":return Object(h.a)({},e,{filesCollection:t.payload});case"LOAD_TECNICOS":return Object(h.a)({},e,{tecCollection:t.payload});case"SET_COLOR":return Object(h.a)({},e,{setColor:t.payload});case"LOADING":return Object(h.a)({},e,{loading:t.payload});default:return e}},b={},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FIND_EMP_ID":return Object(h.a)({},e,{empId:t.payload,editItem:!0});case"DISABLE_EDIT":return Object(h.a)({},e,{editItem:!1});case"CHANGE_SEARCH_VALUE":return Object(h.a)({},e,{search:t.payload});case"EDIT_VALUE":return Object(h.a)({},e,{loadedData:t.payload});default:return e}},g=a(20),y=a.n(g),k={login:!1,verified:!1,usersCollection:[]},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN":return Object(h.a)({},e,{login:t.payload});case"VERIFY":return Object(h.a)({},e,{verified:t.payload});case"GET_USERS":return Object(h.a)({},e,{usersCollection:t.payload});case"LOG_OUT":return Object(h.a)({},e,{login:t.payload,user:null});default:return e}},w=Object(o.c)({auth:x,cadastro:v,busca:E,toastr:g.reducer}),C=(a(136),function(e){return r.a.createElement(y.a,{timeOut:3e3,newestOnTop:!1,preventDuplicates:!0,position:"top-right",transitionIn:"fadeIn",transitionOut:"fadeOut",progressBar:!0,closeOnToastrClick:!0})}),N=a(323),D=a(325),j=a(322),O=a(324),S=a(4),I=a.n(S);function P(e){return{type:"LOGIN",payload:e}}function A(e){return localStorage.clear("login",!1),{type:"LOG_OUT",payload:e}}function R(e){return localStorage.setItem("verified",e),{type:"VERIFY",payload:e}}function F(){return{type:"GET_USERS",payload:I.a.get("/api/users").then(function(e){return e.data}).catch(function(e){return console.log(e)})}}var _=function(){return{type:"LOAD_EMP_DATA",payload:I.a.get("/api/showEmpreend").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}};function T(){return{type:"LOAD_RT_DATA",payload:I.a.get("/api/showRt").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}}function M(){return{type:"LOAD_PROCESS_DATA",payload:I.a.get("/api/showProcess").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}}function z(){return{type:"LOAD_FILES_DATA",payload:I.a.get("/api/files").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}}function L(){return{type:"LOAD_TECNICOS",payload:I.a.get("/api/tecnicos").then(function(e){return e.data}).catch(function(e){console.log(e),g.toastr.error("Erro",e.toString(),"Erro"),A(!1)})}}var B=function(){var e=["rgb(104, 119, 133)","rgb(84, 104, 102)","rgb(105, 117, 153)","rgb(88, 103, 88)","rgb(117, 116, 101)","rgb(117, 117, 137)"];return{type:"SET_COLOR",payload:e[Math.floor(Math.random()*e.length)]}},q=function(e,t,a){var n=a||"Opera\xe7\xe3o realizada com sucesso";return"sucess"===e?g.toastr.success(n,t):g.toastr.error(n||"Erro",t)},U=function(e){return{type:"LOADING",payload:e}},V=a(2),H=a.n(V),W=a(5),G=function(){var e=new Date;e.setTime(e.getTime()-864e5);var t="expires="+e.toGMTString();document.cookie="_sim-ad=; "+t},J=function(){var e=Object(W.a)(H.a.mark(function e(){var t,a=arguments;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:" ",e.next=3,G();case 3:return e.next=5,localStorage.clear();case 5:q("error!",t.toString(),"Sess\xe3o expirada."),setTimeout(function(){window.location.reload()},1900);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Y=a(7),K=a(8),X=a(10),Q=a(9),Z=a(11),$=function(e){var t=e.user;return r.a.createElement("div",null,r.a.createElement("div",{className:"card-panel",style:{backgroundImage:"url(".concat("/images/home_bg.jpg",")")}},r.a.createElement("div",{className:"container",style:{paddingBottom:"0.5%"}},r.a.createElement("h1",{className:"display-3"}," ",r.a.createElement("strong",null,r.a.createElement("span",{style:{color:"white"}},"Anu\xeancia Digital")," ")," "),r.a.createElement("h6",{style:{color:"white",fontWeight:"500"}},"Vers\xe3o 1.5.7 - 19/07/19"),r.a.createElement("br",null),r.a.createElement("h4",{style:{color:"white",fontWeight:"500"}},"Ol\xe1, ",t.name," ",t.surName,"!"))),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},e.children)))},ee=a(321),te=function(e){var t=e.color,a=e.processes;return r.a.createElement("div",{style:{marginTop:"3%"}},r.a.createElement("h5",null,"Voc\xea tem  ",a.length," processos cadastrados."),r.a.createElement("br",null),r.a.createElement("div",{className:"col s12 m4 push-m4 center-align"},r.a.createElement("img",{src:"/images/gerenciarProc3.png",style:{margin:"10px"},alt:""}),r.a.createElement("h5",null,r.a.createElement("b",null,"Acompanhar Processos")),r.a.createElement("p",{style:{textAlign:"justify"}},"Acompanhe o andamento dos processos e veja os documentos, projetos, o hist\xf3rico e as comunica\xe7\xf5es referentes a ele."),r.a.createElement("p",{className:"btn",href:"",role:"button",style:{backgroundColor:t}},r.a.createElement(ee.a,{to:"/showEmpreend",style:{color:"white"}},"Consulta a Processos \xbb"))))},ae=[{title:"Cadastrar Processo",text:"Cadastre um novo processo, o interessado e o RT. Caso o interessado e RT estejam cadastrados, informe o nome e o formul\xe1rio ser\xe1 preenchido automaticamente.",link:"/cadastro",img:"/images/cadastro.png",w:"105px",h:"125px"},{title:"Solicitar Diretrizes",text:"Para solicitar diretrizes metropolitanas, selecione o processo e fa\xe7a o upload dos documentos necess\xe1rios em pdf. \xc9 necess\xe1rio que o processo esteja cadastrado.",link:"/solicitaDiretriz",img:"/images/solDir.jpg",w:"120px",h:"125px"},{title:"Solicitar Anu\xeancia",text:"Para solicitar anu\xeancia pr\xe9via, selecione o processo e fa\xe7a o upload dos documentos em meio digital. \xc9 necess\xe1rio que o processo tenha diretrizes metropolitanas validas.",link:"/solicitaAnuencia",img:"/images/solAnuencia2.png  ",w:"120px",h:"125px"},{title:"Acompanhar Processos",text:"Visualize os dados dos processos, interesados e RTs. Acompanhe o andamento dos processos, incluindo seus respectivos documentos, projetos, a\xe7\xf5es e hist\xf3rico.",link:"/showEmpreend",img:"/images/process_info3.png",w:"110px",h:"125px"}],ne=function(e){var t=e.color;return r.a.createElement("div",null,ae.map(function(e,a){return r.a.createElement("div",{align:"center",className:"col s12 m6 l3",key:a},r.a.createElement("img",{src:e.img,style:{margin:"10px"},alt:"",width:e.w,height:e.h}),r.a.createElement("h5",null,r.a.createElement("b",null,e.title)),r.a.createElement("p",{style:{textAlign:"justify",padding:"0 10%"}},e.text),r.a.createElement("p",{className:"btn",href:"",role:"button",style:{backgroundColor:t}},r.a.createElement(ee.a,{to:e.link,style:{color:"white"}},e.title)," ","\xbb"))}))},re=[{title:"Diretrizes Metropolitanas",text:"Verifique a documenta\xe7\xe3o enviada, agende a vistoria e a CGT e emita a diretriz metropolitana para os processos cadastrados.",link:"/diretrizes",img:"/images/solDir.jpg",w:"105px",h:"125px"},{title:"Analisar Processos",text:"Verifique a documenta\xe7\xe3o, acesse os arquivos e documentos e analise os projetos enviados para emitir pend\xeancias ou anuir o processo.",link:"/anuencia",img:"/images/solAnuencia2.png",w:"120px",h:"125px"},{title:"Acompanhar Processos",text:"Visualize os dados dos processos, interesados e RTs. Acompanhe o andamento dos processos e veja seus documentos, projetos e seu hist\xf3rico.",link:"/showEmpreend",img:"/images/process_info3.png",w:"110px",h:"125px"}],se=function(e){var t=e.color;return r.a.createElement("div",null,re.map(function(e,a){return r.a.createElement("div",{align:"center",className:"col s12 m6 l4",key:a},r.a.createElement("img",{src:e.img,style:{margin:"10px"},alt:"",width:e.w,height:e.h}),r.a.createElement("h5",null,r.a.createElement("b",null,e.title)),r.a.createElement("p",{style:{textAlign:"justify",padding:"0 10%",maxHeight:"75px"}},e.text),r.a.createElement("p",{className:"btn",href:"",role:"button",style:{backgroundColor:t}},r.a.createElement(ee.a,{to:e.link,style:{color:"white"}},e.title)," ","\xbb"))}))},ie=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={setColor:""},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.props.loadEmpData(),this.props.loadRtData(),this.props.loadProcessData(),setTimeout(function(){var t=document.getElementById("setcolor").style.backgroundColor;e.setState({setColor:t})},450)}},{key:"render",value:function(){var e=Object(h.a)({},localStorage);return r.a.createElement("div",null,r.a.createElement($,{user:e},("empreend"===e.role||"rt"===e.role)&&r.a.createElement(te,{color:this.state.setColor,user:e,processes:this.props.data.processCollection}),("prefeitura"===e.role||"admin"===e.role)&&r.a.createElement(ne,{color:this.state.setColor}),"tecnico"===e.role&&r.a.createElement(se,{color:this.state.setColor})))}}]),t}(n.Component);var oe=Object(l.connect)(function(e){return{data:e.cadastro}},function(e){return Object(o.b)({loadEmpData:_,loadRtData:T,loadProcessData:M},e)})(ie),le=a(26),ce=a(12),de=function(e,t,a,n,r){return'\n    <div style=" \n        position: relative;         \n        font-size: 1rem; \n        font-family: sans-serif;\n        background-color: white;  \n        padding: 3%; \n        border: 1px solid #000;\n        text-align: justify;\n        text-justify: inter-word;\n        border: 1px solid #bbbbbb;\n        border-radius: 1%;\n    ">    \n            <strong>A/C '.concat(e,"</strong>\n            <br />\n            <p>Foi registrada uma movimenta\xe7\xe3o do processo que solicita a emiss\xe3o de Anu\xeancia \n                Pr\xe9via para o ").concat(t," <strong>").concat(a,"</strong>, situado no munic\xedpio de \n                ").concat(n,":</p>\n\n            <p><strong> ").concat(r,' </strong></p>\n\n            <p>Para maiores informa\xe7\xf5es, visite o site\n        <a href="http://anuenciadigital.ml" target="_blank">Anu\xeancia Digital</a>\n            </p>            \n            <p>Atenciosamente,</p><p><em>Equipe da Ag\xeancia de Desenvolvimento da RMBH</em></p>\n        </div>\n    ')},me=function(){var e=Object(W.a)(H.a.mark(function e(t,a,n,r,s,i,o,l){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,I.a.post("/api/mail",{to:"".concat(t,", ").concat(a),subject:"Atualiza\xe7\xe3o do processo ".concat(s," - ").concat(o),html:de(n,r,s,i,o)}).then(function(e){return console.log("ok")});case 2:case"end":return e.stop()}},e)}));return function(t,a,n,r,s,i,o,l){return e.apply(this,arguments)}}(),ue=a(16),pe=function(e){return r.a.createElement("div",{className:"row"},r.a.createElement("div",null,r.a.createElement("button",{className:"btn-flat waves-effect btn-floating right teal",disabled:e.enable,title:"Avan\xe7ar",onClick:e.enableInput},r.a.createElement("i",{className:"material-icons"},"arrow_forward"))))},he=function(e){var t=e.disabled,a=e.icon;return r.a.createElement("div",{className:"input"},r.a.createElement("button",{className:"btn-floating left red darken-3 ".concat(e.size),disabled:t,title:"Voltar",onClick:function(){return e.onClick()}},r.a.createElement("i",{className:"material-icons"},a)))},fe=function(e){return"admin"===e.userRole?r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",style:{fontSize:"20px",color:"red",cursor:"pointer"},title:"Apagar",onClick:function(){return e.delete(e.id)}},"delete_outline")):r.a.createElement("span",null)},ve=function(e){return"admin"===e.userRole?r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",style:{fontSize:"20px",color:"teal",cursor:"pointer"},title:"Editar",onClick:function(){return e.edit(e.id)}},"edit")):r.a.createElement("span",null)},be=function(e){return e.display?r.a.createElement("button",{className:"btn-flat waves-effect btn-floating right teal darken-2",title:"Salvar",form:e.form,type:"submit"},r.a.createElement("i",{className:"material-icons"},"save")):null},Ee=function(e){return r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons right",title:"Fechar",style:{cursor:"pointer",color:"red"},onClick:e.close},"close"))},ge=function(e){var t=e.showInfo,a=e.id;return r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",id:a,onClick:t,style:{fontSize:"20px",color:"#1D90EE",cursor:"pointer"},title:"Informa\xe7\xf5es"},"info"))},ye=function(e){var t=e.id,a=e.archieve,n=e.archieved;return"admin"===e.userRole?r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",style:{fontSize:"20px",color:n?"blue":"darkorange",cursor:"pointer"},title:n?"Desarquivar":"Arquivar",onClick:function(){return a(t,n)}},n?"unarchive":"archive")):r.a.createElement("span",null)},ke=function(e){return r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons",style:{fontSize:"20px",color:"grey",cursor:"pointer"},title:"Ver no mapa",onClick:function(){return e.showMap(e.id)}},"map"))},xe=function(e){var t,a=e.title,n=e.subtitle,s=e.color;return r.a.createElement("div",{className:"row col s12"},r.a.createElement("div",{style:{marginTop:"20px"}},r.a.createElement("h5",null,a)),n?r.a.createElement("div",{className:"card-panel valign-wrapper",style:{marginBottom:"10px",maxHeight:"10px",backgroundColor:s,filter:"brightness(200%)",borderRadius:"10px 10px",fontSize:"1rem",fontWeight:500,fontFamily:"Calibri"}},r.a.createElement("span",{style:{color:"black"}},n," ",(t=e.hyperLink)?r.a.createElement("a",{href:"mailto:"+t},r.a.createElement("span",{className:"link"},t)):null)):void 0)},we={nomeEmpreendimento:{divClassName:"input-field col s12 m6 l4",type:"text",name:"nomeEmpreendimento",label:"Nome do Empreendimento:",onBlur:null},area:{divClassName:"input-field col s12 m4 l2",type:"text",name:"area",label:"\xc1rea total da Gleba (m\xb2):",onBlur:null,pattern:"[0-9]*[.]?([0-9]{3}[.]?)?([0-9]{3}[.]?)?([,][0-9]{1,4})?"}},Ce={phoneRt:{divClassName:"input-field col s12 m6 l2",type:"text",name:"phoneRt",label:"Telefone",onBlur:null,pattern:"((([+][0-9]{1,3})?[ ]?[-]?[(]?[0-9]{2,3}[)]?[ ]?[-]?[0-9]{4,5}[ ]?[-]?[0-9]{4}))"},emailRt:{divClassName:"input-field col s12 m6 l4",type:"email",name:"emailRt",label:"E-mail",onBlur:null}},Ne={cpf:{divClassName:"input-field col s12 m3 l2",type:"text",name:"cpf",label:"CPF / CNPJ",pattern:"([0-9]{2}[.]?[0-9]{3}[.]?[0-9]{3}[/]?[0-9]{4}[-]?[0-9]{2})|([0-9]{3}[.]?[0-9]{3}[.]?[0-9]{3}[-]?[0-9]{2})"},phone:{divClassName:"input-field col s12 m3 l2",type:"text",name:"phone",label:"Telefone (com DDD)",pattern:"((([+][0-9]{1,3})?[ ]?[-]?[(]?[0-9]{2,3}[)]?[ ]?[-]?[0-9]{4,5}[ ]?[-]?[0-9]{4}))"},email:{divClassName:"input-field col s12 m6 l3",type:"email",name:"email",label:"E-mail"},CEP:{divClassName:"input-field col s12 m3 l1",type:"text",name:"cep",label:"CEP",pattern:"([0-9]{2}[.]?[0-9]{3}[-]?[0-9]{3})"},numero:{divClassName:"input-field col s12 m3 l1",type:"text",name:"numero",label:"N\xfamero",pattern:"[0-9]*"},complemento:{divClassName:"input-field col s12 m3 l2",type:"text",name:"complemento",label:"Complemento"},rua:{divClassName:"input-field col s12 m6 l3",type:"text",name:"rua",label:"Rua"},bairro:{divClassName:"input-field col s12 m3 l2",type:"text",name:"bairro",label:"Bairro"},cidade:{divClassName:"input-field col s12 m4 l2",type:"text",name:"cidade",label:"Cidade"},uf:{divClassName:"input-field col s12 m3 l1",type:"text",name:"uf",label:"Estado"}},De={divClassName:"input-field col s12 m4 l2",name:"modalidade",label:"Modalidade:",options:["","Desmembramento","Loteamento"]},je={munEmpreendimento:{divClassName:"input-field col s12 m4 l2",type:"text",name:"munEmpreendimento",label:"Munic\xedpio:",options:["","Baldim","Belo Horizonte","Betim","Brumadinho","Caet\xe9","Capim Branco","Confins","Contagem","Esmeraldas","Florestal","Ibirit\xe9","Igarap\xe9","Itaguara","Itatiaiu\xe7u","Jaboticatubas","Juatuba","Lagoa Santa","M\xe1rio Campos","Mateus Leme","Matozinhos","Nova Lima","Nova Uni\xe3o","Pedro Leopoldo","Raposos","Ribeir\xe3o das Neves","Rio Acima","Rio Manso","Sabar\xe1","Santa Luzia","S\xe3o Joaquim de Bicas","S\xe3o Jos\xe9 da Lapa","Sarzedo","Taquara\xe7u de Minas","Vespasiano"]}},Oe=function(e){var t,a,n=je.munEmpreendimento.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}),s=De.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}),i=function(t,a){var n=[];for(var s in t)n.push({id:s,settings:t[s],enableInput:a});return n.map(function(t,a){var n=t.settings;return r.a.createElement("div",{key:a,className:n.divClassName},r.a.createElement("input",{type:n.type,id:n.name,className:"validate",pattern:n.pattern||null,required:"complemento"!==n.name&&!0,"aria-required":"complemento"!==n.name&&!0,name:n.name,onChange:e.handleChange,value:e.data[t.id],placeholder:" ",disabled:t.enableInput,onBlur:e.handleBlur}),r.a.createElement("label",{className:"active",htmlFor:n.name,"data-error":"\u2718","data-success":"\u2713"},n.label))})},o=Object(h.a)({},localStorage);return r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement("div",{className:"tab-pane fade show active",id:"empreend"},r.a.createElement(xe,{title:"Cadastro de Processos",subtitle:"Preencha os dados do interessado e RT do processo. Caso o interessado e RT n\xe3o estejam cadastrados, um novo cadastro ser\xe1 gerado automaticamente.",color:e.color}),r.a.createElement("form",{onSubmit:e.handleSubmit},r.a.createElement("fieldset",{className:"input-field"},r.a.createElement("legend",{className:"input-field"},r.a.createElement("strong",null," 1- Interessado ")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12 m6 l4"},r.a.createElement("input",{type:"text",list:"empreendList",id:"nome",className:"validate",name:"nome",onChange:e.handleChange,value:e.data.nome,onBlur:e.handleBlurName,disabled:e.data.enableEmp,autoFocus:!0}),r.a.createElement("label",{className:"active",htmlFor:"nome"},"Nome"),(t=e.config.empCollection,a="empreendList",e.data.nome.length>2?r.a.createElement("datalist",{id:a},t.map(function(e,t){return r.a.createElement("option",{key:t},e.nome)})):void 0)),i(Ne,e.data.enableEmp))),r.a.createElement(pe,{enableInput:e.enableRtInput,enable:e.data.enableEmp}),r.a.createElement("fieldset",{className:"input-field"},r.a.createElement("legend",{className:"input-field"},r.a.createElement("strong",null," 2 - Respons\xe1vel T\xe9cnico ")),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12 m6 l4"},r.a.createElement("input",{type:"text",list:"rtList",className:"validate",name:"nomeRt",id:"rtInput",onChange:e.handleChange,value:e.data.nomeRt,onBlur:e.handleBlurRtName,disabled:e.data.enableRt,autoFocus:e.data.autoFocusRt}),r.a.createElement("label",{className:"active",htmlFor:"nome"},"Nome"),function(e,t,a){return a.length>2?r.a.createElement("datalist",{id:t},e.map(function(e,t){return r.a.createElement("option",{key:t},e.nomeRt)})):void 0}(e.config.rtCollection,"rtList",e.data.nomeRt)),i(Ce,e.data.enableRt))),r.a.createElement(he,{onClick:e.enableEmpInput,disabled:e.data.enableRt,icon:"arrow_back"}),r.a.createElement(pe,{enableInput:e.enableProcessInput,enable:e.data.enableRt}),r.a.createElement("fieldset",{className:"input-field"},r.a.createElement("legend",{className:"input-field"},r.a.createElement("strong",null," 3 - Dados do Empreendimento ")),r.a.createElement("div",{className:"row"},i(we,e.data.enableProcess),r.a.createElement("div",{className:"col s12 m4 l2"},r.a.createElement(ue.Input,{name:"modalidade",type:"select",label:"Modalidade",defaultValue:e.data.modalidade,onChange:e.handleChange,disabled:e.data.enableProcess},s)),r.a.createElement("div",{className:"col s12 m4 l3"},"admin"===o.role?r.a.createElement(ue.Input,{name:"munEmpreendimento",type:"select",label:"Munic\xedpio",defaultValue:e.data.munEmpreendimento,onChange:e.handleChange,disabled:e.data.enableProcess},n):r.a.createElement("div",{className:"input-field col s12 m6 l2"})))),r.a.createElement("div",null,r.a.createElement(he,{onClick:e.backToRt,disabled:e.data.enableProcess,icon:"arrow_back"}),r.a.createElement("input",{type:"submit",className:"btn right",disabled:e.data.enableProcess,style:{marginTop:"20px"},value:"Cadastrar processo"})),r.a.createElement("br",null),r.a.createElement("br",null))))},Se=a(109),Ie=function(e){return e?e.split(" ").map(function(e){var t=Object(Se.a)(e),a=t[0],n=t.slice(1);return a.toUpperCase()+n.join("").toLowerCase()}).join(" ").replace(" Da"," da").replace(" De "," de ").replace(/-mg|\/mg|, mg| - mg| -mg|,mg| \/ mg| \/mg/gi,""):e},Pe=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={empId:"",rtId:"",nome:"",cpf:"",birth:"",phone:"",cep:"",numero:"",complemento:"",email:"",rua:"",bairro:"",cidade:"",uf:"",nomeRt:"",emailRt:"",phoneRt:"",nomeEmpreendimento:"",area:"",modalidade:"",munEmpreendimento:"",enableEmp:"",enableRt:"disabled",enableProcess:"disabled",empMatch:null,rtMatch:null},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=this.props.cadastro,t=e.empCollection,a=e.rtCollection,n=e.processCollection,r=e.tecCollection;t[0]||this.props.loadEmpData(),n[0]||this.props.loadProcessData(),a[0]||this.props.loadRtData(),r[0]||this.props.loadTecnicos()}},{key:"enableRtInput",value:function(){var e=Object(W.a)(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({enableEmp:"disabled",enableRt:"",enableProcess:"disabled"});case 2:document.getElementById("rtInput").focus();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"enableProcessInput",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t,a;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Object(h.a)({},localStorage),a=Ie(t.municipio),"prefeitura"!==t.role){e.next=5;break}return e.next=5,this.setState({munEmpreendimento:a});case 5:return e.next=7,this.setState(Object(h.a)({},this.state,{enableRt:"disabled",enableProcess:"",enableEmp:"disabled"}));case 7:document.getElementById("nomeEmpreendimento").focus();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"enableEmpInput",value:function(e){this.setState({enableRt:"disabled",enableProcess:"disabled",enableEmp:""})}},{key:"handleBlur",value:function(e){var t=this;if(e.preventDefault(),"cep"===e.target.name){var a=this.state.cep.replace(".","");I.a.get("https://api.postmon.com.br/v1/cep/".concat(a)).then(function(e){t.setState(Object(h.a)({},t.state,{rua:e.data.logradouro,bairro:e.data.bairro,cidade:e.data.cidade,uf:e.data.estado}))})}}},{key:"handleChange",value:function(e){e.preventDefault();var t=[],a=[];if("nome"===e.target.name){var n,r,s=e.target.value;if(t=this.props.cadastro.empCollection.filter(function(e){return e.nome.toLowerCase().match(s.toLowerCase())}),s&&t[0])this.setState(Object(h.a)({},this.state,(n={},Object(ce.a)(n,e.target.name,e.target.value),Object(ce.a)(n,"empMatch",t),n)));else t="",this.setState(Object(h.a)({},this.state,(r={},Object(ce.a)(r,e.target.name,e.target.value),Object(ce.a)(r,"empMatch",t),r)))}else if("nomeRt"===e.target.name){var i,o,l=e.target.value;if(a=this.props.cadastro.rtCollection.filter(function(e){return e.nomeRt.toLowerCase().match(l.toLowerCase())}),l&&a[0])this.setState(Object(h.a)({},this.state,(i={},Object(ce.a)(i,e.target.name,e.target.value),Object(ce.a)(i,"rtMatch",a),i)));else a="",this.setState(Object(h.a)({},this.state,(o={},Object(ce.a)(o,e.target.name,e.target.value),Object(ce.a)(o,"rtMatch",a),o)))}else this.setState(Object(h.a)({},this.state,Object(ce.a)({},e.target.name,e.target.value)))}},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c,d,m,u,p,f,v,b,E,g,y=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.state,n=a.nome,r=a.nomeRt,s=a.nomeEmpreendimento,i=a.modalidade,o=a.munEmpreendimento,l=a.empMatch,c=a.rtMatch,d=a.empId,m=a.rtId,u=Object(h.a)({},localStorage),p=this.props.cadastro.tecCollection,f=p.filter(function(e){return e.municipios.some(function(e){return e===y.state.munEmpreendimento})})[0],v="Loteamento"===i?"Processo cadastrado":"Aguardando documenta\xe7\xe3o",b={nome:this.state.nome,cpf:this.state.cpf,rua:this.state.rua,bairro:this.state.bairro,cep:this.state.cep,cidade:this.state.cidade,phone:this.state.phone,email:this.state.email.toLowerCase(),numero:this.state.numero,complemento:this.state.complemento,uf:this.state.uf},E={nomeRt:this.state.nomeRt,emailRt:this.state.emailRt.toLowerCase(),phoneRt:this.state.phoneRt},g={nomeEmpreendimento:this.state.nomeEmpreendimento,modalidade:this.state.modalidade,area:this.state.area.replace(/\./g,"").replace(/,/g,"."),munEmpreendimento:this.state.munEmpreendimento,status:v,tecnico:"T\xe9cnico n\xe3o alocado",cgt:"CGT n\xe3o agendada",vistoria:"Vistoria n\xe3o agendada",daeDir:"DAE n\xe3o recolhida",daeAnuencia:"DAE n\xe3o recolhida",processHistory:[{label:"Processo cadastrado",createdAt:new Date,user:{nome:u.name+" "+u.surName,email:u.email}}]},"Desmembramento"===this.state.modalidade&&(g.tecnico=f.name+" "+f.surName),n&&r&&s){e.next=14;break}alert("Favor preencher os dados do empreendedor, RT e empreendimento."),e.next=53;break;case 14:if(i&&(o||"admin"!==u.role)){e.next=18;break}alert("Favor preencher a modalidade do empreendimento."),e.next=53;break;case 18:if(!(n&&r&&s&&i&&o)){e.next=53;break}if(this.props.loading(!0),e.prev=20,!l||!c){e.next=28;break}return g.empId=d,g.rtId=m,e.next=26,I.a.post("/api/cadastro_process",g);case 26:e.next=43;break;case 28:if(!l||c){e.next=34;break}return g.empId=d,e.next=32,I.a.post("/api/cadastro_rt",E).then(function(e){g.rtId=e.data.RT_id,I.a.post("/api/cadastro_process",g)});case 32:e.next=43;break;case 34:if(l||!c){e.next=40;break}return g.rtId=m,e.next=38,I.a.post("/api/cadastro_emp",b).then(function(e){g.empId=e.data.Cadastro_id,I.a.post("/api/cadastro_process",g)});case 38:e.next=43;break;case 40:if(l||c){e.next=43;break}return e.next=43,I.a.post("/api/cadastro_emp",b).then(function(e){g.empId=e.data.Cadastro_id,I.a.post("/api/cadastro_rt",E).then(function(e){g.rtId=e.data.RT_id,I.a.post("/api/cadastro_process",g)})});case 43:return this.props.loading(!1),e.next=46,me(b.email,E.emailRt,b.nome,g.modalidade,g.nomeEmpreendimento,g.munEmpreendimento,"Processo cadastrado.");case 46:q("sucess",g.nomeEmpreendimento,"Processo Cadastrado."),setTimeout(function(){window.location.reload()},1600),e.next=53;break;case 50:e.prev=50,e.t0=e.catch(20),J(e.t0);case 53:case"end":return e.stop()}},e,this,[[20,50]])}));return function(t){return e.apply(this,arguments)}}()},{key:"handleBlurName",value:function(){var e=Object(W.a)(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.empMatch||!this.state.empMatch[0]||this.state.empMatch[0].nome!==this.state.nome){e.next=7;break}return e.next=3,this.setState(Object(h.a)({},this.state,{empId:this.state.empMatch[0]._id,phone:this.state.empMatch[0].phone,cpf:this.state.empMatch[0].cpf,cep:this.state.empMatch[0].cep,numero:this.state.empMatch[0].numero,complemento:this.state.empMatch[0].complemento,email:this.state.empMatch[0].email,rua:this.state.empMatch[0].rua,bairro:this.state.empMatch[0].bairro,cidade:this.state.empMatch[0].cidade,uf:this.state.empMatch[0].uf}));case 3:Object.entries(this.state).forEach(function(e){var t=Object(le.a)(e,2),a=t[0];""!==t[1]&&document.getElementById(a)&&(document.getElementById(a).className="",document.getElementById(a).required=!1,document.getElementById(a).setAttribute("aria-required",!1))}),this.enableRtInput(),e.next=8;break;case 7:this.setState(Object(h.a)({},this.state,{empId:"",phone:"",cpf:"",birth:"",cep:"",numero:"",complemento:"",email:"",rua:"",bairro:"",cidade:"",uf:""}));case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleBlurRtName",value:function(){var e=Object(W.a)(H.a.mark(function e(){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.rtMatch||!this.state.rtMatch[0]||this.state.rtMatch[0].nomeRt!==this.state.nomeRt){e.next=6;break}return e.next=3,this.setState({rtId:this.state.rtMatch[0]._id,phoneRt:this.state.rtMatch[0].phoneRt,emailRt:this.state.rtMatch[0].emailRt});case 3:""!==this.state.enableEmp&&(document.getElementById("rtInput").className="validade valid",this.enableProcessInput()),e.next=7;break;case 6:this.setState({rtId:"",phoneRt:"",emailRt:""});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"backToRt",value:function(){this.setState({enableEmp:"disabled",enableRt:"",enableProcess:"disabled"})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Oe,{data:this.state,config:this.props.cadastro,handleChange:this.handleChange.bind(this),handleBlurName:this.handleBlurName.bind(this),handleBlurRtName:this.handleBlurRtName.bind(this),handleSubmit:this.handleSubmit.bind(this),handleBlur:this.handleBlur.bind(this),enableRtInput:this.enableRtInput.bind(this),enableProcessInput:this.enableProcessInput.bind(this),enableEmpInput:this.enableEmpInput.bind(this),backToRt:this.backToRt.bind(this),color:this.props.cadastro.setColor}))}}]),t}(r.a.Component);var Ae=Object(l.connect)(function(e){return{cadastro:e.cadastro}},function(e){return Object(o.b)({loadEmpData:_,loadRtData:T,loadProcessData:M,loadTecnicos:L,loading:U,reduxToastr:q},e)})(Pe);function Re(){return{type:"DISABLE_EDIT"}}function Fe(e){return{type:"FIND_EMP_ID",payload:e}}function _e(e){return{type:"CHANGE_SEARCH_VALUE",payload:e}}var Te=[{name:"processHistory",label:"Hist\xf3rico do Processo",div:"col s1"},{name:"_id",label:"ID",div:"col s3"},{name:"nProcess",label:"Num. do processo",div:"col s1"},{name:"nomeEmpreendimento",label:"Nome do empreendimento",div:"col s2"},{name:"modalidade",label:"Modalidade",div:"col s1"},{name:"area",label:"\xc1rea (m\xb2)",div:"col s1"},{name:"munEmpreendimento",label:"Munic\xedpio",div:"col s1"},{name:"status",label:"Status do processo",div:"col s1"},{name:"tecnico",label:"T\xe9cnico da Ag\xeancia",div:"col s1"},{name:"cgt",label:"Data da CGT",div:"col s1"},{name:"vistoria",label:"Data da Vistoria",div:"col s1"},{name:"daeDir",label:"DAE - Diretrizes",div:"col s1"},{name:"daeAnuencia",label:"DAE - Anu\xeancia",div:"col s1"},{name:"empId",label:"EmpId",div:"col s1"},{name:"rtId",label:"rtId",div:"col s1"},{name:"createdAt",label:"Data de Cria\xe7\xe3o",div:"col s1"},{name:"updatedAt",label:"Atualizado em",div:"col s1"},{name:"__v",label:"version",div:"col s1"}],Me=[{label:"Diretrizes Municipais",nameInput:"dirMunFile"},{label:"Delimita\xe7\xe3o da \xe1rea do empreendimento (em formato kml)",nameInput:"kml",map:!0,tooltip:"O arquivo anexado n\xe3o dever\xe1 conter linhas e/ou pontos, apenas um pol\xedgono, em extens\xe3o kml",tt:!0},{label:"Levantamento Planialtim\xe9trico (em formato DWG)",nameInput:"levPlanFile"},{label:"C\xf3pia do boleto e comprovante de pagamento da DAE",nameInput:"dirDaeFile",tooltip:"Clique para obter informa\xe7\xf5es sobre o c\xe1lculo e pagamento do Documento de Arrecada\xe7\xe3o Estadual (DAE)",tt:!0,link:!0}],ze=[{name:"_id",label:"ID",div:"col s1"},{name:"nome",label:"Nome",div:"col s2"},{name:"cpf",label:"CPF",div:"col s2"},{name:"rua",label:"Rua",div:"col s3"},{name:"bairro",label:"Bairro",div:"col s1"},{name:"cep",label:"CEP",div:"col s1"},{name:"cidade",label:"Cidade",div:"col s2"},{name:"phone",label:"Telefone",div:"col s1"},{name:"email",label:"E-mail",div:"col s2"},{name:"numero",label:"N\xfamero",div:"col s1"},{name:"complemento",label:"Complemento",div:"col s1"}],Le=[{name:"_id",label:"ID",div:"col s1"},{name:"nomeRt",label:"Nome",div:"col s1"},{name:"emailRt",label:"E-mail",div:"col s2"},{name:"phoneRt",label:"Telefone",div:"col s2"}],Be=[{nameInput:"regImovel",label:"Registro do Im\xf3vel",tooltip:"Certid\xe3o de Registro do Im\xf3vel com negativa de \xf4nus, emitida em at\xe9 30 dias antes da entrada do processo na Prefeitura Municipal."},{nameInput:"CNDOnus",label:"Certid\xe3o Negativa de \xf4nus reais",tooltip:"Certid\xe3o Negativa de \xf4nus reais."},{nameInput:"CNDMun",label:"Certid\xe3o Negativa de tributos municipais",tooltip:"Certid\xe3o Negativa de tributos municipais."},{nameInput:"empRG",label:"Fotoc\xf3pia da Identidade do propriet\xe1rio",tooltip:"Fotoc\xf3pia da Identidade do propriet\xe1rio; no caso de pessoa jur\xeddica, fotoc\xf3pia do contrato social e de suas altera\xe7\xf5es."},{nameInput:"art",label:"ART com comprovante de pagamento",tooltip:"ART referente ao projeto com comprovante de pagamento"},{nameInput:"decConform",label:"Declara\xe7\xe3o de conformidade",tooltip:"Documento emitido pela Prefeitura Municipal declarando a conformidade do parcelamento com a legisla\xe7\xe3o municipal"},{nameInput:"daeAnuencia",label:"C\xf3pia do boleto e comprovante de pagamento da DAE",tooltip:"Clique para obter informa\xe7\xf5es sobre o c\xe1lculo e pagamento do Documento de Arrecada\xe7\xe3o Estadual (DAE)",tt:!0,link:!0},{nameInput:"memDescritivo",label:"Memorial descritivo",tooltip:"Descri\xe7\xe3o sucinta do loteamento com suas caracter\xedsticas, \xe1reas p\xfablicas, equipamentos etc. "},{nameInput:"memDescTp",label:"Memorial Descritivo do Projeto de Terraplenagem",tooltip:"O memorial dever\xe1 conter a determina\xe7\xe3o da inclina\xe7\xe3o dos taludes de corte e aterro e a caracteriza\xe7\xe3o do tipo de solo."},{nameInput:"cemig",label:"Certid\xe3o da Cemig",tooltip:"Cemig"},{nameInput:"dtbCopasa",label:"Diretriz T\xe9cnica B\xe1sica (Copasa)",tooltip:"O memorial dever\xe1 conter a determina\xe7\xe3o da inclina\xe7\xe3o dos taludes de corte e aterro e a caracteriza\xe7\xe3o do tipo de solo."},{nameInput:"licAmbental",label:"Certid\xe3o / Licen\xe7a ambiental",tooltip:"Insira aqui a certid\xe3o de licen\xe7a ambiental emitida pelo Estado ou pelo munic\xedpio, se for o caso.",tt:!0}],qe=[{nameInput:"levPlan",label:"Levantamento Planialtim\xe9trico",tooltip:"mesma escala do Projeto Urban\xedstico, em sistema de coordenadas UTM e com delimita\xe7\xe3o e confrontantes compat\xedveis com a descri\xe7\xe3o da Certid\xe3o de Registro do im\xf3vel"},{nameInput:"mapaIso",label:"Projeto Urban\xedstico com mapa de Isodeclividade",tooltip:"Mapa de isodeclividade com intervalos 0 a 30%, 30 a 47% e acima de 47%"},{nameInput:"projTer",label:"Projeto de Terraplenagem",tooltip:"Projeto na mesma escala do Projeto Urban\xedstico e em sistema de coordenadas UTM"},{nameInput:"projDren",label:"Projeto de Drenagem",tooltip:"Projeto na mesma escala do Projeto Urban\xedstico e em sistema de coordenadas UTM"},{nameInput:"projPdf",label:"Projetos em PDF (extens\xe3o zip)",tooltip:'Crie um arqivo extens\xe3o ".zip" contendo cada um dos projetos acima em PDF.',tt:"true"},{nameInput:"outros",label:"Outros documentos (somente se solicitado)",tooltip:"Caso sejam solicitados documentos adicionais, anexe aqui. "}],Ue=[{nameInput:"regImovel",label:"Registro do Im\xf3vel",tooltip:"Certid\xe3o de Registro do Im\xf3vel com negativa de \xf4nus, emitida em at\xe9 30 dias antes da entrada do processo na Prefeitura Municipal."},{nameInput:"CNDMun",label:"Certid\xe3o Negativa de tributos municipais",tooltip:"Certid\xe3o Negativa de tributos municipais."},{nameInput:"empRG",label:"Fotoc\xf3pia da Identidade do propriet\xe1rio",tooltip:"Fotoc\xf3pia da Identidade do propriet\xe1rio; no caso de pessoa jur\xeddica, fotoc\xf3pia do contrato social e de suas altera\xe7\xf5es."},{nameInput:"art",label:"ART com comprovante de pagamento",tooltip:"ART referente ao projeto com comprovante de pagamento"},{nameInput:"decConform",label:"Declara\xe7\xe3o de conformidade",tooltip:"Documento emitido pela Prefeitura Municipal declarando a conformidade do parcelamento com a legisla\xe7\xe3o municipal"},{nameInput:"daeAnuencia",label:"C\xf3pia do boleto e comprovante de pagamento da DAE",tooltip:"Clique para obter informa\xe7\xf5es sobre o c\xe1lculo e pagamento do Documento de Arrecada\xe7\xe3o Estadual (DAE)",tt:!0,link:!0},{nameInput:"memDescritivo",label:"Memorial descritivo",tooltip:"Descri\xe7\xe3o sucinta do loteamento com suas caracter\xedsticas, \xe1reas p\xfablicas, equipamentos etc. "},{label:"Delimita\xe7\xe3o da \xe1rea do empreendimento (em formato kml)",nameInput:"kml",tooltip:"O arquivo anexado n\xe3o dever\xe1 conter linhas e/ou pontos, apenas um pol\xedgono, em extens\xe3o kml",tt:!0}],Ve=[{nameInput:"projDesmemb",label:"Projeto de Desmembramento"},{nameInput:"projPdf",label:"Projetos em PDF (extens\xe3o zip)",tooltip:'Crie um arqivo extens\xe3o ".zip" contendo cada um dos projetos acima em PDF.',tt:"true"},{nameInput:"outros",label:"Outros documentos (somente se solicitado)",tooltip:"Caso sejam solicitados documentos adicionais, anexe aqui. "}],He=function(){var e=[];return Me.forEach(function(t){e.push(t)}),Be.forEach(function(t){e.push(t)}),qe.forEach(function(t){e.push(t)}),e.push({nameInput:"diretrizFile",label:"Diretrizes Metropolitanas"},{nameInput:"notaTecnica",label:"Nota T\xe9cnica"},{nameInput:"anuenciaFile",label:"Certid\xe3o de Anu\xeancia Metropolitana"},{nameInput:"projDesmemb",label:"Projeto de Desmembramento"}),e},We=function(e){return He().filter(function(t){return t.nameInput.match(e)})[0].label},Ge=function(e,t){var a;if((a=ze.filter(function(t){return t.name===e}).concat(Le.filter(function(t){return t.name===e})).concat(Te.filter(function(t){return t.name===e})))&&a.length>0)switch(t){case"div":return a[0].div;case"label":return a[0].label;default:return null}},Je=function(e){var t,a=e.empId,n=e.rtId,s=e.showEmp,i=e.showRt,o=e.close,l=e.empCollection,c=e.rtCollection,d="";return s&&l&&(d=l.filter(function(e){return e._id.match(a)}),t=Object.entries(d[0]).splice(2,9)),i&&c&&(d=c.filter(function(e){return e._id.match(n)}),t=Object.entries(d[0]).splice(2,2)),""!==d&&(s||i)?r.a.createElement("div",{className:"card z-depth-5",style:{position:"fixed",top:"30%",right:"33%",left:"33%",padding:"5px 0px 7px 20px",borderRadius:"15px",border:"1px solid #aaa"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"center"},r.a.createElement("h5",null,d[0].nome)),r.a.createElement("div",{className:"center"},r.a.createElement("h5",null,d[0].nomeRt))),r.a.createElement("div",{className:"row"},t.map(function(e,t){return r.a.createElement("div",{className:"col s12 m6",key:t},r.a.createElement("strong",null," ",Ge(e[0],"label"),": "),e[1]," ")})),r.a.createElement("div",{style:{position:"absolute",top:"0.4%",right:"0.4%"}},r.a.createElement(Ee,{close:o}))):null},Ye=je.munEmpreendimento.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}),Ke=De.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)}),Xe=function(e){return e.data.edit&&e.data.item?r.a.createElement("form",{onSubmit:e.submit,id:"".concat(e.data.select)},function(){if(e.data.edit&&e.data.item){var t=function(e,t){return e.splice(e.length-t,e.length),e},a=e.data.item,n=[];for(var s in a)n.push({key:s,value:a[s]});var i=n;return"emp"===e.data.select&&n.length>14&&(i=t(n,3)),"rt"===e.data.select&&n.length>5&&(i=t(n,3)),"rt"===e.data.select&&5===n.length&&(i=t(n,1)),"process"===e.data.select&&(i=n.filter(function(e){return["nProcess","nomeEmpreendimento","modalidade","area","munEmpreendimento","tecnico"].includes(e.key)})),r.a.createElement("div",null,i.map(function(t,a){return"_id"===t.key?void 0:"modalidade"===t.key?r.a.createElement("div",{className:"col s2",key:a+100},r.a.createElement(ue.Input,{name:"modalidade",type:"select",label:"Modalidade",defaultValue:e.data.item[t.key],onChange:e.change},Ke)):"munEmpreendimento"===t.key?r.a.createElement("div",{className:"col s4",key:a+200},r.a.createElement(ue.Input,{name:"munEmpreendimento",type:"select",label:"Munic\xedpio",defaultValue:e.data.item[t.key],onChange:e.change},Ye)):r.a.createElement("div",{key:a,className:"input-field col s3"},r.a.createElement("label",{className:"active"},t.key.replace(/\w/,function(e){return e.toUpperCase()})),r.a.createElement("input",{type:"text",className:"active",name:t.key,value:e.data.item[t.key],onChange:e.change}))}),"process"===e.data.select&&r.a.createElement("div",null,function(t,a){var n=e.redux,s=n.empCollection,i=n.rtCollection,o=s.filter(function(e){return e._id===t})[0],l=i.filter(function(e){return e._id===a})[0];return r.a.createElement("div",null,r.a.createElement(ue.Input,{name:"empId",type:"select",label:"Empreendedor",defaultValue:o.nome,onChange:e.change},r.a.createElement("option",{key:"0",value:o._id},o.nome),s.map(function(e,t){return r.a.createElement("option",{key:t,value:e._id},e.nome)})),r.a.createElement(ue.Input,{name:"rtId",type:"select",label:"Respons\xe1vel T\xe9cnico",defaultValue:l.nomeRt,onChange:e.change},r.a.createElement("option",{key:"0",value:l._id},l.nomeRt),i.map(function(e,t){return r.a.createElement("option",{key:t,value:e._id},e.nomeRt)})))}(e.data.item.empId,e.data.item.rtId)))}return null}()):null},Qe=(a(84),[["nomeEmpreendimento","Empreendimento"],["munEmpreendimento","Munic\xedpio"],["tecnico","T\xe9cnico"],["nProcess","N\xfamero do Processo"]].map(function(e,t){return r.a.createElement("option",{key:t,value:e[0]},e[1]," ")})),Ze=function(e){var t=e.search;return r.a.createElement("div",{className:"col s3",style:{paddingTop:"3px"}},r.a.createElement("div",{className:"col s11"},r.a.createElement("label",{htmlFor:"select"},"Filtrar por"),r.a.createElement("select",{className:"browser-default",name:"select",icon:"filter_list",label:"Filtrar busca",onChange:t},Qe)),r.a.createElement("div",{className:"col s1",style:{paddingTop:"30px"}},r.a.createElement("i",{className:"material-icons"},"search")))},$e=function(e){var t=e.edit,a=e.archieved,n=e.showArchieved,s=e.select,i=localStorage.getItem("role"),o="Visualize e busque por dados dos processos, interesados e RTs utilizando a barra de busca abaixo";return"rt"===i&&(o="Visualize e busque por dados dos processos utilizando a barra de busca abaixo"),r.a.createElement("div",null,r.a.createElement(xe,{title:"Acompanhar Processos",subtitle:o,color:e.color}),!1===t?r.a.createElement("div",{className:"row"},"rt"!==i&&r.a.createElement("div",{className:"col s12"},r.a.createElement("label",null,"Selecione o m\xe9todo de Busca"),r.a.createElement("br",null),r.a.createElement("select",{className:"browser-default",value:s,onChange:e.onSelect},r.a.createElement("option",{value:"",key:"1",label:"Selecionar"},"Selecionar "),r.a.createElement("option",{value:"emp",key:"2",label:"Empreendedor"},"Empreendedor "),r.a.createElement("option",{value:"rt",key:"3",label:"Respons\xe1vel T\xe9cnico"},"Respons\xe1vel T\xe9cnico "),r.a.createElement("option",{value:"process",key:"4",label:"Processo"},"Processo "))),r.a.createElement("div",{className:"col s12",style:{marginTop:"1%"}},r.a.createElement("div",{className:"process"===s?"col s9":"col s12"},r.a.createElement("form",null,r.a.createElement("label",{htmlFor:"search"},"Pesquisar"),r.a.createElement("input",{id:"search",value:e.search,onChange:e.change,type:"search",placeholder:"digite pelo menos 2 d\xedgitos para procurar"}))),"process"===s&&r.a.createElement(Ze,{search:e.change,lupa:!0}),"process"===s&&r.a.createElement("div",{className:"col s3",style:{position:"relative",left:"5%",marginTop:"3%"}},r.a.createElement("input",{id:"showArchieved",type:"checkbox",checked:!0===a,onChange:n}),r.a.createElement("label",{style:{fontSize:"0.9rem"},htmlFor:"showArchieved"},"Processos anu\xeddos/arquivados")))):r.a.createElement("h5",{style:{marginBottom:"40px"}},"Editar dados"))},et=function(e){var t,a=e.redux,n=e.emps,s=e.rts,i=e.process,o=e.empFields,l=e.rtFields,c=e.showRt,d=e.edit,m=e.deleteOne,u=e.data,p=e.fields,h=e.divConfig,f=e.color,v=e.empDetails,b=e.rtDetails,E=e.showInfo,g=e.clearLog,y=e.archieve,k=e.showMap,x=localStorage.getItem("role"),w=[],C=[];n&&n[0]&&!1===u.edit?(w=n,t=o,C=ze,h=["col s3","col s2","col s2","col s1","col s1","col s2"]):s&&s[0]&&!1===u.edit?(w=s,t=l,C=Le,h=["col s4","col s3","col s4"]):i&&i[0]&&!1===u.edit&&(w=i,t=p,C=Te);var N=[];if(C.length>0&&t.forEach(function(e){N.push(C.filter(function(t){return t.name===e})[0])}),w&&w[0])return r.a.createElement("div",{className:"z-depth-3",style:{padding:"0px 11px",borderRadius:"10px"}},r.a.createElement("div",{className:"row tableHeader",style:{backgroundColor:f,filter:"brightness(190%)",padding:"5px 0px"}},N.map(function(e,t){return"_id"!==e.name?r.a.createElement("div",{className:h[t],key:t}," ",e.label," "):void 0}),"process"===u.select?r.a.createElement("div",null,r.a.createElement("div",{className:"col s2"},"Interessado "),c?r.a.createElement("div",{className:"col s1"},"RT "):void 0):void 0,("admin"===x||"process"===u.select)&&r.a.createElement("div",{className:"col s1"},"Informa\xe7\xf5es")),w.map(function(e,n){var s,i,o=[],l=a.empCollection.filter(function(t){return t._id.match(e.empId)});for(var p in l)s={key:p,values:l[p]};for(var f in i=a.rtCollection.filter(function(t){return t._id.match(e.rtId)}))i={key:f,values:i[f]};for(var w in e)o.push({key:w,values:e[w]});var C=[];return t&&t.length>0&&t.map(function(e){return C.push(o.filter(function(t){return t.key===e})[0])}),r.a.createElement("div",{className:"row",key:n,style:{borderBottom:"1px dotted #bbb",paddingBottom:"1%"}},C.map(function(e,t){return e?!isNaN(Date.parse(e.values))&&String(e.values).length>15?r.a.createElement("div",{key:t,className:"col s1"},new Date(e.values).getDate(),"/",new Date(e.values).getMonth()+1,"/",new Date(e.values).getFullYear()):r.a.createElement("div",{key:t,className:h[t],style:{wordBreak:"break-word"}},e.values):r.a.createElement("div",{key:t,className:"col s2"}," ")}),"process"===u.select&&s&&s.values?r.a.createElement("div",{id:s.values._id,className:"col s2",style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:v},s.values.nome):r.a.createElement("div",{className:"col s2"},"  "),c&&"process"===u.select&&i&&i.values?r.a.createElement("div",{id:i.values._id,className:"col s1",style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:b},i.values.nomeRt):r.a.createElement("div",{className:"col s1"}," "),"process"===u.select?r.a.createElement("div",{className:"col s2",style:{display:"flex",justifyContent:"space-between",maxWidth:"95px",margin:"0 auto",padding:"0px 5px",height:"100%",verticalAlign:"middle",paddingLeft:"".concat("admin"!==x&&"3%")}},r.a.createElement(ge,{showInfo:E,clearLog:g,id:e._id}),r.a.createElement(ve,{edit:d,id:e._id,userRole:x}),r.a.createElement(ye,{archieve:y,id:e._id,userRole:x,archieved:u.archieved}),r.a.createElement(ke,{id:e._id,showMap:k}),r.a.createElement(fe,{delete:m,id:e._id,userRole:x})):r.a.createElement("div",{className:"col s2 right",style:{display:"flex",justifyContent:"space-around",maxWidth:"95px",margin:"0 auto",padding:"0px 5px",height:"100%",verticalAlign:"middle"}},r.a.createElement(ve,{edit:d,id:e._id,userRole:x}),r.a.createElement(fe,{delete:m,id:e._id,userRole:x})))}));var D="processo";return"emp"===u.select&&(D="empreendedor"),"rt"===u.select&&(D="respons\xe1vel t\xe9cnico"),u.edit?null:r.a.createElement("div",{style:{textAlign:"center",padding:"4% 0"}},r.a.createElement("strong",null,"Nenhum ",D," encontrado. Verifique se que seu processo foi cadastrado pela prefeitura."))},tt=function(e){return/\d/.test(e)?new Date(e).getDate()+"/"+(new Date(e).getMonth()+1)+"/"+new Date(e).getFullYear()+", "+new Date(e).getHours()+":"+(new Date(e).getMinutes()<10?"0"+new Date(e).getMinutes():new Date(e).getMinutes())+"h":e},at=function(e){return e>1024&&e<1048576?Math.round(e/1024)+" KB":e>=1048576&&e<1073741824?(e/1024/1024).toFixed(2)+" MB":e+" bytes"},nt=function(e,t,a){if(!0===e)return{position:"fixed",top:t[0],right:"15%",left:"15%",height:t[1],borderRadius:"15px",backgroundColor:"#fbfbfb",border:"2px solid #aaa",marginBottom:"25px",marginTop:"25px",overflowY:a||"auto",overflowX:"hidden",zIndex:1,padding:a||"2rem"}},rt=function(e,t){I()({url:"/api/download/".concat(e.target.id),method:"GET",responseType:"blob"}).then(function(e){var a=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",t),document.body.appendChild(n),n.click()}).catch(function(e){console.log(e),J(e)})},st=function(e){function t(){return Object(Y.a)(this,t),Object(X.a)(this,Object(Q.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentWillUnmount",value:function(){this.props.clearLog()}},{key:"render",value:function(){var e=this.props,t=e.process,a=e.index,n=e.clearLog,s=e.soloComponent,i=e.hideLog,o=t.processHistory[a];return r.a.createElement("div",{style:nt(s,["8%","85%"])},!0===s?r.a.createElement("div",{className:"row",style:{textAlign:"center"}},r.a.createElement("div",{style:{position:"absolute",top:"0.5%",right:"0.5%"}},r.a.createElement(Ee,{close:i}))):null,"Pend\xeancias para emiss\xe3o de diretrizes"===o.label||o.label.match("An\xe1lise")?r.a.createElement("div",null,r.a.createElement("h5",null,o.label)," ",r.a.createElement("hr",null)," ",r.a.createElement("br",null)):r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("h5",null," ",r.a.createElement("img",{alt:"",src:"/images/folderIcon2.jpg",style:{paddingLeft:"20px",marginRight:"20px"}})," Arquivos > ",t.nomeEmpreendimento," > ",o.label)),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6"},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/multipleFiles2.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Arquivo"))),r.a.createElement("div",{className:"col s3"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Data de Upload")),r.a.createElement("div",{className:"col s3"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Tamanho")))),"Pend\xeancias para emiss\xe3o de diretrizes"===o.label?r.a.createElement("div",null,o.pendencias):o.label.match("An\xe1lise")?r.a.createElement("div",{dangerouslySetInnerHTML:{__html:o.pendencias}}):o.files.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6"},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/genericFile.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("span",{id:e.id,style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:function(t){return rt(t,e.originalName)}},(a=e.fieldName,He().filter(function(e){return e.nameInput.match(a)})[0].label)))),r.a.createElement("div",{className:"col s3"},tt(e.uploadDate)),r.a.createElement("div",{className:"col s3"},at(e.fileSize))));var a}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s1 left",style:{marginTop:"1%"}},r.a.createElement("strong",null,r.a.createElement("i",{className:"material-icons",style:{marginTop:"10%",color:"teal",cursor:"pointer",border:"1px solid #bbb",borderRadius:"55%"},onClick:n}," arrow_back")))))}}]),t}(n.Component),it=function(e){var t=e.logDetails,a=e.index,n=e.process,s=e.showLog,i=e.clearLog,o=e.soloComponent,l=e.hideLog;return!1===t?r.a.createElement("div",{style:nt(o,["15%","70%"])},!0===o?r.a.createElement("div",{className:"row",style:{textAlign:"center"}},r.a.createElement("div",{style:{position:"absolute",top:"0.5%",right:"0.5%"}},r.a.createElement(Ee,{close:l})),r.a.createElement("h5",null,"Hist\xf3rico do Processo - ",n.nomeEmpreendimento)):null,r.a.createElement("div",{className:"row",style:{padding:"2% 0% 0% 3%",fontSize:"18px"}},r.a.createElement("div",{className:"col s12 m4"}," ",r.a.createElement("strong",null,"Status do processo")," "),r.a.createElement("div",{className:"col s12 m4 center"}," ",r.a.createElement("strong",null,"Usu\xe1rio")," "),r.a.createElement("div",{className:"col s12 m4 ",style:{paddingLeft:"9%",fontsize:"10px"}}," ",r.a.createElement("strong",null,"Data")," ")),n.processHistory.map(function(e,t){return r.a.createElement("div",{className:"row",key:t,style:{paddingLeft:"3%"}},"Processo cadastrado"===e.label||"Processo Arquivado"===e.label||"Processo Desarquivado"===e.label?r.a.createElement("div",null,r.a.createElement("div",{className:"col s12 m4"},e.label),r.a.createElement("div",{className:"col s12 m4 center"},e.user.nome||" "),r.a.createElement("div",{className:"col s12 m3 center"}," ",tt(e.createdAt))):r.a.createElement("div",null,r.a.createElement("div",{className:"col s12 m4"},r.a.createElement("span",{style:{textDecoration:"underline",cursor:"pointer",color:"blue"},id:t,onClick:s},e.label)),r.a.createElement("div",{className:"col s12 m4 center"},e.user.nome||" "),r.a.createElement("div",{className:"col s12 m3 center"}," ",tt(e.createdAt))))})):r.a.createElement(st,{process:n,index:a,clearLog:i,soloComponent:o,hideLog:l})},ot="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1DrDBUd6GNL2EIBCxK-K0OjkTny8kbuA&callback=initMap";var lt=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).renderMap=function(){!function(e){var t=window.document.createElement("script"),a=window.document.getElementsByTagName("script")[0];t.async=!0,t.defer=!0,t.src=e,t.id="mapScript",a.parentNode.insertBefore(t,a)}(ot),window.initMap=a.initMap},a.initMap=function(){var e=new window.google.maps.Map(document.getElementById("map"),{center:{lat:-19.917299,lng:-43.934559},zoom:10,mapTypeId:"hybrid",mapTypeControlOptions:{mapTypeIds:["roadmap","satellite","hybrid","terrain"]}}),t=a.props.polygon,n=new window.google.maps.Polygon({paths:t,strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35});n.setMap(e);var r=new window.google.maps.LatLngBounds;n.getPaths().forEach(function(t){t.forEach(function(t){r.extend(t),e.fitBounds(r)})})},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){this.renderMap()}},{key:"componentWillUnmount",value:function(){var e=window.document.getElementById("map");e.parentElement.removeChild(e);var t=window.document.getElementById("mapScript");t.parentElement.removeChild(t),window.google={}}},{key:"render",value:function(){return r.a.createElement("div",{style:nt(!0,["15%","70%"],"hidden")},r.a.createElement(Ee,{close:this.props.close}),r.a.createElement("div",{id:"map"}))}}]),t}(n.Component),ct=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={polygon:!1},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e,t=this,a=this.props.selectedProcess,n=null,r=(e="Desmembramento"===a.modalidade?a.processHistory.filter(function(e){return e.label.match("Entrada")}).filter(function(e){return e.files.find(function(e){return"kml"===e.fieldName})}):a.processHistory.filter(function(e){return"Diretrizes metropolitanas solicitadas"===e.label}).filter(function(e){return e.files.find(function(e){return"kml"===e.fieldName})})).length;e&&r>0&&(n=e[r-1].files.filter(function(e){return"kml"===e.fieldName})[0]),n&&n.contentType.match("kml")?I()({url:"/api/download/".concat(n.id),method:"GET",responseType:"blob"}).then(function(e){var a=new FileReader;a.readAsText(e.data),a.addEventListener("loadend",function(){var e=Object(W.a)(H.a.mark(function e(a){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:I.a.post("/api/run",{kml:a.srcElement.result}).then(function(e){t.setState(Object(h.a)({},t.state,{polygon:e.data}))});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}())}).catch(function(e){return console.log(e)}):this.setState({polygon:"Formato inv\xe1lido"})}},{key:"componentWillUnmount",value:function(){this.setState({polygon:!1})}},{key:"render",value:function(){var e=this.state.polygon,t=this.props.close;return e&&"object"===typeof e?r.a.createElement(lt,{polygon:e,close:t}):"boolean"===typeof e?r.a.createElement("span",null," "):r.a.createElement(ue.Modal,{header:"Formato de arquivo inv\xe1lido.",open:!0,onClick:t},r.a.createElement("p",{style:{textAlign:"justify",textJustify:"inter-word",marginTop:"1%"}},'Favor verificar se o arquivo foi anexado e seu formato/geometria s\xe3o v\xe1lidos. Na op\xe7\xe3o "Solicitar Diretrizes Metropolitanas", no item "Delimita\xe7\xe3o da gleba", deve ser anexado um arquivo de  extens\xe3o ',r.a.createElement("strong",null,r.a.createElement("i",null,"kml")),".",r.a.createElement("br",null)," ",r.a.createElement("br",null),"O arquivo deve conter ",r.a.createElement("strong",null,"um pol\xedgono"),". Para maiores informa\xe7\xf5es, entre em contato com a equipe da Ag\xeancia RMBH."))}}]),t}(n.Component),dt=function(e){function t(){var e;return Object(Y.a)(this,t),(e=Object(X.a)(this,Object(Q.a)(t).call(this))).state={search:"",select:"process",edit:!1,selectId:"",itemId:"",item:{},nome:"",setColor:"",showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:"",cgt:"",showInfo:"",process:"",logIndex:"",logDetails:!1,archieved:!1,map:!1,filter:"nomeEmpreendimento",processes:[]},e.handleSearchBar=function(t){var a=t.target,n=a.name,r=a.value;"select"===n?e.setState({filter:r}):e.setState({search:t.target.value})},e.handleSelect=function(t){e.setState(Object(h.a)({},e.state,{select:t.target.value}))},e.enableEdit=function(t){var a=[],n={};"emp"===e.state.select&&(a=e.props.cadastro.empCollection.filter(function(e){return e._id.match(t)}),n=Object.assign({},a)),"rt"===e.state.select&&(a=e.props.cadastro.rtCollection.filter(function(e){return e._id.match(t)}),n=Object.assign({},a)),"process"===e.state.select&&(a=e.props.cadastro.processCollection.filter(function(e){return e._id.match(t)}),n=Object.assign({},a)),e.setState(Object(h.a)({},e.state,{item:n[0],edit:!0}))},e.disableEdit=function(){e.props.disableEdit(),e.setState(Object(h.a)({},e.state,{edit:!1}))},e.editValue=function(t){if(e.state.item){var a=Object.assign({},e.state.item,Object(ce.a)({},t.target.name,t.target.value));e.setState(Object(h.a)({},e.state,{item:a}))}},e.showMap=function(){var t=Object(W.a)(H.a.mark(function t(a){var n,r;return H.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.props.cadastro.processCollection,r=n.filter(function(e){return e._id===a})[0],t.next=4,e.setState({selectedProcess:r});case 4:e.setState({map:!e.state.map});case 5:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}(),e.escFunction=function(t){27===t.keyCode&&(e.state.logDetails&&e.clearLog(),e.state.map?e.showMap():e.state.showInfo?e.hideLog():(e.state.showEmpDetails||e.state.showRtDetails)&&e.closeDetails())},e}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t,a,n,r,s;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.cadastro,a=t.empCollection,n=t.rtCollection,r=t.processCollection,"rt"!==localStorage.getItem("role")&&(n[0]||this.props.loadRtData()),a[0]||this.props.loadEmpData(),r[0]){e.next=9;break}return e.next=7,this.props.loadProcessData();case 7:e.next=10;break;case 9:case 10:s=this.props.cadastro.processCollection,this.setState({processes:s}),document.addEventListener("keydown",this.escFunction,!1);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"deleteHandler",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=this.state.select,!window.confirm("Excluir registro?")){e.next=7;break}return e.next=4,I.a.delete("/api/delete/item?id=".concat(t,"&el=").concat(a)).catch(function(e){return console.log(e)});case 4:"emp"===a&&this.props.loadEmpData(),"rt"===a&&this.props.loadRtData(),"process"===a&&this.props.loadProcessData();case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"saveEdit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.item||"process"===this.state.select){e.next=8;break}return a=this.state.select,e.next=4,I.a.put("/api/edit",{el:a,item:this.state.item}).then(this.setState({edit:!1})).catch(function(e){return alert(e)});case 4:"emp"===a&&this.props.loadEmpData(),"rt"===a&&this.props.loadRtData(),e.next=14;break;case 8:if(!this.state.item){e.next=14;break}return delete(n=Object.assign({},this.state.item)).processHistory,e.next=13,I.a.put("/api/editProcess",{item:n}).then(this.setState({edit:!1})).catch(function(e){return alert(e)});case 13:this.props.loadProcessData();case 14:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:""})}},{key:"showInfo",value:function(e){var t=this.props.cadastro.processCollection.filter(function(t){return t._id.match(e.target.id)});this.setState({showInfo:!0,process:t[0]})}},{key:"showLog",value:function(e){this.setState({logIndex:e.target.id,logDetails:!0})}},{key:"hideLog",value:function(){this.setState({logIndex:"",showInfo:!1})}},{key:"clearLog",value:function(){this.setState({logDetails:!1,logIndex:""})}},{key:"showArchieved",value:function(){this.setState({archieved:!this.state.archieved})}},{key:"archieve",value:function(){var e=Object(W.a)(H.a.mark(function e(t,a){var n,r,s,i,o,l,c,d;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.cadastro.processCollection,r=Object(h.a)({},localStorage),s={nome:r.name+" "+r.surName,email:r.email},i={item:{_id:t},processHistory:{createdAt:new Date,user:s}},a?(o=n.filter(function(e){return e._id.match(t)})[0],l=o.processHistory,c=(c=l.filter(function(e){return"Processo Arquivado"!==e.label}).filter(function(e){return"Processo Desarquivado"!==e.label}))[c.length-1],((d=c.label).match("Processo cadastrado")||d.match("An\xe1lise "))&&o.modalidade.match("Desmembramento")&&(d="Aguardando documenta\xe7\xe3o"),(d.match("Entrada")||d.match("Anu\xeancia pr\xe9via solicitada"))&&(d="Aguardando An\xe1lise"),d.match("An\xe1lise ")&&(d="Diretrizes Metropolitanas emitidas"),d.match("Diretrizes metropolitanas solicitadas")&&(d="Aguardando Diretrizes Metropolitanas"),d.match("Pend\xeancias para")&&(d="Processo cadastrado"),i.item.status=d,i.processHistory.label="Processo Desarquivado"):(i.item.status="Processo Arquivado",i.processHistory.label="Processo Arquivado"),e.next=7,I.a.put("/api/editProcess/",i).catch(function(e){return console.log(e)});case 7:this.props.loadProcessData();case 8:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=[],a=[],n=[],s=[],i=this.state,o=i.search,l=i.select,c=i.archieved,d=i.selectedProcess,m=i.kml,u=i.map,p=i.processes,h=i.filter,f=o.trim().toLowerCase(),v=this.props.cadastro,b=v.empCollection,E=v.rtCollection;return o&&o.length>1&&"emp"===l&&b?t=b.filter(function(e){return e.nome.toLowerCase().match(f)}).slice(0,20):(!o||o.length<=2)&&"emp"===l&&(t=b.slice(0,30)),o&&o.length>1&&"rt"===l&&E?a=E.filter(function(e){return e.nomeRt.toLowerCase().match(f)}).slice(0,20):(!o||o.length<=2)&&"rt"===l&&(a=E.slice(0,30)),o&&o.length>1&&"process"===l&&p?(s=p.filter(function(e){return"Processo Anu\xeddo"===e.status||"Processo Arquivado"===e.status}),n=!0===c?s.filter(function(e){return e[h].toLowerCase().match(f)}).slice(0,20):p.filter(function(e){return"Processo Arquivado"!==e.status}).filter(function(e){return"Processo Anu\xeddo"!==e.status}).filter(function(e){return e[h].toLowerCase().match(f)}).slice(0,20)):(!o||o.length<=1)&&"process"===l&&(s=p.filter(function(e){return"Processo Anu\xeddo"===e.status||"Processo Arquivado"===e.status}),(n=!0===c?s:p.filter(function(e){return"Processo Arquivado"!==e.status}).filter(function(e){return"Processo Anu\xeddo"!==e.status}).slice(0,50)).sort(function(e,t){var a=new Date(e.updatedAt),n=new Date(t.updatedAt);return a&&n?n.getTime()>a.getTime()?1:a.getTime()>n.getTime()?-1:0:null})),r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement($e,{search:o,select:l,edit:this.state.edit,redux:this.props.cadastro,onSelect:this.handleSelect,change:this.handleSearchBar,color:this.props.cadastro.setColor,archieved:this.state.archieved,showArchieved:this.showArchieved.bind(this)}),this.state.showInfo?r.a.createElement("div",null,r.a.createElement(it,{process:this.state.process,logDetails:this.state.logDetails,index:this.state.logIndex,showLog:this.showLog.bind(this),hideLog:this.hideLog.bind(this),clearLog:this.clearLog.bind(this),soloComponent:!0})):null,r.a.createElement("div",null,r.a.createElement(et,{data:this.state,redux:this.props.cadastro,emps:t,rts:a,process:n,empFields:["nome","cpf","rua","cidade","phone","email"],rtFields:["nomeRt","emailRt","phoneRt"],showRt:!1,fields:["nProcess","nomeEmpreendimento","modalidade","area","munEmpreendimento","status","tecnico","updatedAt"],divConfig:["col s1","col s2","col s1","col s1","col s1","col s1","col s1","col s1"],edit:this.enableEdit.bind(this),deleteOne:this.deleteHandler.bind(this),color:this.props.cadastro.setColor,empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),showInfo:this.showInfo.bind(this),clearLog:this.clearLog.bind(this),archieve:this.archieve.bind(this),kml:m,showMap:this.showMap,map:this.state.map}),u&&r.a.createElement(ct,{close:this.showMap,selectedProcess:d}),r.a.createElement(Xe,{redux:this.props.cadastro,data:this.state,disableEdit:this.disableEdit.bind(this),change:function(t){return e.editValue(t)},submit:function(t){return e.saveEdit(t)}})),r.a.createElement("div",null,this.state.edit?r.a.createElement(he,{onClick:this.disableEdit,icon:"arrow_back"}):null,r.a.createElement(be,{form:"".concat(l),display:this.state.edit}),r.a.createElement(Je,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.cadastro.empCollection,rtCollection:this.props.cadastro.rtCollection})))}}]),t}(n.Component);var mt=Object(l.connect)(function(e){return{cadastro:e.cadastro}},function(e){return Object(o.b)({loadEmpData:_,loadRtData:T,loadProcessData:M,handleEdit:Fe,disableEdit:Re,changeHandler:_e,reduxToastr:q},e)})(dt),ut=function(e,t){return e.sort(function(e,a){return e&&a?"area"===t?(e[t]=Number(e[t]),a[t]=Number(a[t]),e[t]>a[t]?1:e[t]<a[t]?-1:null):e[t].toLowerCase()>a[t].toLowerCase()?1:e[t].toLowerCase()<a[t].toLowerCase()?-1:0:null})},pt=function(e){var t=e.stylez,a=e.onClick,n=e.div||"col s1";return e.cond?r.a.createElement("div",{className:n,style:t,onClick:a},e.value||e.children):null},ht=function(e){var t=e.search,a=e.collection,n=e.rtCollection,s=e.processCollection,i=e.onSelect,o=e.checked,l=e.fields,c=e.color,d=e.renderEmp,m=e.renderRt,u=e.empDetails,p=e.rtDetails,h=e.showFiles,f=e.ocultarArquivos,v=e.sort,b=[];if(s&&s[0]){for(var E in s)s[E].solDirFiles&&s[E].solDirFiles.length>0&&b.push(s[E].solDirFiles);b[0]}var g=[];return l.forEach(function(e){g.push(Te.filter(function(t){return t.name===e})[0])}),r.a.createElement("div",null,t.length>0?r.a.createElement("div",{className:"row tableHeader",style:{backgroundColor:c}},g.map(function(e,t){return r.a.createElement(pt,{cond:"_id"!==e.name,value:e.label,div:e.div,key:t,stylez:{cursor:"pointer"},onClick:function(){return v(e.name)}})}),r.a.createElement(pt,{cond:d,value:"Interessado",div:"col s2"}),r.a.createElement(pt,{cond:m,value:"RT"}),r.a.createElement(pt,{cond:!f,value:"Arquivos"}),r.a.createElement("div",{className:"col s1"},"Selecionar")):null,t.length>0?t.map(function(e,t){var s=[],c=a.filter(function(t){return t._id.match(e.empId)})[0],v=n.filter(function(t){return t._id.match(e.rtId)})[0];for(var b in e)s.push({key:b,values:e[b]});var E=[];return l&&l.length>0&&l.map(function(e){return E.push(s.filter(function(t){return t.key===e})[0])}),r.a.createElement("div",{className:"row",key:t},E.map(function(e,t){return"_id"!==e.key?!isNaN(Date.parse(e.values))&&String(e.values).length>15?r.a.createElement("div",{key:t,className:Ge(e.key,"div")},new Date(e.values).getDate(),"/",new Date(e.values).getMonth()+1,"/",new Date(e.values).getFullYear()):r.a.createElement("div",{key:t,className:Ge(e.key,"div"),style:{wordBreak:"break-word"}},e.values):null}),c?r.a.createElement(pt,{cond:[c,d],div:"col s2"},r.a.createElement("span",{id:c._id,className:"link",onClick:u},c.nome)):r.a.createElement("div",{className:"col s1"}," "),v?r.a.createElement(pt,{cond:[v,m],div:"col s1"},r.a.createElement("span",{id:v._id,className:"link",onClick:p},v.nomeRt)):r.a.createElement("div",{className:"col s1"}," "),r.a.createElement(pt,{cond:!f,div:"col s1"},r.a.createElement("span",{id:"".concat(e._id,"z"),className:"link",onClick:h},"Ver arquivos")),r.a.createElement("div",{className:"col s1 center"},r.a.createElement("input",{id:e._id,type:"radio",name:"group1",onClick:i,value:E.map(function(e){return"_id"===e.key?"".concat(e.values):void 0}),defaultChecked:o===e._id}),r.a.createElement("label",{htmlFor:e._id}," ")))}):r.a.createElement("div",{style:{textAlign:"center",padding:"4% 0"}},r.a.createElement("strong",null,"Nenhum processo encontrado.")))},ft=function(e){var t,a=e.setColor,n=e.search,s=e.searchArray,i=e.selectProcess,o=e.submitFiles,l=e.data,c=e.redux,d=e.children,m=e.empDetails,u=e.rtDetails,p=e.sort,h=e.reverse;return l.selectedId&&(t=c.processCollection.filter(function(e){return e._id.match(l.selectedId)})),r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement(xe,{title:"Solicitar Diretrizes Metropolitanas",subtitle:'Para solicitar diretrizes metropolitanas, selecione o processo na lista abaixo, \r fa\xe7a o upload dos documentos necess\xe1rios em pdf e clique em "Solicitar Diretrizes".',color:a}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s9"},r.a.createElement("label",null,"Pesquisar"),r.a.createElement("input",{className:"input",type:"text",name:"search",onChange:n})),r.a.createElement(Ze,{search:n})),r.a.createElement("div",{className:"z-depth-3",style:{padding:"0px 10px 1px",borderRadius:"10px"}},r.a.createElement(ht,{search:s,collection:c.empCollection,rtCollection:c.rtCollection,onSelect:i,checked:l.checked,color:a,fields:["_id","nProcess","nomeEmpreendimento","modalidade","area","munEmpreendimento","status","tecnico"],renderEmp:!0,renderRt:!0,empDetails:m,rtDetails:u,ocultarArquivos:!0,sort:p,reverse:h})),r.a.createElement("div",{className:"row",style:{marginTop:"15px"}},r.a.createElement("div",{className:"col s1 right"},r.a.createElement(he,{disabled:null===l.checked,icon:"clear",onClick:e.clear}))),r.a.createElement("div",null,l.selectedId&&l.checked?r.a.createElement("div",null,r.a.createElement("fieldset",null,r.a.createElement("legend",null,t[0].nomeEmpreendimento," - Documentos para solicita\xe7\xe3o de diretrizes"),d),r.a.createElement("button",{className:"btn teal darken-3 right",style:{marginBottom:"20px"},onClick:o},"Solicitar Diretrizes")):void 0))},vt=a(54),bt=a.n(vt),Et=function(e){var t=e.object,a=t.tooltip,n=t.tt,s=t.link;return r.a.createElement("div",{className:"row",style:{padding:"10px",paddingLeft:"20px",paddingRight:"20px",margin:0}},r.a.createElement("label",{style:{fontSize:"16px",paddingTop:"15px",fontWeight:450,color:"black"}},e.object.label),n&&r.a.createElement("i",{style:{marginLeft:"9px",color:"#42a5f5",fontSize:"1.2rem",cursor:s?"pointer":"default"},className:"material-icons",onClick:function(){return function(e){e&&window.open("http://www.agenciarmbh.mg.gov.br/anuencia-previa-2/#1544200696367-a39f6fa0-7d0c","_blank")}(s)},"data-tip":a}," help_outline "),r.a.createElement(bt.a,null),r.a.createElement("div",{className:"row file-field input-field",key:e.object.nameInput},r.a.createElement("div",{className:"file-path-wrapper row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("input",{className:"file-path validate",type:"text",placeholder:"Carregar arquivo"})),r.a.createElement("div",{className:"col s1 right"},r.a.createElement("i",{className:"material-icons grey-text text-darken-1 small"},"attach_file"),r.a.createElement("input",{type:"file",name:e.object.nameInput,onChange:e.upload})))))},gt=function(e){function t(){var e;return Object(Y.a)(this,t),(e=Object(X.a)(this,Object(Q.a)(t).call(this))).state={searchValue:"",dataMatch:[],toggleUpload:!1,selectedId:"",checked:null,files:[],form:null,dirMunFile:"",levPlanFile:"",dirDaeFile:"",kml:"",showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:"",map:!1,filter:"nomeEmpreendimento"},e.sort=function(t){var a,n=e.state,r=n.reverse,s=n.processes;a=ut(s,t),!0===r&&a.reverse(),e.setState({processes:a,reverse:!r})},e.escFunction=function(t){var a=e.state,n=a.selectedId,r=a.showEmpDetails,s=a.showRtDetails,i=a.map;27===t.keyCode&&(i?e.showMap():r||s?e.closeDetails():n&&e.clearSearch())},e}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t,a,n,r,s,i;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.redux,a=t.empCollection,n=t.rtCollection,r=t.processCollection,s=t.tecCollection,a[0]||this.props.loadEmpData(),r[0]){e.next=7;break}return e.next=5,this.props.loadProcessData();case 5:e.next=8;break;case 7:case 8:n[0]||this.props.loadRtData(),s[0]||this.props.loadTecnicos(),this.props.loadFilesData(),i=this.props.redux.processCollection.filter(function(e){return"Processo cadastrado"===e.status}),this.setState({processes:i}),document.addEventListener("keydown",this.escFunction,!1);case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleSearch",value:function(e){var t=e.target,a=t.name,n=t.value;"select"===a?this.setState({filter:n}):(this.setState(Object(h.a)({},this.state,{searchValue:e.target.value,checked:!1})),document.getElementsByName("group1").forEach(function(e){return e.checked=!1}))}},{key:"clearSearch",value:function(e){this.setState(Object(h.a)({},this.state,{searchValue:"",checked:null})),document.getElementsByName("search")[0].value="",document.getElementsByName("group1").forEach(function(e){e.checked=!1})}},{key:"handleSelect",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState(Object(h.a)({},this.state,{selectedId:t.target.value.replace(/,/g,""),checked:t.currentTarget.id}));case 2:document.getElementById(this.state.checked).checked="checked",a=this.props.redux.processCollection.filter(function(e){return e._id===n.state.checked})[0],this.setState({selectedProcess:a});case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fileUpload",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target,n=a.name,r=a.files,"kml"===n&&r[0]&&"application/vnd.google-earth.kml+xml"!==r[0].type&&(document.getElementsByName(n)[0].value="",alert("Favor inserir a delimita\xe7\xe3o da gleba em formato kml.")),"kml"!==n&&"dirDaeFile"!==n||r[0]&&r[0].size>2097152&&(document.getElementsByName(n)[0].value="",alert("Arquivo excedeu o limite permitido (2MB)!")),"levPlanFile"!==n&&"dirMunFile"!==n||r[0]&&r[0].size>5242880&&(document.getElementsByName(n)[0].value="",alert("Arquivo excedeu o limite permitido (5MB)!")),(s=new FormData).append("processId",this.state.selectedId),this.setState(Object(h.a)({},this.state,Object(ce.a)({},n,r[0]))),i=[],e.next=10,Me.map(function(e){return i.push(e.nameInput)});case 10:return e.next=12,i.forEach(function(e){for(var t in o.state)t.match(e)&&s.append(e,o.state[t])});case 12:this.setState({form:s});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c,d,m,u,p,f,v,b,E,g,y,k,x=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.props.redux.processCollection.filter(function(e){return e._id.match(x.state.selectedId)})[0],n=this.props.redux.empCollection.filter(function(e){return e._id.match(a.empId)})[0],r=this.props.redux.rtCollection.filter(function(e){return e._id.match(a.rtId)})[0],s=Object(h.a)({},localStorage),i=a.modalidade,o=a.nomeEmpreendimento,l=a.munEmpreendimento,c=this.props.redux.tecCollection,d=this.state.form,m=c.filter(function(e){return e.municipios.some(function(e){return e===a.munEmpreendimento})})[0],u=[],p=[],f=0,!d){e.next=24;break}for(v=!0,b=!1,E=void 0,e.prev=8,g=d.entries()[Symbol.iterator]();!(v=(y=g.next()).done);v=!0)(k=y.value)[1]&&"undefined"!==k[1]&&(f+=1);e.next=16;break;case 12:e.prev=12,e.t0=e.catch(8),b=!0,E=e.t0;case 16:e.prev=16,e.prev=17,v||null==g.return||g.return();case 19:if(e.prev=19,!b){e.next=22;break}throw E;case 22:return e.finish(19);case 23:return e.finish(16);case 24:if(p=a.processHistory.filter(function(e){return"Pend\xeancias para emiss\xe3o de diretrizes"===e.label}),!(f>4||p.length>0)){e.next=52;break}return this.props.loading(!0),e.prev=27,e.next=30,I.a.post("/api/fileUpload",this.state.form).then(function(e){e.data.file.forEach(function(e){return u.push(e)})});case 30:return e.next=32,I.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:"Aguardando Diretrizes Metropolitanas",tecnico:m.name+" "+m.surName},processHistory:{label:"Diretrizes metropolitanas solicitadas",createdAt:new Date,files:u,user:{nome:s.name+" "+s.surName,email:s.email}}});case 32:return this.props.loading(!1),e.next=35,q("sucess","Diretrizes Metropolitanas solicitadas.");case 35:return e.next=37,me(n.email,r.emailRt,n.nome,i,o,l,"Diretrizes Metropolitanas solicitadas.");case 37:return e.next=39,this.clearSearch();case 39:return e.next=41,this.closeDetails();case 41:return e.next=43,this.setState({form:null});case 43:this.props.loadProcessData()&&this.props.loadFilesData(),e.next=50;break;case 46:e.prev=46,e.t1=e.catch(27),J(e.t1),console.log(e.t1);case 50:e.next=53;break;case 52:alert("Favor anexar todos os arquivos solicitados.");case 53:case"end":return e.stop()}},e,this,[[8,12,16,24],[17,,19,23],[27,46]])}));return function(t){return e.apply(this,arguments)}}()},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:""})}},{key:"render",value:function(){var e=this,t=this.state,a=t.dataMatch,n=t.reverse,s=t.processes,i=t.filter,o=[];s&&(o=s);var l=this.state.searchValue.toLowerCase();return a=o&&l&&!this.state.checked?o.filter(function(e){return e[i].toLowerCase().match(l)}):o&&(this.state.checked||this.state.checked&&l)?o.filter(function(t){return t._id.toLowerCase().match(e.state.selectedId)}):o,r.a.createElement("div",null,r.a.createElement(ft,{data:this.state,redux:this.props.redux,search:this.handleSearch.bind(this),searchArray:a,selectProcess:this.handleSelect.bind(this),submitFiles:this.handleSubmit.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),reverse:n,sort:this.sort},Me.map(function(t,a){return r.a.createElement(Et,{object:t,key:a,upload:e.fileUpload.bind(e),showMap:e.showMap})})),r.a.createElement(Je,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.redux.empCollection,rtCollection:this.props.redux.rtCollection}))}}]),t}(n.Component);var yt=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadEmpData:_,loadRtData:T,loadProcessData:M,loadFilesData:z,loadTecnicos:L,loading:U,setColor:B},e)})(gt),kt=a(39),xt=a(38),wt=a.n(xt),Ct=(a(206),a(110)),Nt=a.n(Ct),Dt=a(111),jt=a.n(Dt);function Ot(e,t,a){return function(){var n=Object(W.a)(H.a.mark(function n(r){return H.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,I.a.put("/api/editProcess/",{item:Object(ce.a)({_id:t},a,e)}).then(r(M()));case 3:n.next=9;break;case 5:n.prev=5,n.t0=n.catch(0),console.log(n.t0),r(J(!1));case 9:case"end":return n.stop()}},n,null,[[0,5]])}));return function(e){return n.apply(this,arguments)}}()}var St=function(e){var t,a=e.setColor,n=e.search,s=e.searchArray,i=e.selectProcess,o=e.submitFiles,l=e.data,c=e.redux,d=e.children,m=e.empDetails,u=e.rtDetails,p=e.showFiles,h=e.reverse,f=e.sort,v=e.tecFilter,b=e.filterTecs,E=localStorage.role;return l.selectedId&&(t=c.processCollection.filter(function(e){return e._id.match(l.selectedId)})),r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement(xe,{title:"Diretrizes Metropolitanas",subtitle:'Para a emiss\xe3o de diretrizes metropolitanas, selecione o processo, \r verifique os requisitos, fa\xe7a o upload da diretriz em pdf e clique em "Emitir Diretrizes".',color:a}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s9"},r.a.createElement("label",null,"Pesquisar"),r.a.createElement("input",{className:"input",type:"text",name:"search",onChange:n})),r.a.createElement(Ze,{search:n}),"tecnico"===E&&r.a.createElement("div",{className:"col s3 ",style:{position:"relative",left:"5%",float:"right",paddingTop:"2%"}},r.a.createElement("input",{id:"showArchieved",type:"checkbox",checked:!0===v,onChange:b}),r.a.createElement("label",{style:{fontSize:"0.9rem"},htmlFor:"showArchieved"},"Mostrar apenas meus processos"))),r.a.createElement("div",{className:"z-depth-3",style:{width:"100%",padding:"0px 10px 1px",borderRadius:"10px"}},r.a.createElement(ht,{search:s,collection:c.empCollection,rtCollection:c.rtCollection,processCollection:c.processCollection,onSelect:i,checked:l.checked,color:a,fields:["_id","nProcess","nomeEmpreendimento","munEmpreendimento","tecnico","cgt","vistoria"],renderEmp:!0,renderRt:!0,empDetails:m,rtDetails:u,showFiles:p,sort:f,reverse:h})),r.a.createElement("div",{className:"row",style:{marginTop:"15px"}},r.a.createElement("div",{className:"col s1 right"},r.a.createElement(he,{disabled:null===l.checked,icon:"clear",onClick:e.clear,showFiles:p}))),r.a.createElement("div",null,l.selectedId&&l.checked?r.a.createElement("div",null,r.a.createElement("fieldset",null,r.a.createElement("legend",null,t[0].nomeEmpreendimento," - Diretrizes Metropolitanas"),d)):null,l.anexaDiretriz?r.a.createElement("button",{className:"btn teal darken-3 right",type:"submit",onClick:o},"Emitir Diretrizes Metropolitanas"):null))},It=function(e){var t=e.processCollection,a=e.selectedId,n=e.checkItem,s=e.change,i=e.dirStatus,o=e.anexaDiretriz,l=e.enviaPendencias,c=e.showCalendar,d=t.filter(function(e){return e._id.match(a)})[0];return r.a.createElement("div",{className:"row col s12 fieldsetChild"},r.a.createElement("form",{action:"#"},[["CGT","cgt","cgtOk"],["Vistoria","vistoria","vistoriaOk"],["Diretriz Municipal","dirMunOk","dirMunOk"],["Pagamento da DAE","daeOk","daeOk"]].map(function(e,t){return r.a.createElement("div",{className:"row",key:t},r.a.createElement("input",{type:"checkbox",id:e[2],onClick:n}),r.a.createElement("label",{htmlFor:e[2],style:{color:"black",fontWeight:500}},e[0]),function(e){return"cgt"===e[1]||"vistoria"===e[1]?d[e[1]]===e[0]+" n\xe3o agendada"?r.a.createElement("span",null,r.a.createElement("strong",null,": "),r.a.createElement("span",{id:e[1],onClick:c,style:{textDecoration:"underline",cursor:"pointer",color:"blue"}},"Agendar ","".concat(e[0]))):r.a.createElement("span",null,r.a.createElement("strong",null,": "),r.a.createElement("span",null,tt(d[e[1]]),r.a.createElement("span",{style:{cursor:"pointer"}}," ",r.a.createElement("i",{id:e[1],onClick:c,title:"Reagendar ".concat(e[0]),className:"material-icons"},"calendar_today"),"  "))):r.a.createElement("span",null,d[e[1]])}(e))}),!1===o?r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"},r.a.createElement("label",{htmlFor:"pendText"},"Registrar pend\xeancias"),r.a.createElement("textarea",{className:"materialize-textarea",id:"pendText",onChange:s,value:i.pendencias}),r.a.createElement("button",{className:"btn red right",onClick:l},"Enviar Pend\xeancias"))):r.a.createElement("div",null,r.a.createElement("label",{style:{fontSize:"1.3rem",paddingTop:"3%",fontFamily:"Calibri",fontWeight:600,color:"black"}},"Anexar Diretriz Metropolitana"),r.a.createElement("div",{className:"row file-field input-field"},r.a.createElement("div",{className:"file-path-wrapper row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("input",{className:"file-path validate",type:"text",placeholder:"Carregar arquivo"})),r.a.createElement("div",{className:"col s1 right"},r.a.createElement("i",{className:"material-icons grey-text text-darken-1 small"},"attach_file"),r.a.createElement("input",{type:"file",name:"diretrizFile",onChange:e.upload})))))))},Pt=function(e){var t,a=e.showFiles,n=e.close,s=e.processCollection,i=e.selectedId,o=e.filesCollection,l=s.filter(function(e){return e._id.match(i)});return o&&o[0]&&(t=o.filter(function(e){return e.metadata.processId.match(i)})),a&&l&&l[0]&&t&&t[0]?r.a.createElement("div",{className:"container z-depth-3",style:{position:"fixed",top:"8%",right:"15%",left:"15%",height:"85%",borderRadius:"15px",backgroundColor:"#fbfbfb",padding:"15px 0px 0px 30px",border:"1px solid #ddd",marginBottom:"25px",marginTop:"25px",overflowY:"auto",overflowX:"hidden",zIndex:1}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"row"},r.a.createElement("h5",null,r.a.createElement("img",{alt:"",src:"/images/folderIcon2.jpg",style:{paddingLeft:"20px",marginRight:"20px"}}),"Arquivos > ",l[0].nomeEmpreendimento)),r.a.createElement("hr",{style:{marginBottom:"5px"}}),r.a.createElement("div",{className:"row",style:{marginBottom:0}},r.a.createElement("div",{className:"col s6"},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/multipleFiles2.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Arquivo"))),r.a.createElement("div",{className:"col s3"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Data de Upload")),r.a.createElement("div",{className:"col s3"},r.a.createElement("h6",{style:{fontSize:"1.2em",fontWeight:500}},"Tamanho"))),r.a.createElement("hr",{style:{margin:"0 0 20px 0"}}),t.map(function(e,t){return r.a.createElement("div",{key:t},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s6"},r.a.createElement("div",{className:"col s1"},r.a.createElement("img",{alt:"",src:"/images/genericFile.png"})),r.a.createElement("div",{className:"col s11"},r.a.createElement("span",{id:e._id,style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:function(t){return rt(t,e.filename?e.filename:e.metadata.originalName)}},We(e.metadata.fieldName)))),r.a.createElement("div",{className:"col s3"},tt(e.uploadDate)),r.a.createElement("div",{className:"col s3"},at(e.length))))})),r.a.createElement("div",{style:{position:"absolute",top:"0.5%",right:"0.5%"}},r.a.createElement(Ee,{close:n}))):a&&l&&l[0]&&t&&!t[0]?r.a.createElement("div",{className:"card",style:{position:"fixed",top:"30%",right:"33%",left:"33%",backgroundColor:"white",paddingLeft:"20px",borderRadius:"15px",padding:"15px 0px 0px 30px",border:"1px solid #ddd",marginBottom:"25px",marginTop:"25px"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"row"},r.a.createElement("h5",null,"Arquivos > ",l[0].nomeEmpreendimento)),r.a.createElement("div",{className:"col s6"},"Nenhum arquivo encontrado")),r.a.createElement("div",{style:{position:"absolute",top:"0%",right:"0%"}},r.a.createElement(Ee,{close:n}))):null},At=function(e){function t(){var e;return Object(Y.a)(this,t),(e=Object(X.a)(this,Object(Q.a)(t).call(this))).state={searchValue:"",dataMatch:[],selectedId:"",checked:null,files:[],form:null,diretrizFile:"",showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:"",showFiles:!1,filesCollection:"",daeDir:"",anexaDiretriz:!1,m:wt()(),cgtCalendar:!1,vistoriaCalendar:!1,dirStatus:{label:"Pend\xeancias na emiss\xe3o de Diretrizes",createdAt:"",cgtOk:!1,vistoriaOk:!1,daeOk:!1,dirMunOk:!1,pendencias:""},filter:"nomeEmpreendimento",tecFilter:!0},e.setDate=function(t){e.state.cgtCalendar?e.setState({m:t._d,cgt:t._d}):e.setState({m:t._d,vistoria:t._d})},e.renderInput=function(e,t,a){return e.style={marginBottom:"0px",backgroundColor:"#F8F8FF",fontWeight:500},e.className="center-align",r.a.createElement("div",null,r.a.createElement("i",{className:"material-icons right",style:{cursor:"pointer",color:"red"},onClick:a},"close"),r.a.createElement("i",{className:"material-icons",style:{cursor:"pointer",color:"gold"},onClick:function(){e.onChange({target:{value:""}})}},"backspace"),r.a.createElement("input",Object.assign({className:"red"},e)))},e.sort=function(t){var a,n=e.state,r=n.reverse,s=n.processes;a=ut(s,t),!0===r&&a.reverse(),e.setState({processes:a,reverse:!r})},e.filterTecs=Object(W.a)(H.a.mark(function t(){var a,n;return H.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.processes,n=Object(h.a)({},localStorage),t.next=4,e.setState({tecFilter:!e.state.tecFilter});case 4:e.state.tecFilter?(a=a.filter(function(e){return e.tecnico===n.name+" "+n.surName}),e.setState({processes:a})):(a=e.props.redux.processCollection.filter(function(e){return"Aguardando Diretrizes Metropolitanas"===e.status}),e.setState({processes:a}));case 5:case"end":return t.stop()}},t)})),e.escFunction=e.escFunction.bind(Object(kt.a)(Object(kt.a)(e))),e}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"escFunction",value:function(e){var t=this.state,a=t.cgtCalendar,n=t.vistoriaCalendar,r=t.selectedId,s=t.showEmpDetails,i=t.showRtDetails,o=t.showFiles;27===e.keyCode&&(s||i||o?this.closeDetails():a||n?this.hideCalendar():r&&this.clearSearch())}},{key:"componentDidMount",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t,a,n,r,s,i,o;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.redux,a=t.empCollection,n=t.rtCollection,r=t.processCollection,s=t.tecCollection,a[0]||this.props.loadEmpData(),r[0]){e.next=7;break}return e.next=5,this.props.loadProcessData();case 5:e.next=8;break;case 7:case 8:return n[0]||this.props.loadRtData(),s[0]||this.props.loadTecnicos(),this.props.loadFilesData(),i=Object(h.a)({},localStorage),o=this.props.redux.processCollection.filter(function(e){return"Aguardando Diretrizes Metropolitanas"===e.status}),"tecnico"===localStorage.role&&(o=o.filter(function(e){return e.tecnico===i.name+" "+i.surName})),e.next=16,this.setState({processes:o});case 16:document.addEventListener("keydown",this.escFunction,!1);case 17:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleSearch",value:function(e){var t=e.target,a=t.name,n=t.value;if("select"===a)this.setState({filter:n});else{var r=this.state.dirStatus;r.cgtOk=!1,r.vistoriaOk=!1,r.dirMunOk=!1,r.daeOk=!1,this.setState(Object(h.a)({},this.state,{searchValue:e.target.value,checked:!1,anexaDiretriz:!1,dirStatus:r})),document.getElementsByName("group1").forEach(function(e){return e.checked=!1})}}},{key:"clearSearch",value:function(e){var t=this.state.dirStatus;t.cgtOk=!1,t.vistoriaOk=!1,t.dirMunOk=!1,t.daeOk=!1,this.setState(Object(h.a)({},this.state,{searchValue:"",checked:null,dirStatus:t,anexaDiretriz:!1})),document.getElementsByName("search")[0].value="",document.getElementsByName("group1").forEach(function(e){e.checked=!1})}},{key:"handleSelect",value:function(){var e=Object(W.a)(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState(Object(h.a)({},this.state,{selectedId:t.target.value.replace(/,/g,""),checked:t.currentTarget.id}));case 2:document.getElementById(this.state.checked).checked="checked";case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fileUpload",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.target,n=a.name,(r=a.files)[0].size>4194304&&(document.getElementsByName(n)[0].value="",alert("Arquivo excedeu o limite permitido (4MB)!")),(s=new FormData).append("processId",this.state.selectedId),e.next=6,this.setState(Object(h.a)({},this.state,Object(ce.a)({},n,r[0])));case 6:return e.next=8,s.append("diretrizFile",this.state.diretrizFile);case 8:this.setState({form:s});case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c,d,m,u=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a="Diretrizes Metropolitanas emitidas",n=this.props.redux.processCollection.filter(function(e){return e._id.match(u.state.selectedId)})[0],r=this.props.redux.empCollection.filter(function(e){return e._id.match(n.empId)})[0],s=this.props.redux.rtCollection.filter(function(e){return e._id.match(n.rtId)})[0],i=Object(h.a)({},localStorage),o=n.modalidade,l=n.nomeEmpreendimento,c=n.munEmpreendimento,d=this.state.form,m=[],!d){e.next=34;break}return this.props.loading(!0),e.prev=10,e.next=13,I.a.post("/api/fileUpload",this.state.form).then(function(e){e.data.file.forEach(function(e){return m.push(e)})});case 13:return e.next=15,I.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:a,tecnico:i.name+" "+i.surName},processHistory:{label:a,createdAt:new Date,files:m,user:{nome:i.name+" "+i.surName,email:i.email}}});case 15:return this.props.loading(!1),e.next=18,q("sucess",a);case 18:return e.next=20,me(r.email,s.emailRt,r.nome,o,l,c,a+".");case 20:return e.next=22,this.clearSearch();case 22:return e.next=24,this.closeDetails();case 24:return e.next=26,this.setState({form:null});case 26:this.props.loadProcessData()&&this.props.loadFilesData(),e.next=32;break;case 29:e.prev=29,e.t0=e.catch(10),J(e.t0);case 32:e.next=35;break;case 34:alert("Favor inserir a diretriz metropolitana.");case 35:case"end":return e.stop()}},e,this,[[10,29]])}));return function(t){return e.apply(this,arguments)}}()},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({showEmpDetails:!1,showRtDetails:!1,showFiles:!1,empId:"",rtId:""})}},{key:"showFiles",value:function(e){this.setState({showFiles:!0,selectedId:e.target.id.replace(/z/g,"")})}},{key:"checkItem",value:function(e){var t=e.target.id,a=this.state.dirStatus;a[t]=!this.state.dirStatus[t];var n=a.cgtOk,r=a.vistoriaOk,s=a.daeOk,i=a.dirMunOk;!0===n&&!0===r&&!0===i&&!0===s?this.setState({anexaDiretriz:!0}):this.setState({anexaDiretriz:!1})}},{key:"handleChange",value:function(e){var t=e.target.value,a=this.state.dirStatus;a.pendencias=t,this.setState({dirStatus:a})}},{key:"enviaPendencias",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c,d,m=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.props.redux.processCollection.filter(function(e){return e._id.match(m.state.selectedId)})[0],n=this.props.redux.empCollection.filter(function(e){return e._id.match(a.empId)})[0],r=this.props.redux.rtCollection.filter(function(e){return e._id.match(a.rtId)})[0],s=a.modalidade,i=a.nomeEmpreendimento,o=a.munEmpreendimento,l=Object(h.a)({},localStorage),c="Pend\xeancias para emiss\xe3o de Diretrizes Metropolitanas.",d=this.state.dirStatus,this.props.loading(!0),e.prev=9,e.next=12,I.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:"Processo cadastrado",tecnico:l.name+" "+l.surName},processHistory:{label:"Pend\xeancias para emiss\xe3o de diretrizes",createdAt:new Date,pendencias:d.pendencias,dirCheckList:{cgtOk:d.cgtOk,vistoriaOk:d.vistoriaOk,daeOk:d.daeOk,dirMunOk:d.dirMunOk},user:{nome:l.name+" "+l.surName,email:l.email}}});case 12:return e.next=14,this.props.loading(!1);case 14:return e.next=16,q("sucess",c);case 16:return e.next=18,me(n.email,r.emailRt,n.nome,s,i,o,c);case 18:return e.next=20,this.clearSearch();case 20:return e.next=22,this.closeDetails();case 22:this.props.loadProcessData(),e.next=28;break;case 25:e.prev=25,e.t0=e.catch(9),J(e.t0);case 28:case"end":return e.stop()}},e,this,[[9,25]])}));return function(t){return e.apply(this,arguments)}}()},{key:"showCalendar",value:function(e){this.setState(Object(h.a)({},this.state,Object(ce.a)({},"".concat(e.target.id,"Calendar"),!0)))}},{key:"hideCalendar",value:function(e){var t;t=this.state.cgtCalendar?"cgt":"vistoria",this.setState(Object(h.a)({},this.state,Object(ce.a)({},"".concat(t,"Calendar"),!1))),this.props.setDate(this.state.m,this.state.selectedId,t)}},{key:"render",value:function(){var e=this,t=this.state,a=t.dataMatch,n=t.filter,s=t.reverse,i=t.processes,o=t.tecFilter,l=this.state.searchValue.toLowerCase(),c=[];return i&&(c=i),a=l&&!this.state.checked?c.filter(function(e){return e[n].toLowerCase().match(l)}):this.state.checked||this.state.checked&&l?c.filter(function(t){return t._id.toLowerCase().match(e.state.selectedId)}):c,r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(St,{data:this.state,redux:this.props.redux,search:function(t){return e.handleSearch(t)},searchArray:a,selectProcess:this.handleSelect.bind(this),submitFiles:this.handleSubmit.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),showFiles:this.showFiles.bind(this),reverse:s,sort:this.sort,tecFilter:o,filterTecs:this.filterTecs},r.a.createElement(It,{selectedId:this.state.selectedId,showFiles:this.state.showFiles,checkItem:this.checkItem.bind(this),close:this.closeDetails.bind(this),processCollection:this.props.redux.processCollection,filesCollection:this.props.redux.filesCollection,upload:this.fileUpload.bind(this),dirStatus:this.state.dirStatus,change:this.handleChange.bind(this),enviaPendencias:this.enviaPendencias.bind(this),anexaDiretriz:this.state.anexaDiretriz,showCalendar:this.showCalendar.bind(this),cgtCalendar:this.state.cgtCalendar,vistoriaCalendar:this.state.vistoriaCalendar})),this.state.cgtCalendar||this.state.vistoriaCalendar?r.a.createElement("div",{style:{position:"fixed",top:"20%",right:"43%",width:"253px",border:"2px solid #ddd",backgroundColor:"white"}},r.a.createElement(Nt.a,{renderInput:this.renderInput,className:jt.a,input:!0,open:!0,inputProps:{readOnly:!0},value:this.state.m,onChange:this.setDate.bind(this),onBlur:this.hideCalendar.bind(this)})):void 0,r.a.createElement(Je,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.redux.empCollection,rtCollection:this.props.redux.rtCollection})),r.a.createElement("div",null,r.a.createElement(Pt,{selectedId:this.state.selectedId,showFiles:this.state.showFiles,close:this.closeDetails.bind(this),processCollection:this.props.redux.processCollection,filesCollection:this.props.redux.filesCollection})))}}]),t}(n.Component);var Rt=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadEmpData:_,loadRtData:T,loadProcessData:M,loadTecnicos:L,loadFilesData:z,loading:U,setColor:B,setDate:Ot},e)})(At),Ft=function(e){var t,a=e.setColor,n=e.search,s=e.searchArray,i=e.selectProcess,o=e.submitFiles,l=e.data,c=e.redux,d=e.children,m=e.empDetails,u=e.rtDetails,p=e.showFiles,h=e.sort;return l.selectedId&&(t=c.processCollection.filter(function(e){return e._id.match(l.selectedId)})),r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement(xe,{title:"Solicitar Anu\xeancia Pr\xe9via",subtitle:'Para solicitar anu\xeancia pr\xe9via, selecione o processo, fa\xe7a o upload dos documentos \r e projetos e clique em "Solicitar Anu\xeancia".',color:a}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s9"},r.a.createElement("label",null,"Pesquisar"),r.a.createElement("input",{className:"input",type:"text",name:"search",onChange:n})),r.a.createElement(Ze,{search:n})),r.a.createElement("div",{className:"z-depth-3",style:{padding:"0px 10px 1px",borderRadius:"10px"}},r.a.createElement(ht,{search:s,collection:c.empCollection,rtCollection:c.rtCollection,onSelect:i,checked:l.checked,color:a,fields:["_id","nProcess","nomeEmpreendimento","modalidade","munEmpreendimento","status","tecnico"],renderEmp:!0,renderRt:!0,empDetails:m,rtDetails:u,showFiles:p,sort:h})),r.a.createElement("div",{className:"row",style:{marginTop:"15px"}},r.a.createElement("div",{className:"col s1 right"},r.a.createElement(he,{disabled:null===l.checked,icon:"clear",onClick:e.clear}))),r.a.createElement("div",null,l.selectedId&&l.checked?r.a.createElement("div",null,r.a.createElement("fieldset",null,r.a.createElement("legend",{style:{fontSize:"1.3rem"}},t[0].nomeEmpreendimento," - Documentos para solicita\xe7\xe3o de anu\xeancia pr\xe9via"),r.a.createElement("div",{className:"row"},d[0])),r.a.createElement("fieldset",null,r.a.createElement("legend",{style:{fontSize:"1.3rem"}},t[0].nomeEmpreendimento," - Projetos para solicita\xe7\xe3o de anu\xeancia pr\xe9via"),r.a.createElement("div",{className:"row"},d[1])),r.a.createElement("button",{className:"btn teal darken-3 right",style:{marginBottom:"20px"},onClick:o},"Solicitar Anu\xeancia")):null))},_t=function(e){var t=e.object,a=t.label,n=t.nameInput,s=t.tooltip,i=t.tt,o=t.link;return r.a.createElement("div",{style:{padding:"10px",paddingLeft:"20px",paddingRight:"20px",margin:0}},r.a.createElement("label",{style:{fontSize:"16px",paddingTop:"15px",fontWeight:450,color:"black"}},a),i&&r.a.createElement("i",{style:{marginLeft:"9px",color:"#42a5f5",fontSize:"1.2rem",cursor:o?"pointer":"default"},className:"material-icons",onClick:function(){return function(e){e&&window.open("http://www.agenciarmbh.mg.gov.br/anuencia-previa-2/#1544200696367-a39f6fa0-7d0c","_blank")}(o)},"data-tip":s}," help_outline "),r.a.createElement(bt.a,null),r.a.createElement("div",{className:"file-field input-field",key:n},r.a.createElement("div",{className:"file-path-wrapper"},r.a.createElement("div",{className:"col s11"},r.a.createElement("input",{className:"file-path validate",type:"text",placeholder:"Carregar arquivo"})),r.a.createElement("div",{className:"col s1 right"},r.a.createElement("i",{className:"material-icons grey-text text-darken-1 small"},"attach_file"),r.a.createElement("input",{type:"file",name:n,onChange:e.upload})))))},Tt=function(e){function t(){var e;return Object(Y.a)(this,t),(e=Object(X.a)(this,Object(Q.a)(t).call(this))).state={searchValue:"",dataMatch:[],selectedId:"",checked:null,files:[],form:null,showEmpDetails:!1,showRtDetails:!1,showFiles:!1,empId:"",rtId:"",regImovel:"",CNDMun:"",empRG:"",art:"",decConform:"",daeAnuencia:"",memDescritivo:"",kml:"",memDescTp:"",cemig:"",dtbCopasa:"",licAmbental:"",levPlan:"",projUrb:"",mapaIso:"",projTer:"",projDren:"",projDesmemb:"",filter:"nomeEmpreendimento"},e.sort=function(t){var a,n=e.state,r=n.reverse,s=n.processes;a=ut(s,t),!0===r&&a.reverse(),e.setState({processes:a,reverse:!r})},e.escFunction=function(t){var a=e.state,n=a.selectedId,r=a.showEmpDetails,s=a.showRtDetails,i=a.showFiles;27===t.keyCode&&(r||s||i?e.closeDetails():n&&e.clearSearch())},e}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.redux.empCollection[0]||this.props.loadEmpData(),this.props.redux.processCollection[0]){e.next=6;break}return e.next=4,this.props.loadProcessData();case 4:e.next=7;break;case 6:case 7:this.props.redux.rtCollection[0]||this.props.loadRtData(),this.props.redux.filesCollection[0]||this.props.loadFilesData(),t=this.props.redux.processCollection.filter(function(e){return"Diretrizes Metropolitanas emitidas"===e.status||e.status.match("Pend\xeancias")||"Aguardando documenta\xe7\xe3o"===e.status}),this.setState({processes:t}),document.addEventListener("keydown",this.escFunction,!1);case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleSearch",value:function(e){var t=e.target,a=t.name,n=t.value;"select"===a?this.setState({filter:n}):(this.setState(Object(h.a)({},this.state,{searchValue:e.target.value,checked:!1})),document.getElementsByName("group1").forEach(function(e){return e.checked=!1}))}},{key:"clearSearch",value:function(e){this.setState(Object(h.a)({},this.state,{searchValue:"",checked:null})),document.getElementsByName("search")[0].value="",document.getElementsByName("group1").forEach(function(e){e.checked=!1})}},{key:"handleSelect",value:function(){var e=Object(W.a)(H.a.mark(function e(t){return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState(Object(h.a)({},this.state,{selectedId:t.target.value.replace(/,/g,""),checked:t.currentTarget.id}));case 2:document.getElementById(this.state.checked).checked="checked";case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"fileUpload",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c,d,m,u=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=["levPlan","mapaIso","outros","projPdf"],n=["projTer","projDren"],r=t.target,s=r.name,i=r.files,o=a.some(function(e){return e===s}),l=n.some(function(e){return e===s}),o&&i[0]&&i[0].size>6291456&&(document.getElementsByName(s)[0].value="",alert("Arquivo excedeu o limite permitido (6MB)!")),l&&i[0]&&i[0].size>10485760?(document.getElementsByName(s)[0].value="",alert("Arquivo excedeu o limite permitido (10MB)!")):!o&&!l&&i[0]&&i[0].size>2097152&&(document.getElementsByName(s)[0].value="",alert("Arquivo excedeu o limite permitido (2MB)!")),"kml"===s&&i[0]&&"application/vnd.google-earth.kml+xml"!==i[0].type&&(document.getElementsByName(s)[0].value="",alert("Favor inserir a delimita\xe7\xe3o da gleba em formato kml.")),"kml"!==s&&"dirDaeFile"!==s||i[0]&&i[0].size>2097152&&(document.getElementsByName(s)[0].value="",alert("Arquivo excedeu o limite permitido (2MB)!")),(c=new FormData).append("processId",this.state.selectedId),this.setState(Object(h.a)({},this.state,Object(ce.a)({},t.target.name,t.target.files[0]))),d=[],(m=Be.concat(qe)).push({nameInput:"projDesmemb",label:"Projeto de Desmembramento",tooltip:"Planta de localiza\xe7\xe3o com delimita\xe7\xe3o da \xe1rea em an\xe1lise e indica\xe7\xe3o do per\xedmetro urbano, em escala de 1:10000"},{label:"Delimita\xe7\xe3o da \xe1rea do empreendimento (em formato kml)",nameInput:"kml",tooltip:"O arquivo anexado n\xe3o dever\xe1 conter linhas e/ou pontos, apenas um pol\xedgono, em extens\xe3o kml",tt:!0}),e.next=17,m.map(function(e){return d.push(e.nameInput)});case 17:return e.next=19,d.forEach(function(e){for(var t in u.state)t.match(e)&&c.append(e,u.state[t])});case 19:this.setState({form:c});case 20:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c,d,m,u,p,f,v,b,E,g,y,k,x,w,C,N=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.props.redux.processCollection,n=this.props.redux.processCollection.filter(function(e){return e._id.match(N.state.selectedId)})[0],r=this.props.redux.empCollection.filter(function(e){return e._id.match(n.empId)})[0],s=this.props.redux.rtCollection.filter(function(e){return e._id.match(n.rtId)})[0],i=Object(h.a)({},localStorage),o=this.state,l=o.selectedId,c=o.form,d=n.modalidade,m=n.nomeEmpreendimento,u=n.munEmpreendimento,p=function(){var e=[];a.length>0&&(e=a.filter(function(e){return e._id.match(l)})[0].processHistory.filter(function(e){return e.label}));var t=e.filter(function(e){return e.label.match("An\xe1lise")}).length;if(0===t){return"Anu\xeancia pr\xe9via solicitada"}return"Entrada "+(t+1)},f=[],v=[],b=0,!c){e.next=25;break}for(E=!0,g=!1,y=void 0,e.prev=9,k=c.entries()[Symbol.iterator]();!(E=(x=k.next()).done);E=!0)(w=x.value)[1]&&"undefined"!==w[1]&&(b+=1);e.next=17;break;case 13:e.prev=13,e.t0=e.catch(9),g=!0,y=e.t0;case 17:e.prev=17,e.prev=18,E||null==k.return||k.return();case 20:if(e.prev=20,!g){e.next=23;break}throw y;case 23:return e.finish(20);case 24:return e.finish(17);case 25:if(v=n.processHistory.filter(function(e){return"An\xe1lise 1"===e.label}),!(b>8&&"Desmembramento"===n.modalidade||b>17&&"Loteamento"===n.modalidade||v.length>0)){e.next=57;break}return this.props.loading(!0),e.prev=28,e.next=31,I.a.post("/api/fileUpload",this.state.form).then(function(e){e.data.file.forEach(function(e){return f.push(e)})});case 31:return C=p(),e.next=34,I.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:"Aguardando An\xe1lise"},processHistory:{label:C,createdAt:new Date,files:f,user:{nome:i.name+" "+i.surName,email:i.email}}});case 34:return this.props.loading(!1),q("sucess","Anu\xeancia Pr\xe9via solicitada."),e.next=38,me(r.email,s.emailRt,r.nome,d,m,u,"Anu\xeancia Pr\xe9via solicitada.");case 38:return e.next=40,this.clearSearch();case 40:return e.next=42,this.closeDetails();case 42:return e.next=44,this.setState({form:null});case 44:return e.next=46,this.props.loadProcessData();case 46:if(e.t1=e.sent,!e.t1){e.next=49;break}this.props.loadFilesData();case 49:console.log(""),e.next=55;break;case 52:e.prev=52,e.t2=e.catch(28),J(e.t2);case 55:e.next=58;break;case 57:alert("Favor anexar todos os arquivos solicitados.");case 58:case"end":return e.stop()}},e,this,[[9,13,17,25],[18,,20,24],[28,52]])}));return function(t){return e.apply(this,arguments)}}()},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({showEmpDetails:!1,showRtDetails:!1,showFiles:!1,empId:"",rtId:""})}},{key:"showFiles",value:function(e){this.setState({showFiles:!0,selectedId:e.target.id.replace(/z/g,"")})}},{key:"render",value:function(){var e,t,a=this,n=this.state,s=n.dataMatch,i=n.selectedId,o=n.checked,l=n.processes,c=n.filter,d=this.props.redux.processCollection,m=this.state.searchValue.toLowerCase(),u=[];l&&(u=l),s=m&&!o?u.filter(function(e){return e[c].toLowerCase().match(m)}):o||o&&m?u.filter(function(e){return e._id.toLowerCase().match(i)}):u;var p=[],h=[];return i&&(t=(e=d.filter(function(e){return e._id.match(i)}))[0].status),!e||"Loteamento"!==e[0].modalidade||"Diretrizes Metropolitanas emitidas"!==t&&"Pend\xeancias"!==t?!e||"Desmembramento"!==e[0].modalidade||"Aguardando documenta\xe7\xe3o"!==t&&"Pend\xeancias"!==t||(p=Ue,h=Ve):(p=Be,h=qe),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement(Ft,{data:this.state,redux:this.props.redux,search:function(e){return a.handleSearch(e)},searchArray:s,selectProcess:this.handleSelect.bind(this),submitFiles:this.handleSubmit.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),array:Be,array2:qe,showFiles:this.showFiles.bind(this),sort:this.sort},p.map(function(e,t){return r.a.createElement("div",{className:"col s6",key:t},r.a.createElement(_t,{object:e,key:t,upload:a.fileUpload.bind(a)}))}),r.a.createElement("div",{className:"row"},h.map(function(e,t){return r.a.createElement("div",{className:"col s6",key:t},r.a.createElement(_t,{object:e,key:t,upload:a.fileUpload.bind(a)}))}))),r.a.createElement(Pt,{selectedId:i,showFiles:this.state.showFiles,close:this.closeDetails.bind(this),processCollection:d,filesCollection:this.props.redux.filesCollection}),r.a.createElement(Je,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.redux.empCollection,rtCollection:this.props.redux.rtCollection})))}}]),t}(n.Component);var Mt=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadEmpData:_,loadRtData:T,loadProcessData:M,loadFilesData:z,setColor:B,loading:U},e)})(Tt),zt=function(e){var t=e.setColor,a=e.search,n=e.searchArray,s=e.selectProcess,i=e.data,o=e.redux,l=e.empDetails,c=e.rtDetails,d=e.showFiles,m=e.sort,u=e.tecFilter,p=e.filterTecs,h=localStorage.role;return i.selectedId&&o.processCollection.filter(function(e){return e._id.match(i.selectedId)})[0],r.a.createElement("div",{className:"container",style:{width:"95%"}},r.a.createElement(xe,{title:"Analisar Processo",subtitle:"Selecione o processo para analisar, registrar pend\xeancias ou emitir anu\xeancia pr\xe9via.",color:t}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s9"},r.a.createElement("label",null,"Pesquisar"),r.a.createElement("input",{className:"input",type:"text",name:"search",onChange:a,value:i.searchValue})),r.a.createElement(Ze,{search:a}),"tecnico"===h&&r.a.createElement("div",{className:"col s3 ",style:{position:"relative",left:"5%",float:"right",paddingTop:"2%"}},r.a.createElement("input",{id:"showArchieved",type:"checkbox",checked:!0===u,onChange:p}),r.a.createElement("label",{style:{fontSize:"0.9rem"},htmlFor:"showArchieved"},"Mostrar apenas meus processos"))),r.a.createElement("div",{className:"z-depth-3",style:{width:"100%",padding:"0px 10px 1px",borderRadius:"10px"}},r.a.createElement(ht,{search:n,collection:o.empCollection,rtCollection:o.rtCollection,processCollection:o.processCollection,onSelect:s,checked:i.checked,color:t,fields:["_id","nProcess","nomeEmpreendimento","modalidade","munEmpreendimento","status","tecnico"],renderEmp:!0,renderRt:!0,empDetails:l,rtDetails:c,showFiles:d,sort:m})),r.a.createElement("div",{className:"row",style:{marginTop:"15px"}},i.selectedId?null:r.a.createElement("div",{className:"col s1 right"},r.a.createElement(he,{disabled:null===i.checked,icon:"clear",onClick:e.clear}))))},Lt=[{name:"FileExplorer",img:"/images/gerenciarProc3.png",label:"Ver arquivos",divStyle:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:""}},{name:"Pendencias",img:"/images/pendencias.png",label:"Registrar Pend\xeancias",divStyle:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:"1px solid #a88"}},{name:"Anuencia",img:"/images/emitir_anuencia3.png",label:"Emitir Anu\xeancia",divStyle:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:""}},{name:"ProcessInfo",img:"/images/process_info3.png",label:"Informa\xe7\xf5es do Processo",divStyle:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:""}}],Bt=function(e){var t=e.process.processHistory.filter(function(e){return e.files});return r.a.createElement("div",{style:{height:"100%",overflowY:"auto",overflowX:"hidden"}},t.map(function(e,t){return r.a.createElement("div",{style:{border:"1px solid #ddd",padding:"1% 0 0 1%"},key:t+1e3},r.a.createElement("div",{className:"row",align:"center"},r.a.createElement("span",{style:{fontSize:"1rem",fontWeight:500}},e.label," em ",tt(e.createdAt))),r.a.createElement("div",{className:"row",style:{fontSize:"0.9rem",padding:"0.8% 0",backgroundColor:"#f7f7f7",fontWeight:500,borderBottom:"1px solid #ddd",borderTop:"1px solid #ddd"}},r.a.createElement("div",{className:"col s5 left"},"Documento"),r.a.createElement("div",{className:"col s4 left"},"Nome do arquivo"),r.a.createElement("div",{className:"col s3 center"},"Tamanho")),r.a.createElement("div",{className:"row"},e.files.map(function(e,t){return r.a.createElement("div",{className:"row",key:t+100,style:{paddingLeft:"1%"}},r.a.createElement("div",{className:"col s5"},We(e.fieldName)),r.a.createElement("div",{className:"col s4"},r.a.createElement("span",{id:e.id,key:t,style:{textDecoration:"underline",cursor:"pointer",color:"blue"},onClick:function(t){return rt(t,e.originalName)}},e.originalName)),r.a.createElement("div",{className:"col s3 center"},at(e.fileSize)))})))}))},qt=function(e){var t=e.upload,a=e.submitFiles;return r.a.createElement("div",{style:{paddingLeft:"10%",marginBottom:"8%"}},r.a.createElement("h5",null,"Emitir Anu\xeancia Pr\xe9via"),[{label:"Anexar Nota T\xe9cnica",inputName:"notaTecnica"},{label:"Anexar Certid\xe3o de Anu\xeancia Pr\xe9via",inputName:"anuenciaFile"}].map(function(e,a){return r.a.createElement("div",{style:{marginTop:"10%"},key:a},r.a.createElement("label",{style:{fontSize:"16px",paddingTop:"15px",fontWeight:450,color:"black"}},e.label),r.a.createElement("div",{className:"row file-field input-field",key:e.inputName},r.a.createElement("div",{className:"file-path-wrapper row"},r.a.createElement("div",{className:"col s11"},r.a.createElement("input",{className:"file-path validate",type:"text",placeholder:"Carregar arquivo"})),r.a.createElement("div",{className:"col s1 right"},r.a.createElement("i",{className:"material-icons grey-text text-darken-1 small"},"attach_file"),r.a.createElement("input",{type:"file",name:e.inputName,onChange:t})))))}),r.a.createElement("button",{className:"btn teal darken-3 right",style:{marginRight:"2%"},type:"submit",onClick:a},"Emitir Anu\xeancia Pr\xe9via"))},Ut=a(112),Vt=a.n(Ut),Ht=(a(316),function(e){var t=e.empreend,a=e.process;var n=e.prefeituras.filter(function(e){return e.municipio.toLowerCase().match(a.munEmpreendimento.toLowerCase())})[0],s={lineHeight:.8};return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("img",{className:"col s12",src:"/images/governo_header3.jpg",style:{paddingRight:"20px"},alt:""})),r.a.createElement("p",{className:"oficioHeader"},r.a.createElement("span",{className:"right"},"Belo Horizonte, ",function(){var e=new Date;return"".concat(e.getDate()," de ").concat(["janeiro","fevereiro","mar\xe7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"][e.getMonth()]," de ").concat(e.getFullYear())}(),".")),r.a.createElement("br",null),r.a.createElement("p",{className:"ql-align-justify",style:s}," ",n.vocativo1," "),r.a.createElement("p",{className:"ql-align-justify",style:s}," ",r.a.createElement("strong",null,n.nome)," "),r.a.createElement("p",{className:"ql-align-justify",style:s},n.cargo),r.a.createElement("p",{className:"ql-align-justify",style:s},"Prefeitura de ",a.munEmpreendimento),r.a.createElement("p",{className:"ql-align-justify",style:s},n.endereco),r.a.createElement("p",{className:"ql-align-justify",style:s},"CEP: ",n.cep," \u2013 ",a.munEmpreendimento,", MG"),r.a.createElement("p",null),r.a.createElement("p",{className:"ql-align-justify"},r.a.createElement("strong",null,"Assunto:"),' Empreendimento "',a.nomeEmpreendimento,'", Processo RMBH n\xba ',a.nProcess," "),r.a.createElement("p",null),r.a.createElement("p",{className:"ql-align-justify"},n.vocativo2,", "),r.a.createElement("p",{className:"ql-align-justify"},"Em resposta ao of\xedcio da Prefeitura Municipal de ",a.munEmpreendimento,", que solicita an\xe1lise e emiss\xe3o de Selo de Anu\xeancia Pr\xe9via para o ",a.modalidade," de uma \xe1rea de ",a.area,"m\xb2, situado no lugar denominado ",r.a.createElement("strong",null,a.nomeEmpreendimento),", de interesse de",r.a.createElement("strong",null," ",t.nome),", informamos que:"),r.a.createElement("p",null))}),Wt=function(e){var t=e.mostrarOficio,a=e.content,n=e.redux,s=e.process,i=e.empreend,o=e.rt,l=e.tecnicos,c=e.prefeituras,d=Object(h.a)({},localStorage),m=l.filter(function(e){return e.email.match(d.email)})[0],u=m?m.name:d.name,p=m?m.surName:d.surName,f=m?m.cau:"n\xe3o registrado";return t?r.a.createElement("div",{id:"oficio",className:"z-depth-3",style:{position:"relative",borderRadius:"15px",width:"100%",backgroundColor:"white",padding:"15px 0px 0px 30px",border:"1px solid #ddd",marginBottom:"25px"}},r.a.createElement(Ht,{redux:n,process:s,empreend:i,rt:o,prefeituras:c}),r.a.createElement("div",{dangerouslySetInnerHTML:{__html:a}}),r.a.createElement("center",null,r.a.createElement("strong",null,r.a.createElement("p",null,u," ",p)),r.a.createElement("p",null,"CAU/MG ",f))):null},Gt={toolbar:[["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"]]},Jt=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={color:"",text:"",mostrarOficio:!1,oficio:""},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){this.props.cadastro.empCollection[0]||this.props.loadEmpData(),this.props.cadastro.rtCollection[0]||this.props.loadRtData(),this.props.cadastro.processCollection[0]||this.props.loadProcessData();var e=document.getElementById("setcolor").style.backgroundColor;this.setState({setColor:e})}},{key:"handleChange",value:function(e){this.setState(Object(h.a)({},this.state,{text:e}))}},{key:"savePdf",value:function(){this.setState({mostrarOficio:!0})}},{key:"enviaPendencias",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c,d,m,u;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.props,n=a.process,r=a.empreend,s=a.rt,i=n.modalidade,o=n.nomeEmpreendimento,l=n.munEmpreendimento,c=Object(h.a)({},localStorage),d=this.props.process.processHistory.filter(function(e){return e.label.match("An\xe1lise")}),m="An\xe1lise ".concat(d.length+1),u=document.getElementById("oficio").outerHTML,this.props.loading(!0),this.setState({oficio:u}),e.prev=9,e.next=12,I.a.put("/api/editProcess",{item:{_id:this.props.process._id,status:"Pend\xeancias",tecnico:c.name+" "+c.surName},processHistory:{label:m,createdAt:new Date,pendencias:u,user:{nome:c.name+" "+c.surName,email:c.email}}});case 12:return this.props.loading(!1),e.next=15,q("sucess","Pend\xeancias para a emiss\xe3o de anu\xeancia.");case 15:return e.next=17,me(r.email,s.emailRt,r.nome,i,o,l,"Pend\xeancias para a emiss\xe3o de anu\xeancia.");case 17:return e.next=19,this.props.close();case 19:this.props.loadProcessData(),e.next=25;break;case 22:e.prev=22,e.t0=e.catch(9),J(e.t0);case 25:case"end":return e.stop()}},e,this,[[9,22]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.props,a=t.empreend,n=t.rt,s=t.process,i=t.tecnicos,o=t.prefeituras,l=function(){return!e.state.mostrarOficio&&"disabled"};return r.a.createElement("div",{style:{height:"100%"}},r.a.createElement(Vt.a,{value:this.state.text,onChange:this.handleChange.bind(this),modules:Gt,theme:"snow",style:{background:"#fff",height:"50vh",marginBottom:"10px",border:"1px solid #ddd",borderRadius:"1%",overflow:"hidden"}}),r.a.createElement(Wt,{mostrarOficio:this.state.mostrarOficio,content:this.state.text,oficio:this.state.oficio,process:s,empreend:a,rt:n,tecnicos:i,prefeituras:o}),r.a.createElement("button",{className:"btn right",onClick:this.enviaPendencias.bind(this),disabled:l()}," Enviar "),r.a.createElement("button",{style:{marginRight:"10px"},className:"btn right",onClick:this.savePdf.bind(this),disabled:!l()}," Pr\xe9-visualizar "))}}]),t}(n.Component),Yt=Object(l.connect)(function(e){return{cadastro:e.cadastro}},function(e){return Object(o.b)({loadEmpData:_,loadRtData:T,loadProcessData:M,loading:U,reduxToastr:q},e)})(Jt),Kt=function(e){var t=e.redux,a=e.clear,n=e.data,s=e.selectedOption,i=e.optionSelect,o=e.process,l=e.empreend,c=e.rt,d=e.divConfig,m=e.changeValue,u=e.showLog,p=e.clearLog,h=e.log,f=e.close,v=e.upload,b=e.submit,E=e.prefeituras;return r.a.createElement("div",{className:"container",style:{width:"90%"}},r.a.createElement("div",null,r.a.createElement("div",{className:"row",align:"center",style:{border:"1px solid #ddd",borderRadius:"8px",backgroundColor:"#efefef",fontSize:"1.2rem",fontFamily:"calibri",marginTop:"15px"}},r.a.createElement("h4",null,o.nomeEmpreendimento),r.a.createElement("div",{className:"row col s12"},r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null,"Munic\xedpio:"),"  ",o.munEmpreendimento),r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null,"Modalidade:")," ",o.modalidade),r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null,"\xc1rea:")," ",o.area),r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null," Empreendedor: ")," ",l.nome),r.a.createElement("div",{className:"col s12 m6 l4"},r.a.createElement("b",null,"RT: "),c.nomeRt),r.a.createElement("div",{className:"col s12 m6 l4"},o.status))),r.a.createElement("div",{className:"row",style:{marginBottom:0,cursor:"pointer"}},Lt.map(function(e,t){return r.a.createElement("div",{id:e.name,key:t,align:"center",className:"col s12 m6 l3 ".concat(d(e).class),style:d(e).stylez,onClick:i},r.a.createElement("img",{id:e.name,className:"center-align",src:e.img,style:{margin:"10px 10px 0px 10px",cursor:"pointer"},height:"40",alt:""}),r.a.createElement("h6",{id:e.name,style:{cursor:"pointer",fontWeight:550}},e.label))})),r.a.createElement("div",{style:{minHeight:"50vh",border:"1px solid #ddd",borderRadius:"2%",marginBottom:"2%"}},""===s?r.a.createElement("div",{className:"col push-s4",style:{paddingTop:"20%"}},r.a.createElement("h5",null,"Selecione uma das op\xe7oes acima.")):r.a.createElement("div",{className:"col s12",style:{height:"100%"}},function(e){switch(e){case"FileExplorer":return r.a.createElement(Bt,{selectedId:n.selectedId,showFiles:n.showFiles,close:f,processCollection:t.processCollection,filesCollection:t.filesCollection,process:o});case"Pendencias":return r.a.createElement(Yt,{process:o,empreend:l,rt:c,tecnicos:t.tecCollection,value:n.analiseProc.pendencias,changeValue:m,close:f,prefeituras:E});case"Anuencia":return r.a.createElement(qt,{upload:v,submitFiles:b});case"ProcessInfo":return r.a.createElement(it,{process:o,showLog:u,logDetails:h.logDetails,index:h.logIndex,clearLog:p});default:console.log("invalid option, dude!")}}(s))),h.logDetails&&"ProcessInfo"===s?null:r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s1 left"},r.a.createElement(he,{disabled:null===n.checked,icon:"arrow_back",onClick:a})," Voltar"))))},Xt=function(e){function t(){var e;return Object(Y.a)(this,t),(e=Object(X.a)(this,Object(Q.a)(t).call(this))).state={selectedOption:"",selectedId:"",logDetails:!1,logIndex:"",notaTecnica:"",anuenciaFile:"",form:"",prefeituras:[]},e.escFunction=function(t){var a=e.state.logDetails;27===t.keyCode&&a&&e.clearLog()},e}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"optionSelect",value:function(e){this.setState({selectedOption:e.target.id})}},{key:"componentDidMount",value:function(){var e=this;this.setState({selectedId:this.props.data.selectedId}),I.a.get("/api/prefeituras").then(function(t){return e.setState({prefeituras:t.data})}).catch(function(e){return console.log(e)}),document.addEventListener("keydown",this.escFunction,!1)}},{key:"componentWillUnmount",value:function(){this.props.clear(),document.removeEventListener("keydown",this.escFunction,!1)}},{key:"divConfig",value:function(e){if(e.name!==this.state.selectedOption){return{stylez:{minHeight:"8vh",border:"1px solid #ddd",borderRadius:"2%",borderBottom:"",borderTopLeftRadius:"15%",borderTopRightRadius:"15%"},class:"col s12 m6 l3 z-depth-2"}}return{stylez:{minHeight:"8vh",border:"2px solid #bbb",borderRadius:"2%",borderBottom:"",borderTopLeftRadius:"15%",borderTopRightRadius:"15%",backgroundColor:"#fcfcfc"},class:"col s12 m6 l3"}}},{key:"showLog",value:function(e){this.setState({logIndex:e.target.id,logDetails:!0})}},{key:"clearLog",value:function(){this.setState({logDetails:!1,logIndex:""})}},{key:"fileUpload",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=["notaTecnica","anuenciaFile"],(n=new FormData).append("processId",this.state.selectedId),e.next=5,this.setState(Object(h.a)({},this.state,Object(ce.a)({},t.target.name,t.target.files[0])));case 5:return e.next=7,a.forEach(function(e){for(var t in r.state)t.match(e)&&n.append(e,r.state[t])});case 7:this.setState({form:n});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c,d,m,u,p=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.props.redux.processCollection.filter(function(e){return e._id.match(p.props.data.selectedId)})[0],n=this.props.redux.empCollection.filter(function(e){return e._id.match(a.empId)})[0],r=this.props.redux.rtCollection.filter(function(e){return e._id.match(a.rtId)})[0],s=a.modalidade,i=a.nomeEmpreendimento,o=a.munEmpreendimento,l=Object(h.a)({},localStorage),c=l.name,d=l.surName,m=l.email,u=[],this.state.notaTecnica&&this.state.anuenciaFile){e.next=11;break}alert("Favor anexar a nota t\xe9cnica e a certid\xe3o de anu\xeancia"),e.next=27;break;case 11:return this.props.loading(!0),e.prev=12,e.next=15,I.a.post("/api/fileUpload",this.state.form).then(function(e){e.data.file.forEach(function(e){return u.push(e)})});case 15:return e.next=17,I.a.put("/api/editProcess",{item:{_id:this.state.selectedId,status:"Processo Anu\xeddo",tecnico:c+" "+d},processHistory:{label:"Processo Anu\xeddo",createdAt:new Date,files:u,user:{nome:c+" "+d,email:m}}});case 17:return e.next=19,q("sucess","Processo Anu\xeddo.");case 19:return e.next=21,me(n.email,r.emailRt,n.nome,s,i,o,"Processo Anu\xeddo.");case 21:setTimeout(function(){p.props.loading(!1),p.setState({form:null}),p.props.loadProcessData(),p.props.loadFilesData()},1250),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(12),J(e.t0);case 27:case"end":return e.stop()}},e,this,[[12,24]])}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a,n=this.props,s=n.clear,i=n.data,o=n.redux,l=n.close,c=n.changeValue;if(i.selectedId&&(e=o.processCollection.filter(function(e){return e._id.match(i.selectedId)})[0])&&(t=o.empCollection.filter(function(t){return t._id.match(e.empId)})[0],a=o.rtCollection.filter(function(t){return t._id.match(e.rtId)})[0]),i.selectedId)return i.showFiles=!0,r.a.createElement("div",{className:"container"},r.a.createElement(Kt,{data:i,redux:o,clear:s,close:l,process:e,empreend:t,rt:a,prefeituras:this.state.prefeituras,match:this.props.match,optionSelect:this.optionSelect.bind(this),selectedOption:this.state.selectedOption,divConfig:this.divConfig.bind(this),changeValue:c,log:this.state,showLog:this.showLog.bind(this),clearLog:this.clearLog.bind(this),upload:this.fileUpload.bind(this),submit:this.handleSubmit.bind(this)}))}}]),t}(n.Component),Qt=Object(l.connect)(function(e){return{cadastro:e.cadastro}},function(e){return Object(o.b)({loadProcessData:M,loadFilesData:z,loading:U,reduxToastr:q},e)})(Xt),Zt=function(e){function t(){var e;return Object(Y.a)(this,t),(e=Object(X.a)(this,Object(Q.a)(t).call(this))).state={searchValue:"",dataMatch:[],selectedId:"",checked:null,files:[],form:null,diretrizFile:"",showEmpDetails:!1,showRtDetails:!1,empId:"",rtId:"",showFiles:!1,filesCollection:"",analiseProc:{createdAt:"",pendencias:""},filter:"nomeEmpreendimento",tecFilter:!0},e.sort=function(t){var a,n=e.state,r=n.reverse,s=n.processes;a=ut(s,t),!0===r&&a.reverse(),e.setState({processes:a,reverse:!r})},e.filterTecs=Object(W.a)(H.a.mark(function t(){var a,n;return H.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.state.processes,n=Object(h.a)({},localStorage),t.next=4,e.setState({tecFilter:!e.state.tecFilter});case 4:e.state.tecFilter?(a=a.filter(function(e){return e.tecnico===n.name+" "+n.surName}),e.setState({processes:a})):(a=e.props.redux.processCollection.filter(function(e){return"Aguardando An\xe1lise"===e.status}),e.setState({processes:a}));case 5:case"end":return t.stop()}},t)})),e.escFunction=function(t){e.state.checked||27!==t.keyCode||e.closeDetails()},e}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t,a,n,r,s,i,o;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.redux,a=t.empCollection,n=t.rtCollection,r=t.processCollection,s=t.filesCollection,i=t.tecCollection,a[0]||this.props.loadEmpData(),r[0]){e.next=7;break}return e.next=5,this.props.loadProcessData();case 5:e.next=8;break;case 7:case 8:n[0]||this.props.loadRtData(),s[0]||this.props.loadFilesData(),i[0]||this.props.loadTecnicos(),o=this.props.redux.processCollection.filter(function(e){return"Aguardando An\xe1lise"===e.status}),"tecnico"===localStorage.role&&(o=o.filter(function(e){return e.tecnico===localStorage.name+" "+localStorage.surName})),this.setState({processes:o}),document.addEventListener("keydown",this.escFunction,!1);case 15:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.escFunction,!1)}},{key:"handleSearch",value:function(e){var t=e.target,a=t.name,n=t.value;"select"===a?this.setState({filter:n}):this.setState(Object(h.a)({},this.state,{searchValue:e.target.value,checked:!1}))}},{key:"clearSearch",value:function(e){this.setState(Object(h.a)({},this.state,{checked:null,selectedId:null,searchValue:"",showFiles:null}))}},{key:"handleSelect",value:function(e){var t=e.target,a=t.name,n=t.value;"select"===a?this.setState({filter:n}):this.setState(Object(h.a)({},this.state,{selectedId:e.target.value.replace(/,/g,""),checked:e.currentTarget.id}))}},{key:"empDetails",value:function(e){this.setState({showEmpDetails:!0,showRtDetails:!1,empId:e.target.id})}},{key:"rtDetails",value:function(e){this.setState({showEmpDetails:!1,showRtDetails:!0,rtId:e.target.id})}},{key:"closeDetails",value:function(){this.setState({selectedId:null,showEmpDetails:!1,showRtDetails:!1,showFiles:!1,empId:"",rtId:""})}},{key:"showFiles",value:function(e){this.setState({showFiles:!0,selectedId:e.target.id.replace(/z/g,"")})}},{key:"handleChange",value:function(e){var t=e,a=this.state.analiseProc;a.pendencias=t,a.createdAt=new Date,this.setState({analiseProc:a})}},{key:"render",value:function(){var e=this,t=this.state,a=t.dataMatch,n=t.processes,s=t.filter,i=t.tecFilter,o=this.state.searchValue.toLowerCase(),l=[];return n&&(l=n),a=o&&!this.state.checked?l.filter(function(e){return e[s].toLowerCase().match(o)}):this.state.checked||this.state.checked&&o?l.filter(function(t){return t._id.toLowerCase().match(e.state.selectedId)}):l,r.a.createElement("div",null,r.a.createElement("div",null,this.state.selectedId?this.state.showFiles?r.a.createElement(zt,{data:this.state,redux:this.props.redux,search:function(t){return e.handleSearch(t)},searchArray:a,selectProcess:this.handleSelect.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),showFiles:this.showFiles.bind(this)}):r.a.createElement("div",null,r.a.createElement(Qt,{data:this.state,redux:this.props.redux,clear:this.clearSearch.bind(this),close:this.closeDetails.bind(this),match:this.props.match,changeValue:this.handleChange.bind(this),showFiles:this.state.showFiles})):r.a.createElement(zt,{data:this.state,redux:this.props.redux,search:function(t){return e.handleSearch(t)},searchArray:a,selectProcess:this.handleSelect.bind(this),setColor:this.props.redux.setColor,clear:this.clearSearch.bind(this),empDetails:this.empDetails.bind(this),rtDetails:this.rtDetails.bind(this),showFiles:this.showFiles.bind(this),sort:this.sort,tecFilter:i,filterTecs:this.filterTecs}),r.a.createElement(Je,{empId:this.state.empId,rtId:this.state.rtId,showEmp:this.state.showEmpDetails,showRt:this.state.showRtDetails,close:this.closeDetails.bind(this),empCollection:this.props.redux.empCollection,rtCollection:this.props.redux.rtCollection})),r.a.createElement("div",null,r.a.createElement(Pt,{selectedId:this.state.selectedId,showFiles:this.state.showFiles,close:this.closeDetails.bind(this),processCollection:this.props.redux.processCollection,filesCollection:this.props.redux.filesCollection})))}}]),t}(n.Component);var $t=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadEmpData:_,loadRtData:T,loadProcessData:M,loadTecnicos:L,loadFilesData:z,reduxToastr:q},e)})(Zt),ea=function(e){var t=e.id,a=e.presentValue,n=e.handleChange,s=e.municipio;return r.a.createElement("select",{id:t,name:"role",className:"browser-default",onChange:n},r.a.createElement("option",{value:a},a),r.a.createElement("option",{value:"admin"},"Administrador"),r.a.createElement("option",{value:"tecnico"},"T\xe9cnico da Ag\xeancia"),r.a.createElement("option",{value:"prefeitura"},"Prefeitura de ".concat(s)),r.a.createElement("option",{value:"empreend"},"Empreendedor"),r.a.createElement("option",{value:"rt"},"Respons\xe1vel T\xe9cnico"))},ta=function(e){var t=e.id,a=e.handleChange,n=e.municipio,s=je.munEmpreendimento.options;return n||(n=""),r.a.createElement("select",{id:t,name:"municipio",className:"browser-default",onChange:a,value:n},s.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e||n)}))},aa=function(e){return e.replace("Usu\xe1rio","name").replace("Permiss\xf5es","role").replace("E-mail","email").replace("\xed","i").toLowerCase()},na=function(e){var t=e.users,a=e.handleChange,n=e.editUsers,s=e.deleteUser,i=e.editTec,o=e.showVerified,l=e.verified,c=e.sort,d=e.reverse;return r.a.createElement("div",null,r.a.createElement("div",{className:"row right"},r.a.createElement("input",{id:"showVerified",type:"checkbox",checked:!0===l,onChange:o}),r.a.createElement("label",{style:{fontSize:"0.9rem"},htmlFor:"showVerified"},"Mostrar usu\xe1rios verificados")),r.a.createElement("table",{className:"resposive-table highlight"},r.a.createElement("thead",null,r.a.createElement("tr",null,["Usu\xe1rio","E-mail","Munic\xedpio"].map(function(e,t){return r.a.createElement("th",{key:t,name:aa(e)},r.a.createElement("span",null," ",e," "),r.a.createElement("span",{style:{cursor:"pointer"},onClick:function(){return c(aa(e))}},d?"\u25bc":"\u25b2"))}),["Permiss\xf5es","Op\xe7\xf5es","Editar T\xe9cnico"].map(function(e,t){return r.a.createElement("th",{key:t,name:aa(e),className:"center"},e)}))),r.a.createElement("tbody",null,t[0]?t.map(function(e,t){return r.a.createElement("tr",{id:e._id,key:t,style:{borderBottom:"1px solid #eee"}},r.a.createElement("td",null,e.name," ",e.surName),r.a.createElement("td",null,e.email),r.a.createElement("td",null,"prefeitura"===e.role?r.a.createElement(ta,{id:e._id,handleChange:a,municipio:e.municipio}):e.municipio),r.a.createElement("td",null,r.a.createElement(ea,{id:e._id,presentValue:e.role,handleChange:a,municipio:e.municipio})),r.a.createElement("td",{className:"center",style:{paddingLeft:"3%"}},r.a.createElement("input",{id:"v_".concat(e._id),name:"v_",type:"checkbox",checked:e.verified?"checked":"",onChange:a,title:"Confirmar usu\xe1rio"}),r.a.createElement("label",{htmlFor:"v_".concat(e._id)}),r.a.createElement("i",{id:"d_".concat(e._id),className:"material-icons red-text click",onClick:s,title:"Apagar"},"delete_outlined")),r.a.createElement("td",{className:"center"},"tecnico"===e.role&&r.a.createElement("i",{id:"t_".concat(e._id),className:"material-icons grey-text click",onClick:i,title:"Editar T\xe9cnico"},"settings")))}):r.a.createElement("tr",null),r.a.createElement("tr",null,r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",null),r.a.createElement("td",{className:"center"},r.a.createElement("i",{style:{color:"teal"},onClick:n,title:"Salvar",className:"material-icons small click"},"save"))))))},ra=a(115),sa=a(27),ia=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={municipios:[],name:"",surName:"",email:"",cau:"",cities:[]},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.users,a=e.tecnicos,n=e.userId,r=t.filter(function(e){return e._id.match(n.replace("t_",""))})[0],s=a.filter(function(e){return e.email.match(r.email)})[0],i=[],o=[];if(je.munEmpreendimento.options.forEach(function(e){return i.push(Object(ce.a)({},e,!1))}),s){var l=s.municipios,c=(s._id,s.createdAt,s.updatedAt,s.__v,Object(sa.a)(s,["municipios","_id","createdAt","updatedAt","__v"]));l.forEach(function(e){return i.find(function(t){return Object.keys(t)[0]===e})[e]=!0}),i.filter(function(e){return!0===Object.values(e)[0]}).forEach(function(e){return o.push(Object.keys(e)[0])}),c.cities=i,c.municipios=o,this.setState(Object(h.a)({},c))}else{r._id,r.verified,r.password,r.role;var d=Object(sa.a)(r,["_id","verified","password","role"]);d.cities=i,this.setState(Object(h.a)({},d))}}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value,r=t.type,s=Object(ra.a)(this.state.cities),i={},o=[];"checkbox"===r&&(s.find(function(e){return Object.keys(e)[0]===a})[a]=!s.find(function(e){return Object.keys(e)[0]===a})[a]),"text"===r&&Object.assign(i,Object(ce.a)({},a,n)),this.state.cities.filter(function(e){return!0===Object.values(e)[0]}).forEach(function(e){return o.push(Object.keys(e)[0])}),this.setState(Object(h.a)({},i,{cities:s,municipios:o}))}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var a=this.state,n=(a.cities,Object(sa.a)(a,["cities"]));I.a.put("/api/tecnicos",n).then(function(e){console.log(e.data),t.props.refresh()}).catch(function(e){return console.log(e)})}},{key:"render",value:function(){var e=this,t=this.props,a=t.users,n=t.editTec,s=t.userId,i=a.filter(function(e){return e._id.match(s.replace("t_",""))})[0],o=je.munEmpreendimento.options,l=function(t){var a=e.state.cities.filter(function(e){return!0===Object.values(e)[0]}).filter(function(e){return Object.keys(e)[0]===t})[0];return a?"checked":void 0};return r.a.createElement("div",{style:nt(!0,["15%","70%"])},r.a.createElement("div",{className:"row",style:{textAlign:"center"}},r.a.createElement("div",{style:{position:"absolute",top:"0.5%",right:"0.5%"}},r.a.createElement(Ee,{close:n})),r.a.createElement("h5",null,"Editar dados - ",i.name," ",i.surName)),r.a.createElement("form",{action:"submit",id:"form",onSubmit:this.handleSubmit.bind(this)},Object.entries(this.state).map(function(t,a){var n=Object(le.a)(t,2),s=n[0],i=n[1];return"municipios"!==s&&"cities"!==s&&r.a.createElement("div",{className:"row",key:a},r.a.createElement("label",{htmlFor:a},s),r.a.createElement("input",{type:"text",value:i,id:a,name:s,onChange:e.handleChange.bind(e)}))}),r.a.createElement("div",{className:"row"},r.a.createElement("h5",{style:{fontSize:"1rem",padding:"1%"}},"Munic\xedpios para an\xe1lise"),o.map(function(t,a){return""!==t&&r.a.createElement("div",{className:"col s6 m3 l2",key:a+100},r.a.createElement("input",{id:t,name:t,type:"checkbox",checked:l(t)||"",onChange:e.handleChange.bind(e),title:"Selecionar municipios"}),r.a.createElement("label",{htmlFor:t},t))}))),r.a.createElement(be,{display:!0,form:"form"}))}}]),t}(n.Component),oa=function(e){function t(){var e;return Object(Y.a)(this,t),(e=Object(X.a)(this,Object(Q.a)(t).call(this))).state={users:[],tecnicos:[],editTec:!1,userId:"",showVerified:!1,reverse:!1,vUsers:[],blockUsers:[]},e.escFunction=function(t){e.state.editTec&&27===t.keyCode&&e.setState({editTec:!1})},e}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=Object(W.a)(H.a.mark(function e(){var t,a,n,r,s,i,o,l;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,a=t.getUsers,n=t.loadTecnicos,document.addEventListener("keydown",this.escFunction,!1),e.next=4,a();case 4:return e.next=6,n();case 6:r=this.props,s=r.auth,i=r.redux,o=s.usersCollection.filter(function(e){return!0===e.verified}),l=s.usersCollection.filter(function(e){return!1===e.verified}),this.setState({users:s.usersCollection,tecnicos:i.tecCollection,vUsers:o,blockUsers:l});case 10:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleChange",value:function(e){var t,a=this.state.users,n=e.target.name;t=a.filter(function(t){return"".concat(n+t._id).match(e.target.id)})[0];var r=a.indexOf(t);"v_"===e.target.name?a[r].verified=!a[r].verified:"role"===n?a[r].role=e.target.value:"municipio"===n&&(a[r].municipio=e.target.value),this.setState({users:a})}},{key:"editUsers",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=this.state.users,e.next=4,I.a.put("/api/edit",{el:"user",item:a}).then(function(e){console.log("ok")}).catch(function(e){return alert(e)});case 4:return q("sucess","Registro alterado."),e.next=7,this.props.getUsers();case 7:n=a.filter(function(e){return!0===e.verified}),r=a.filter(function(e){return!1===e.verified}),this.setState({vUsers:n,blockUsers:r});case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"deleteUser",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target.id.replace("d_",""),n=this.state.users.filter(function(e){return e._id.match(a)})[0],!window.confirm("Excluir ".concat(n.name," ").concat(n.surName,"?"))){e.next=8;break}return e.next=5,I.a.delete("/api/delete/item?id=".concat(a,"&el=user")).catch(function(e){return console.log(e)});case 5:return e.next=7,this.props.getUsers();case 7:this.setState({users:this.props.auth.usersCollection});case 8:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"editTec",value:function(e){this.setState({editTec:!this.state.editTec,userId:e.target.id})}},{key:"refresh",value:function(){this.setState({editTec:!this.state.editTec}),q("sucess","Dados do t\xe9cnico atualizados")}},{key:"showVerified",value:function(){this.setState({showVerified:!this.state.showVerified})}},{key:"sort",value:function(e){var t,a=this.state,n=a.vUsers,r=a.blockUsers,s=a.showVerified,i=a.reverse;s?(t=ut(n,e),!0===i&&t.reverse(),this.setState({vUsers:t,reverse:!i})):(t=ut(r,e),!0===i&&t.reverse(),this.setState({blockUsers:t,reverse:!i}))}},{key:"render",value:function(){var e=this.state,t=e.users,a=e.userId,n=e.tecnicos,s=e.showVerified,i=e.reverse,o=e.vUsers,l=e.blockUsers;return s&&(l=o),r.a.createElement("div",{className:"container",style:{width:"95%"}},r.a.createElement("div",null,r.a.createElement(xe,{title:"Gerenciar Usu\xe1rios",subtitle:"Crie, remova ou edite as permiss\xf5es/confirma\xe7\xf5es de cada usu\xe1rio do sistema. ",color:this.props.redux.setColor})),r.a.createElement(na,{users:l,handleChange:this.handleChange.bind(this),deleteUser:this.deleteUser.bind(this),editUsers:this.editUsers.bind(this),editTec:this.editTec.bind(this),showVerified:this.showVerified.bind(this),verified:this.state.showVerified,sort:this.sort.bind(this),reverse:i}),this.state.editTec&&r.a.createElement(ia,{users:t,userId:a,tecnicos:n,editTec:this.editTec.bind(this),refresh:this.refresh.bind(this)}))}}]),t}(n.Component);var la=Object(l.connect)(function(e){return{redux:e.cadastro,auth:e.auth}},function(e){return Object(o.b)({getUsers:F,reduxToastr:q,loadTecnicos:L},e)})(oa),ca=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={municipio:"",prefeituras:[]},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=this;I.a.get("/api/prefeituras").then(function(t){return e.setState({prefeituras:t.data})}).catch(function(e){return console.log(e)})}},{key:"handleChange",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.target,n=a.name,r=a.value,"SELECT"!==a.nodeName){e.next=9;break}return e.next=4,this.setState({municipio:r});case 4:s=this.state,i=s.prefeituras,o=s.municipio,(l=i.filter(function(e){return e.municipio===o})[0])&&(l=Object(h.a)({nome:l.nome},l),this.setState(Object(h.a)({},this.state,l))),e.next=10;break;case 9:this.setState(Object(ce.a)({},n,r));case 10:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"handleSubmit",value:function(e){var t=this,a=this.state,n=(a.prefeituras,Object(sa.a)(a,["prefeituras"]));I.a.put("/api/prefeituras",n).then(function(e){return q("sucess",e.data,"Cadastro alterado")}).then(I.a.get("/api/prefeituras").then(function(e){return t.setState({prefeituras:e.data})}).catch(function(e){return console.log(e)})).catch(function(e){return q("err",e,"Erro!")}),e.preventDefault()}},{key:"render",value:function(){var e=this,t=this.state,a=t.prefeituras,n=t.municipio,s=a.filter(function(e){return e.municipio===n})[0];s&&(s=Object(h.a)({nome:s.nome},s));var i=je.munEmpreendimento.options.map(function(e,t){return r.a.createElement("option",{key:t,value:e},e)});return r.a.createElement("div",{className:"container"},r.a.createElement(xe,{title:"Editar dados das prefeituras"}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col s12"},r.a.createElement("label",null,"Selecione o munic\xedpio"),r.a.createElement("br",null),r.a.createElement("select",{className:"browser-default",value:this.state.municipio,onChange:this.handleChange.bind(this)},i))),r.a.createElement("div",{className:"row"},s?r.a.createElement("form",{id:"prefForm",onSubmit:this.handleSubmit.bind(this)},Object.entries(this.state).map(function(t,a){var n=Object(le.a)(t,2),s=n[0],i=n[1];return"updatedAt"!==s&&"_id"!==s&&"prefeituras"!==s&&r.a.createElement("div",{className:"col s12 m6",key:a},r.a.createElement("label",{htmlFor:s},s.replace(/\w/,function(e){return e.toUpperCase()})),r.a.createElement("input",{type:"text",value:i,name:s,onChange:e.handleChange.bind(e)}))}),r.a.createElement("div",{className:"col s12 right"},r.a.createElement(be,{form:"prefForm",display:!0}))):r.a.createElement("div",{className:"col push-s4",style:{paddingTop:"20%"}},r.a.createElement("h5",null,"Selecione o munic\xedpio."))))}}]),t}(n.Component),da=function(e){function t(){return Object(Y.a)(this,t),Object(X.a)(this,Object(Q.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(ca,null))}}]),t}(n.Component),ma=[{name:"password",label:"Nova senha"},{name:"confirmPassword",label:"Confirme a nova senha"}],ua=function(e){var t=e.handleChange,a=e.handleSubmit,n=e.values;return r.a.createElement("div",null,r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12",onSubmit:a},ma.map(function(e,a){return r.a.createElement("div",{className:"col s12",key:a},r.a.createElement("label",{htmlFor:e.name},e.label),r.a.createElement("input",{name:e.name,type:"password",value:n[e.name],onChange:t}))}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("button",{className:"btn cyan waves-effect waves-light right",type:"submit",name:"action",style:{backgroundColor:"transparent"}},"Alterar Senha"))))))},pa=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={name:"",email:"",password:"",confirmPassword:"",municipio:""},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(h.a)({},localStorage),a=this.props.redux.processCollection;this.setState(Object(h.a)({},t)),a[0]||this.props.loadProcessData(),setTimeout(function(){var t=document.getElementById("setcolor").style.backgroundColor;e.setState({setColor:t})},200)}},{key:"handleChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(ce.a)({},a,n))}},{key:"editUser",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l=this;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=this.state,r=n.password,s=n.confirmPassword,i=n._id,o={_id:i,password:r,confirmPassword:s},r===s){e.next=7;break}alert("Senhas n\xe3o conferem"),e.next=13;break;case 7:if(""===o.password){e.next=12;break}return e.next=10,I.a.put("/api/editUser",o).then(function(e){a=e.data,q("sucess","Senha alterada com sucesso",a),l.setState({password:"",confirmPassword:""})}).catch(function(e){return console.log(e.message)});case 10:e.next=13;break;case 12:alert("Favor preencher todos os campos.");case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this.state,t=e.name,a=e.surName,n=e.municipio,s=e.email,i=this.props.redux.processCollection.length,o=t+" "+a;return r.a.createElement("div",null,r.a.createElement("div",{className:"container col s12 m12 l6",style:{marginTop:"0.5%"}},r.a.createElement("div",{style:{width:"100%",backgroundColor:this.state.setColor,padding:"1px 0",filter:"brightness(200%)"}},r.a.createElement("h5",{style:{paddingBottom:"1%"}},"Alterar minha senha "),r.a.createElement("center",null,r.a.createElement("img",{src:"/images/avatar.jpg",style:{filter:"brightness(50%)",borderRadius:"50%"},alt:"",width:"10%",height:"10%"})),r.a.createElement("div",{className:"row",style:{padding:"1% 15% 0 15%"}},[[o,"Nome"],[s,"Email"],[n,"Munic\xedpio"],[i,"Processos"]].map(function(e,t){return r.a.createElement("div",{className:"col s6 m3 center",key:t},r.a.createElement("div",null,e[1]),r.a.createElement("div",{style:{fontWeight:"500",paddingBottom:"15px"}},e[0]))}))),r.a.createElement("div",{className:"card-panel"},r.a.createElement(ua,{values:this.state,handleChange:this.handleChange.bind(this),handleSubmit:this.editUser.bind(this)}))))}}]),t}(n.Component),ha=Object(l.connect)(function(e){return{redux:e.cadastro}},function(e){return Object(o.b)({loadProcessData:M,reduxToastr:q},e)})(pa),fa=function(e,t,a,n){return'\n        <style>\n        .box {\n            position: relative;\n            font-size: 1rem;\n            font-family: sans-serif;\n            background-color: white;\n            padding: 2%;\n            border: 1px solid #000;\n            text-align: justify;\n            text-justify: inter-word;\n            border: 1px solid #bbbbbb;\n            border-radius: 1%;\n        }\n\n        .msg {\n            margin-top: 1%\n        }\n        </style>\n\n        <div class="box">\n            <em><strong>Fale Conosco </strong>- Mensagem recebida</em>\n            <br />\n            <p><strong>De: </strong>'.concat(e,"</p>\n            <p><strong>E-mail: </strong>").concat(t,"</p>\n            <p><strong>Assunto: </strong>").concat(a,'</p>\n        </div>\n\n        <div class="box msg">\n            <p>\n                <strong>Mensagem: </strong>\n            </p>\n            <p id="tst"> ').concat(n,' </p>\n\n            <br /><br />\n            <hr />\n            <p>\n                <a href="http://anuenciadigital.ml" target="_blank">Anu\xeancia Digital</a>\n            </p>\n\n        </div>\n    ')},va=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={},a.handleChange=function(e){var t=e.target,n=t.value,r=t.name;a.setState(Object(ce.a)({},r,n))},a.fields=[{label:"Nome",defaultValue:localStorage.name+" "+localStorage.surName,disabled:!0},{label:"E-mail",defaultValue:localStorage.email,disabled:!0},{name:"subject",label:"Assunto",autoFocus:!0,value:a.state.subject,onChange:a.handleChange}],a.handleSubmit=function(){var e=Object(W.a)(H.a.mark(function e(t){var n,r,s,i,o;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.state,n.color,r=n.person,s=n.email,i=n.mensagem,o=Object(sa.a)(n,["color","person","email","mensagem"]),i=i.replace(/\r\n|\r|\n/g,"</br>"),o.html=fa(r,s,o.subject,i),o.to="anuencia.digital@agenciarmbh.mg.gov.br",e.prev=4,e.next=7,I.a.post("/api/mail",o).then(function(e){console.log(e.data),a.setState({mensagem:"",subject:""})});case 7:q("sucess","Mensagem enviada","Obrigado por nos contatar!"),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.log(e.t0),q("err","Mensagem n\xe3o entregue","Erro");case 14:case"end":return e.stop()}},e,null,[[4,10]])}));return function(t){return e.apply(this,arguments)}}(),a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=Object(h.a)({},localStorage),a=t.name,n=t.surName,r=t.email,s=a+" "+n;this.setState({email:r,person:s}),setTimeout(function(){var t=document.getElementById("setcolor").style.backgroundColor;e.setState({color:t})},250)}},{key:"render",value:function(){return r.a.createElement("div",{style:{backgroundColor:"rgb(250,250,250)",height:"80vh",paddingTop:"1%"}},r.a.createElement("div",{className:"container z-depth-2",style:{padding:"0.5% 3% 5% 3%",backgroundColor:"#fff"}},r.a.createElement(xe,{title:"Fale Conosco",subtitle:"D\xfavidas, cr\xedticas ou sugest\xf5es? Escreva-nos uma mensagem ou envie um e-mail para",hyperLink:"anuencia.digital@agenciarmbh.mg.gov.br",color:this.state.color}),r.a.createElement("fieldset",null,this.fields.map(function(e,t){return r.a.createElement(ue.Input,Object.assign({key:t},e))})),r.a.createElement("fieldset",null,r.a.createElement("label",{htmlFor:"icon_prefix2"},r.a.createElement("i",{className:"material-icons tiny"},"email"),r.a.createElement("sup",null," Digite sua Mensagem")," "),r.a.createElement("textarea",{id:"icon_prefix2",name:"mensagem",style:{height:"6rem"},className:"materialize-textarea",value:this.state.mensagem,onChange:this.handleChange})),r.a.createElement("div",{className:"right",style:{padding:"1.5% 0 1% 0"}},r.a.createElement(ue.Button,{type:"submit",waves:"purple",className:"cyan",onClick:this.handleSubmit},"Enviar ",r.a.createElement(ue.Icon,{right:!0},"send")))))}}]),t}(n.Component),ba=Object(O.a)(Object(l.connect)(function(e){return Object(o.b)({reduxToastr:q},e)})(function(){var e=localStorage.getItem("role"),t="admin"===e||"prefeitura"===e,a="admin"===e||"tecnico"===e;return document.cookie.match("_sim-ad")?r.a.createElement(D.a,null,r.a.createElement(j.a,{path:"/",exact:!0,component:oe}),t&&r.a.createElement(j.a,{path:"/cadastro",component:Ae}),t&&r.a.createElement(j.a,{path:"/solicitaDiretriz",component:yt}),a&&r.a.createElement(j.a,{path:"/diretrizes",component:Rt}),t&&r.a.createElement(j.a,{path:"/solicitaAnuencia",component:Mt}),r.a.createElement(j.a,{path:"/showEmpreend",component:mt}),a&&r.a.createElement(j.a,{path:"/Anuencia",exact:!0,component:$t}),a&&r.a.createElement(j.a,{path:"/editData",component:Xe}),"admin"===e&&r.a.createElement(j.a,{path:"/users",exact:!0,component:la}),"admin"===e&&r.a.createElement(j.a,{path:"/admin",exact:!0,component:da}),r.a.createElement(j.a,{path:"/changePassword",exact:!0,component:ha}),r.a.createElement(j.a,{path:"/faleConosco",exact:!0,component:va})):(J(),r.a.createElement("h5",{style:{marginTop:"25%"}},"Sess\xe3o expirada!"))})),Ea=(a(318),[{endPoint:"/cadastro",label:"Cadastro"},{endPoint:"/solicitaDiretriz",label:"Solicitar Diretrizes Metropolitanas",item:"Processo cadastrado"},{endPoint:"/solicitaAnuencia",label:"Solicitar Anu\xeancia Pr\xe9via",item:"Diretrizes Metropolitanas emitidas"},{endPoint:"/showEmpreend",label:"Consultar Processos"}]),ga=[{endPoint:"/diretrizes",label:"Diretrizes Metropolitanas",item:"Aguardando Diretrizes Metropolitanas"},{endPoint:"/Anuencia",label:"Analisar Processo",item:"Aguardando An\xe1lise"},{endPoint:"/showEmpreend",label:"Consultar Processos"}],ya=[Ea[0],Ea[1],ga[0],Ea[2],ga[1],{endPoint:"/showEmpreend",label:"Gerenciar Dados"}],ka=[{endPoint:"/showEmpreend",label:"Consultar Processos"}],xa=function(e){var t=e.item,a=e.processo;if(a&&a.length>0){var n=a.filter(function(e){return e.status.match(t)}).length;return"Diretrizes Metropolitanas emitidas"===t&&(n+=a.filter(function(e){return e.status.match("Pend\xeancias")}).length+a.filter(function(e){return e.status.match("Aguardando documenta\xe7\xe3o")}).length),r.a.createElement("div",{style:{display:"inline-block"}},n>0?r.a.createElement("sup",{style:{fontSize:"0.9em",borderRadius:"50%",padding:"0px 5px",backgroundColor:"red",fontWeight:"900"}},n):0===n?r.a.createElement("sup",null," "):null)}return null},wa=function(e){function t(){return Object(Y.a)(this,t),Object(X.a)(this,Object(Q.a)(t).apply(this,arguments))}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"componentWillMount",value:function(){this.props.setColor()}},{key:"render",value:function(){var e=this.props,t=e.processo,a=e.color,n=localStorage.getItem("role");return r.a.createElement("nav",null,r.a.createElement("div",{className:"nav-wrapper",style:{paddingLeft:30,paddingRight:30,backgroundColor:a},id:"setcolor"},r.a.createElement(ee.a,{to:"/",className:"brand-logo"},r.a.createElement("i",{className:"material-icons",style:{fontSize:"30px"}},"home")),r.a.createElement(ee.a,{to:"","data-activates":"mobile-demo",className:"button-collapse"},r.a.createElement("i",{className:"material-icons"},"menu")),[{className:"right hide-on-med-and-down",id:""},{className:"side-nav",id:"mobile-demo"}].map(function(e,a){return r.a.createElement("ul",{className:e.className,id:e.id,key:a},function(e){switch(e){case"prefeitura":return Ea;case"tecnico":return ga;case"admin":return ya;case"empreend":case"rt":return ka;default:return}}(n).map(function(e,a){return r.a.createElement("li",{key:a+100},r.a.createElement(ee.a,{to:e.endPoint},e.label,e.item?r.a.createElement(xa,{processo:t,item:e.item}):r.a.createElement("span",null)))}),"admin"===n&&r.a.createElement("li",null,r.a.createElement(ee.a,{to:"/users"},r.a.createElement("i",{className:"material-icons left",title:"Usu\xe1rios"},"group"))),"admin"===n&&r.a.createElement("li",null,r.a.createElement(ee.a,{to:"/admin"},r.a.createElement("i",{className:"material-icons left",title:"Prefeituras"},"account_balance"))),r.a.createElement("li",null,r.a.createElement(ee.a,{to:"/changePassword"},r.a.createElement("i",{className:"material-icons left",title:"Alterar senha"},"vpn_key"))),r.a.createElement("li",null,r.a.createElement(ee.a,{to:"/faleConosco"},r.a.createElement("i",{className:"material-icons left",title:"Fale conosco"},"mail_outline"))),r.a.createElement("li",null,r.a.createElement(ee.a,{to:"/"},r.a.createElement("i",{className:"material-icons left",onClick:function(){return J()},title:"Sair"},"logout"))))})))}}]),t}(n.Component),Ca=Object(l.connect)(function(e){return{processo:e.cadastro.processCollection,color:e.cadastro.setColor}},function(e){return Object(o.b)({setColor:B},e)})(wa),Na=function(){return r.a.createElement("footer",{className:"grey lighten-4 black-text",style:{position:"fixed",bottom:0,width:"100%",borderTop:"0.1px solid #999",maxHeight:"20px"}},r.a.createElement("span",{style:{fontSize:"0.8rem"}},"\xa9 2019. Desenvolvido por Sandro Ver\xedssimo - Ag\xeancia de Desenvolvimento da RMBH."))},Da=function(e){return r.a.createElement("div",null,r.a.createElement("h4",{className:"header2"},e.title),r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12",onSubmit:e.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"mdi-communication-email prefix"}),r.a.createElement("input",{name:"email",type:"email",className:"validate",placeholder:"",onChange:e.handleChange}),r.a.createElement("label",{htmlFor:"email"},"E-mail"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"mdi-action-lock-outline prefix"}),r.a.createElement("input",{name:"password",type:"password",className:"validate",placeholder:"",onChange:e.handleChange}),r.a.createElement("label",{htmlFor:"password"},"Senha"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("button",{className:"btn cyan waves-effect waves-light right",type:"submit",name:"action",style:{backgroundColor:"transparent"}},"Entrar"))))))},ja=[{name:"name",className:"mdi-action-account-circle prefix",label:"Nome"},{name:"surName",className:"mdi-action-account-circle prefix",label:"Sobrenome"},{name:"email",className:"mdi-communication-email prefix",label:"E-mail"},{name:"municipio",className:"mdi-action-account-circle prefix",label:"Munic\xedpio"},{name:"password",className:"mdi-action-lock-outline prefix",label:"Senha"},{name:"confirmPassword",className:"mdi-action-lock-outline prefix",label:"Confirme sua senha"},{name:"role",className:"mdi-action-account-circle prefix",label:"\xc1rea de Atua\xe7\xe3o",options:["Poder p\xfablico","Iniciativa privada"]}],Oa=function(e){var t=e.handleChange,a=e.handleSubmit;return r.a.createElement("div",null,r.a.createElement("h4",{className:"header2"},e.title),r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12",onSubmit:a},ja.map(function(e,a){return r.a.createElement("div",{className:"row",key:a},"role"===e.name?r.a.createElement("label",null,e.label,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("span",{style:{marginRight:"5%"}},r.a.createElement("input",{id:"ip",type:"radio",name:e.name,value:"empreend",onChange:t}),r.a.createElement("label",{htmlFor:"ip"}," Iniciativa Privada")),r.a.createElement("span",null,r.a.createElement("input",{id:"pp",type:"radio",name:e.name,value:"prefeitura",onChange:t}),r.a.createElement("label",{htmlFor:"pp"}," Poder P\xfablico"))):r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("input",{name:e.name,type:"confirmPassword"===e.name?"password":"email"===e.name||"password"===e.name?e.name:"text",className:"validate",onChange:t}),r.a.createElement("label",{htmlFor:e.name},e.label)))}),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("button",{className:"btn cyan waves-effect waves-light right",type:"submit",name:"action",style:{backgroundColor:"transparent"}},"Cadastrar"))))))},Sa=function(e){return r.a.createElement("div",null,r.a.createElement("h4",{className:"header2"},e.title),r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col s12",onSubmit:e.handleSubmit},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("i",{className:"mdi-communication-email prefix"}),r.a.createElement("input",{name:"recoveryMail",type:"email",className:"validate",placeholder:"",onChange:e.handleChange}),r.a.createElement("label",{htmlFor:"recoveryMail"},"E-mail"))),r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"input-field col s12"},r.a.createElement("button",{className:"btn cyan waves-effect waves-light right",type:"submit",name:"action",style:{backgroundColor:"transparent"}},"Recuperar senha"))))))},Ia=function(e){function t(){var e,a;Object(Y.a)(this,t);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(a=Object(X.a)(this,(e=Object(Q.a)(t)).call.apply(e,[this].concat(r)))).state={registered:!0,name:"",email:"",password:"",confirmPassword:"",role:"",municipio:"",forgotPassword:!1},a.sendPassword=function(e){var t=a.state.recoveryMail;I.a.post("/api/forgotPassword",{recoveryMail:t}).then(function(e){"E-mail n\xe3o cadastrado."===e.data?q("err",e.data,"Erro"):(q("sucess","Uma nova senha foi enviada para o e-mail cadastrado","Senha alterada."),setTimeout(function(){a.setState({registered:!0,forgotPassword:!1})},3e3))}).catch(function(e){return console.log(e)}),e.preventDefault()},a}return Object(Z.a)(t,e),Object(K.a)(t,[{key:"handleChange",value:function(e){this.setState(Object(ce.a)({},e.target.name,e.target.value))}},{key:"login",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o,l,c;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.next=3,I.a.post("/api/login",{email:this.state.email,password:this.state.password}).then(function(e){return a=e.data}).catch(function(e){return q("Erro","Usu\xe1rio/senha invalidos.","Erro!"),null});case 3:if("Aguardando verifica\xe7\xe3o do usu\xe1rio."!==a){e.next=9;break}return e.next=6,localStorage.setItem("verified",!1);case 6:return this.props.login(!0),this.props.verify(!1),e.abrupt("return",null);case 9:return n=function(){return!!document.cookie.match("_sim-ad=","")},e.next=12,localStorage.setItem("login",n());case 12:if(a){e.next=14;break}return e.abrupt("return");case 14:if(!a.verified){e.next=28;break}r=0,s=Object.entries(a);case 16:if(!(r<s.length)){e.next=26;break}return i=s[r],o=Object(le.a)(i,2),l=o[0],c=o[1],e.next=23,localStorage.setItem(l,c);case 23:r++,e.next=16;break;case 26:this.props.login(!0),this.props.verify(!0);case 28:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"signup",value:function(){var e=Object(W.a)(H.a.mark(function e(t){var a,n,r,s,i,o;return H.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),n=this.state,r=n.name,s=n.surName,i=n.role,o=n.municipio,!(r&&s&&i&&o)){e.next=10;break}return e.next=5,this.setState({municipio:Ie(this.state.municipio),email:this.state.email.toLowerCase()});case 5:return e.next=7,I.a.post("/api/signup",this.state).then(function(e){"Senhas n\xe3o conferem."===e.data||"Usu\xe1rio j\xe1 cadastrado."===e.data||"E-mail inv\xe1lido."===e.data?q("err",e.data,"Erro!"):(a=e.data,q("sucess","Usu\xe1rio criado com sucesso",a.name))}).catch(function(e){return console.log(e.message)});case 7:setTimeout(function(){window.location.reload()},2e3),e.next=11;break;case 10:alert("Favor preencher todos os campos.");case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,a=t.registered,n=t.forgotPassword;return r.a.createElement("div",null,r.a.createElement("div",{className:"container col s12 m12 l6",style:{marginTop:"1%"}},r.a.createElement("img",{src:"/images/ad_login.png",className:"z-depth-2",alt:""}),r.a.createElement("div",{className:"card-panel"},a&&!n?r.a.createElement(Da,{title:"Entre no sistema",values:this.state,handleChange:this.handleChange.bind(this),handleSubmit:this.login.bind(this)}):a&&n?r.a.createElement(Sa,{title:"Informe seu e-mail para a recuper\xe7\xe3o da senha",values:this.state,handleChange:this.handleChange.bind(this),handleSubmit:this.sendPassword}):r.a.createElement(Oa,{title:"Cadastre-se",values:this.state,handleChange:this.handleChange.bind(this),handleSubmit:this.signup.bind(this)})),a&&!n?r.a.createElement("div",{className:"right"},r.a.createElement("p",{className:"link",onClick:function(){return e.setState({registered:!1})}}," N\xe3o possui usu\xe1rio e senha? Cadastre-se."),r.a.createElement("p",{className:"link right",onClick:function(){return e.setState({forgotPassword:!0})}}," Esqueceu sua senha?")):a&&n?r.a.createElement("div",null,r.a.createElement("p",{className:"link right",onClick:function(){return e.setState({forgotPassword:!1})}}," Voltar para login")):!a&&!n&&r.a.createElement("p",{className:"link right",onClick:function(){return e.setState({registered:!0})}}," J\xe1 \xe9 cadastrado? Fa\xe7a o login.")))}}]),t}(n.Component),Pa=Object(l.connect)(function(e){return{}},function(e){return Object(o.b)({login:P,verify:R,reduxToastr:q},e)})(Ia),Aa=function(){return r.a.createElement("div",{style:{position:"fixed",top:"40%",right:"15%",left:"15%",height:"50%",marginBottom:"25px",marginTop:"25px",textAlign:"center",zIndex:1}},r.a.createElement("img",{src:"/images/loading.gif",alt:"",height:"60px",width:"60px"}))},Ra=function(){return r.a.createElement("div",{className:"container col s12 m12 l6",style:{marginTop:"1%"}},r.a.createElement("img",{src:"/images/ad_login.png",className:"z-depth-2",alt:""}),r.a.createElement("div",{style:{marginTop:"4%",textAlign:"center"}},r.a.createElement("div",{className:"card-panel"},r.a.createElement("h5",null,"Aguardando verifica\xe7\xe3o do usu\xe1rio.")," ",r.a.createElement("br",null),r.a.createElement("button",{className:"btn blue",onClick:function(){return window.location.reload()}},"Voltar"))))},Fa=Object(l.connect)(function(e){return{auth:e.auth,render:e.cadastro}})(function(e){var t=e.render.loading;return document.cookie&&localStorage.getItem("verified")?r.a.createElement("div",{style:{position:"relative",height:"100%"}},r.a.createElement(N.a,null,r.a.createElement("div",{style:{marginBottom:"80px"}},r.a.createElement("header",null,r.a.createElement(Ca,null)),r.a.createElement(ba,null))),r.a.createElement(Na,null),r.a.createElement(C,null),t&&r.a.createElement(Aa,null)):e.auth.login?r.a.createElement(Ra,null):r.a.createElement("div",null,r.a.createElement(Pa,null))}),_a=Object(o.a)(d.a,u.a,p.a)(o.d);i.a.render(r.a.createElement(function(){return r.a.createElement(l.Provider,{store:_a(w)},r.a.createElement(Fa,null),r.a.createElement(C,null))},null),document.getElementById("root"))},84:function(e,t,a){}},[[116,1,2]]]);
//# sourceMappingURL=main.4ad2a0a2.chunk.js.map